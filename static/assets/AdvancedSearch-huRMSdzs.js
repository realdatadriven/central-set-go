import{S as je,i as Ne,s as Ie,e as U,I as we,a as w,b as D,c as ye,F as Z,d as y,g as I,h as E,m as Oe,k as P,o as M,p as Le,r as Se,q as J,u as L,w as X,v as Ee,y as oe,z as Te,A as qe,C as Ae,D as re,t as Q,n as V,a2 as Ce,a3 as Be,a4 as ie,j as R,x as Ue}from"./index-XSy4RcHY.js";import"./pt-C8dmXWAd.js";function ue(n,e,s){const t=n.slice();return t[20]=e[s],t[21]=e,t[22]=s,t}function fe(n,e,s){const t=n.slice();return t[23]=e[s],t}function ae(n,e,s){const t=n.slice();return t[23]=e[s],t}function _e(n,e,s){const t=n.slice();return t[28]=e[s],t[29]=e,t[30]=s,t}function he(n,e,s){const t=n.slice();return t[20]=e[s],t[31]=e,t[22]=s,t}function pe(n,e,s){const t=n.slice();return t[20]=e[s],t}function de(n){let e,s=n[3].t(`crud.${n[20]}`)+"",t,o;return{c(){var c,l;e=w("th"),t=Q(s),y(e,"class",o="normal-case "+(((l=(c=n[2])==null?void 0:c[n[20]])==null?void 0:l.width)||""))},m(c,l){I(c,e,l),E(e,t)},p(c,l){var u,f;l[0]&12&&s!==(s=c[3].t(`crud.${c[20]}`)+"")&&V(t,s),l[0]&4&&o!==(o="normal-case "+(((f=(u=c[2])==null?void 0:u[c[20]])==null?void 0:f.width)||""))&&y(e,"class",o)},d(c){c&&L(e)}}}function ze(n){let e,s,t;function o(u,f){var h,i;return f[0]&4&&(s=null),s==null&&(s=!!["boolean"].includes((i=(h=u[2])==null?void 0:h[u[20]])==null?void 0:i.type)),s?Pe:Ke}let c=o(n,[-1,-1]),l=c(n);return{c(){var u,f;e=w("td"),l.c(),y(e,"class",t="normal-case "+(((f=(u=n[2])==null?void 0:u[n[20]])==null?void 0:f.width)||""))},m(u,f){I(u,e,f),l.m(e,null)},p(u,f){var h,i;c===(c=o(u,f))&&l?l.p(u,f):(l.d(1),l=c(u),l&&(l.c(),l.m(e,null))),f[0]&4&&t!==(t="normal-case "+(((i=(h=u[2])==null?void 0:h[u[20]])==null?void 0:i.width)||""))&&y(e,"class",t)},d(u){u&&L(e),l.d()}}}function Fe(n){let e,s=n[28][n[20]]+"",t,o;return{c(){var c,l;e=w("th"),t=Q(s),y(e,"class",o="normal-case "+(((l=(c=n[2])==null?void 0:c[n[20]])==null?void 0:l.width)||""))},m(c,l){I(c,e,l),E(e,t)},p(c,l){var u,f;l[0]&5&&s!==(s=c[28][c[20]]+"")&&V(t,s),l[0]&4&&o!==(o="normal-case "+(((f=(u=c[2])==null?void 0:u[c[20]])==null?void 0:f.width)||""))&&y(e,"class",o)},d(c){c&&L(e)}}}function Ke(n){let e=(n[28][n[20]]?n[28][n[20]]:"")+"",s;return{c(){s=Q(e)},m(t,o){I(t,s,o)},p(t,o){o[0]&5&&e!==(e=(t[28][t[20]]?t[28][t[20]]:"")+"")&&V(s,e)},d(t){t&&L(s)}}}function Pe(n){let e,s,t;function o(){n[6].call(e,n[20],n[29],n[30])}return{c(){e=w("input"),y(e,"type","checkbox"),y(e,"class","checkbox checkbox-sm")},m(c,l){I(c,e,l),e.checked=n[28][n[20]],s||(t=P(e,"change",o),s=!0)},p(c,l){n=c,l[0]&5&&(e.checked=n[28][n[20]])},d(c){c&&L(e),s=!1,t()}}}function me(n){let e;function s(c,l){return c[22]===0?Fe:ze}let o=s(n)(n);return{c(){o.c(),e=Z()},m(c,l){o.m(c,l),I(c,e,l)},p(c,l){o.p(c,l)},d(c){c&&L(e),o.d(c)}}}function be(n){let e,s,t,o,c,l,u,f,h,i,m=U(Object.keys(n[2])),p=[];for(let k=0;k<m.length;k+=1)p[k]=me(he(n,m,k));l=new we({props:{type:"outline",icon:"trash",path:"icons"}});function d(){return n[7](n[30])}return{c(){e=w("tr");for(let k=0;k<p.length;k+=1)p[k].c();s=D(),t=w("td"),o=w("button"),c=w("span"),ye(l.$$.fragment),u=D(),y(c,"class","w-6"),y(o,"class","btn btn-circle btn-ghost btn-sm m-0 text-xs"),y(t,"class","p-0.5 w-16 text-right")},m(k,q){I(k,e,q);for(let g=0;g<p.length;g+=1)p[g]&&p[g].m(e,null);E(e,s),E(e,t),E(t,o),E(o,c),Oe(l,c,null),E(e,u),f=!0,h||(i=P(o,"click",d),h=!0)},p(k,q){if(n=k,q[0]&5){m=U(Object.keys(n[2]));let g;for(g=0;g<m.length;g+=1){const C=he(n,m,g);p[g]?p[g].p(C,q):(p[g]=me(C),p[g].c(),p[g].m(e,s))}for(;g<p.length;g+=1)p[g].d(1);p.length=m.length}},i(k){f||(M(l.$$.fragment,k),f=!0)},o(k){J(l.$$.fragment,k),f=!1},d(k){k&&L(e),X(p,k),Ee(l),h=!1,i()}}}function Re(n){let e,s,t;function o(f,h){var i,m;return(m=(i=f[2])==null?void 0:i[f[20]])!=null&&m.func?Xe:Me}let c=o(n),l=c(n);function u(){n[12].call(e,n[20])}return{c(){e=w("select"),l.c(),y(e,"class","select select-sm p-0.5 w-full"),n[1][n[20]]===void 0&&Be(u)},m(f,h){I(f,e,h),l.m(e,null),ie(e,n[1][n[20]],!0),s||(t=P(e,"change",u),s=!0)},p(f,h){n=f,c===(c=o(n))&&l?l.p(n,h):(l.d(1),l=c(n),l&&(l.c(),l.m(e,null))),h[0]&6&&ie(e,n[1][n[20]])},d(f){f&&L(e),l.d(),s=!1,t()}}}function We(n){let e,s,t;function o(){n[11].call(e,n[20])}return{c(){e=w("textarea"),y(e,"rows",1),y(e,"class","textarea textarea-sm p-1 min-h-5 w-full")},m(c,l){I(c,e,l),R(e,n[1][n[20]]),s||(t=P(e,"input",o),s=!0)},p(c,l){n=c,l[0]&6&&R(e,n[1][n[20]])},d(c){c&&L(e),s=!1,t()}}}function De(n){let e,s,t;function o(){n[10].call(e,n[20])}return{c(){e=w("input"),y(e,"type","text"),y(e,"class","input input-sm w-full")},m(c,l){I(c,e,l),R(e,n[1][n[20]]),s||(t=P(e,"input",o),s=!0)},p(c,l){n=c,l[0]&6&&e.value!==n[1][n[20]]&&R(e,n[1][n[20]])},d(c){c&&L(e),s=!1,t()}}}function Ge(n){let e,s,t;function o(){n[8].call(e,n[20])}function c(...l){return n[9](n[20],...l)}return{c(){e=w("input"),y(e,"type","checkbox"),y(e,"class","checkbox checkbox-sm")},m(l,u){I(l,e,u),e.checked=n[1][n[20]],s||(t=[P(e,"change",o),P(e,"change",c)],s=!0)},p(l,u){n=l,u[0]&6&&(e.checked=n[1][n[20]])},d(l){l&&L(e),s=!1,Ue(t)}}}function Me(n){var o,c;let e,s=U(((c=(o=n[2])==null?void 0:o[n[20]])==null?void 0:c.options)||[]),t=[];for(let l=0;l<s.length;l+=1)t[l]=ke(fe(n,s,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=Z()},m(l,u){for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(l,u);I(l,e,u)},p(l,u){var f,h;if(u[0]&4){s=U(((h=(f=l[2])==null?void 0:f[l[20]])==null?void 0:h.options)||[]);let i;for(i=0;i<s.length;i+=1){const m=fe(l,s,i);t[i]?t[i].p(m,u):(t[i]=ke(m),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=s.length}},d(l){l&&L(e),X(t,l)}}}function Xe(n){var o,c;let e,s=U(((c=(o=n[2])==null?void 0:o[n[20]])==null?void 0:c.options())||[]),t=[];for(let l=0;l<s.length;l+=1)t[l]=ge(ae(n,s,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=Z()},m(l,u){for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(l,u);I(l,e,u)},p(l,u){var f,h;if(u[0]&4){s=U(((h=(f=l[2])==null?void 0:f[l[20]])==null?void 0:h.options())||[]);let i;for(i=0;i<s.length;i+=1){const m=ae(l,s,i);t[i]?t[i].p(m,u):(t[i]=ge(m),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=s.length}},d(l){l&&L(e),X(t,l)}}}function ke(n){let e,s=n[23].label+"",t,o;return{c(){e=w("option"),t=Q(s),e.__value=o=n[23].value,R(e,e.__value)},m(c,l){I(c,e,l),E(e,t)},p(c,l){l[0]&4&&s!==(s=c[23].label+"")&&V(t,s),l[0]&4&&o!==(o=c[23].value)&&(e.__value=o,R(e,e.__value))},d(c){c&&L(e)}}}function ge(n){let e,s=n[23].label+"",t,o;return{c(){e=w("option"),t=Q(s),e.__value=o=n[23].value,R(e,e.__value)},m(c,l){I(c,e,l),E(e,t)},p(c,l){l[0]&4&&s!==(s=c[23].label+"")&&V(t,s),l[0]&4&&o!==(o=c[23].value)&&(e.__value=o,R(e,e.__value))},d(c){c&&L(e)}}}function ve(n){let e,s,t,o,c,l;function u(i,m){var p,d,k,q,g,C,z,F;if(m[0]&4&&(s=null),m[0]&4&&(t=null),m[0]&4&&(o=null),m[0]&4&&(c=null),s==null&&(s=!!["boolean"].includes((d=(p=i[2])==null?void 0:p[i[20]])==null?void 0:d.type)),s)return Ge;if(t==null&&(t=!!["string"].includes((q=(k=i[2])==null?void 0:k[i[20]])==null?void 0:q.type)),t)return De;if(o==null&&(o=!!["text"].includes((C=(g=i[2])==null?void 0:g[i[20]])==null?void 0:C.type)),o)return We;if(c==null&&(c=!!["select"].includes((F=(z=i[2])==null?void 0:z[i[20]])==null?void 0:F.type)),c)return Re}let f=u(n,[-1,-1]),h=f&&f(n);return{c(){var i,m;e=w("td"),h&&h.c(),y(e,"class",l=((m=(i=n[2])==null?void 0:i[n[20]])==null?void 0:m.width)||"")},m(i,m){I(i,e,m),h&&h.m(e,null)},p(i,m){var p,d;f===(f=u(i,m))&&h?h.p(i,m):(h&&h.d(1),h=f&&f(i),h&&(h.c(),h.m(e,null))),m[0]&4&&l!==(l=((d=(p=i[2])==null?void 0:p[i[20]])==null?void 0:d.width)||"")&&y(e,"class",l)},d(i){i&&L(e),h&&h.d()}}}function Ye(n){let e,s,t,o,c,l,u,f,h,i,m,p,d,k,q,g,C,z,F,Y,G,H,_,b=U(Object.keys(n[2])),O=[];for(let a=0;a<b.length;a+=1)O[a]=de(pe(n,b,a));let S=U(n[0]||[]),v=[];for(let a=0;a<S.length;a+=1)v[a]=be(_e(n,S,a));const W=a=>J(v[a],1,1,()=>{v[a]=null});let B=U(Object.keys(n[2])),N=[];for(let a=0;a<B.length;a+=1)N[a]=ve(ue(n,B,a));z=new we({props:{type:"outline",icon:"plus",path:"icons"}});let K=He;return{c(){e=w("div"),s=w("div"),t=w("div"),o=w("table"),c=w("thead"),l=w("tr");for(let a=0;a<O.length;a+=1)O[a].c();u=D(),f=w("th"),h=D(),i=w("tbody");for(let a=0;a<v.length;a+=1)v[a].c();m=D(),p=w("tfoot"),d=w("tr");for(let a=0;a<N.length;a+=1)N[a].c();k=D(),q=w("td"),g=w("button"),C=w("span"),ye(z.$$.fragment),F=D(),Y=Z(),y(f,"class","p-0.5 w-16"),y(C,"class","w-6"),y(g,"class","btn btn-circle btn-ghost btn-sm m-0 text-xs"),y(q,"class","p-0.5 w-16 text-right"),y(o,"class","table table-zebra w-full normal-case table-xs"),y(t,"class","overflow-x-auto"),y(s,"class","grow w-full"),y(e,"class","flex flex-col")},m(a,j){I(a,e,j),E(e,s),E(s,t),E(t,o),E(o,c),E(c,l);for(let r=0;r<O.length;r+=1)O[r]&&O[r].m(l,null);E(l,u),E(l,f),E(o,h),E(o,i);for(let r=0;r<v.length;r+=1)v[r]&&v[r].m(i,null);E(o,m),E(o,p),E(p,d);for(let r=0;r<N.length;r+=1)N[r]&&N[r].m(d,null);E(d,k),E(d,q),E(q,g),E(g,C),Oe(z,C,null),I(a,F,j),I(a,Y,j),G=!0,H||(_=P(g,"click",n[13]),H=!0)},p(a,j){if(j[0]&12){b=U(Object.keys(a[2]));let r;for(r=0;r<b.length;r+=1){const A=pe(a,b,r);O[r]?O[r].p(A,j):(O[r]=de(A),O[r].c(),O[r].m(l,u))}for(;r<O.length;r+=1)O[r].d(1);O.length=b.length}if(j[0]&5){S=U(a[0]||[]);let r;for(r=0;r<S.length;r+=1){const A=_e(a,S,r);v[r]?(v[r].p(A,j),M(v[r],1)):(v[r]=be(A),v[r].c(),M(v[r],1),v[r].m(i,null))}for(Le(),r=S.length;r<v.length;r+=1)W(r);Se()}if(j[0]&6){B=U(Object.keys(a[2]));let r;for(r=0;r<B.length;r+=1){const A=ue(a,B,r);N[r]?N[r].p(A,j):(N[r]=ve(A),N[r].c(),N[r].m(d,k))}for(;r<N.length;r+=1)N[r].d(1);N.length=B.length}},i(a){if(!G){for(let j=0;j<S.length;j+=1)M(v[j]);M(z.$$.fragment,a),M(K),G=!0}},o(a){v=v.filter(Boolean);for(let j=0;j<v.length;j+=1)J(v[j]);J(z.$$.fragment,a),J(K),G=!1},d(a){a&&(L(e),L(F),L(Y)),X(O,a),X(v,a),X(N,a),Ee(z),H=!1,_()}}}let He=!1;function Je(n,e,s){let t,o;oe(n,Te,_=>s(15,t=_)),oe(n,qe,_=>s(3,o=_));let{table:c}=e,{action:l={}}=e,{advanced_search:u=[]}=e,f=[],h=[{value:"=",label:o.t("crud.eq")},{value:">",label:o.t("crud.gt")},{value:"<",label:o.t("crud.lt")},{value:"<=",label:o.t("crud.lt_eq")},{value:">=",label:o.t("crud.gt_eq")},{value:"IN",label:o.t("crud.in")},{value:"NOT IN",label:o.t("crud.not_in")},{value:"LIKE",label:o.t("crud.like")},{value:"NOT LIKE",label:o.t("crud.not_like")},{value:"BETWEEN",label:o.t("crud.between")},{value:"NOT BETWEEN",label:o.t("crud.not_between")},{value:"IS NULL",label:o.t("crud.is_null")},{value:"IS NOT NULL",label:o.t("crud.is_not_null")},{value:"IS TRUE",label:o.t("crud.is_true")},{value:"IS FALSE",label:o.t("crud.is_false")},{value:"REGEX",label:o.t("crud.regex")}],i=[],p={field:{type:"select",width:"min-w-40",func:!0,options:()=>i.map(_=>({value:_.name,label:_.comment}))},cond:{type:"select",width:"min-w-40",options:h},value:{type:"string",width:"min-w-60"},deactivate:{type:"boolean"}},d={};const k=_=>{var S,v,W,B,N,K,a,j,r,A,$,x,ee,le,te,ne,se;let b={};((S=_==null?void 0:_.fields_order)==null?void 0:S.length)>0&&(_!=null&&_.fields)?_==null||_.fields_order.forEach(T=>{var ce;b[T]=(ce=_==null?void 0:_.fields)==null?void 0:ce[T]}):_!=null&&_.fields?b=_==null?void 0:_.fields:b=_;const O=[];for(const T in b)if(Object.hasOwnProperty.call(b,T)){if(b[T].pk2)continue;b[T].fk?O.push(Object.assign(b[T],{name:(W=(v=b[T])==null?void 0:v.ref)==null?void 0:W.referred_columns_desc,referred_table:((N=(B=b[T])==null?void 0:B.ref)==null?void 0:N.referred_table)||((K=b[T])==null?void 0:K.referred_table),comment:(te=(le=($=(A=t==null?void 0:t.tables)==null?void 0:A[((j=(a=b[T])==null?void 0:a.ref)==null?void 0:j.referred_table)||((r=b[T])==null?void 0:r.referred_table)])==null?void 0:$.fields)==null?void 0:le[(ee=(x=b[T])==null?void 0:x.ref)==null?void 0:ee.referred_columns_desc])==null?void 0:te.comment,referred_column:(se=(ne=b[T])==null?void 0:ne.ref)==null?void 0:se.referred_column})):O.push(b[T])}return O};Ae(()=>{var _,b,O,S,v,W,B,N,K;o.changeLanguage(t==null?void 0:t.lang),console.log((_=t==null?void 0:t.tables)==null?void 0:_[c]);try{re.locale(t==null?void 0:t.lang)}catch{re.locale("en-us")}i=k(((b=t==null?void 0:t.tables)==null?void 0:b[c])||{});for(const a in t==null?void 0:t.tables)for(const j in(S=(O=t==null?void 0:t.tables)==null?void 0:O[a])==null?void 0:S.fields)if(Object.hasOwnProperty.call((W=(v=t==null?void 0:t.tables)==null?void 0:v[a])==null?void 0:W.fields,j)){const r=(N=(B=t==null?void 0:t.tables)==null?void 0:B[a])==null?void 0:N.fields[j];if(r.fk&&((K=r==null?void 0:r.ref)==null?void 0:K.referred_table)===c){const A=Object.assign(r,{table:a});f.push(Object.assign(A,r==null?void 0:r.ref))}}});function q(_,b,O){b[O][_]=this.checked,s(0,u),s(5,l),s(1,d)}const g=_=>{try{u.splice(_,1),s(0,u=[...u])}catch{}};function C(_){d[_]=this.checked,s(1,d),s(2,p)}const z=(_,b)=>{var O;try{s(2,p={...p,[_]:{...p[_],disabled:(O=p==null?void 0:p[_])==null?void 0:O.disabled}})}catch(S){console.log(S.message)}};function F(_){d[_]=this.value,s(1,d),s(2,p)}function Y(_){d[_]=this.value,s(1,d),s(2,p)}function G(_){d[_]=Ce(this),s(1,d),s(2,p)}const H=()=>{try{!d.field||!d.value||s(0,u=[...u,Object.assign({},d)])}catch{}};return n.$$set=_=>{"table"in _&&s(4,c=_.table),"action"in _&&s(5,l=_.action),"advanced_search"in _&&s(0,u=_.advanced_search)},n.$$.update=()=>{n.$$.dirty[0]&35&&((l==null?void 0:l.name)=="CANCEL"&&(console.log(l),l==null||l.action()),(l==null?void 0:l.name)=="YES"&&(console.log(l),(u==null?void 0:u.length)===0&&(d!=null&&d.filed)&&(d!=null&&d.value)&&s(0,u=[...u,Object.assign({},d)]),l==null||l.action({data:u})))},[u,d,p,o,c,l,q,g,C,z,F,Y,G,H]}class Ze extends je{constructor(e){super(),Ne(this,e,Je,Ye,Ie,{table:4,action:5,advanced_search:0},null,[-1,-1])}}export{Ze as default};
