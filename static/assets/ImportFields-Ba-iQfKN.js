import{S as rt,i as ct,s as ut,G as se,I as ze,a as g,c as Le,b as N,t as B,F as ot,d as c,a7 as Ve,f as He,g as te,h as a,m as je,j as Pe,k as ve,E as Be,n as y,p as Me,q as re,r as Ae,o as ee,u as le,v as Ee,x as _t,y as Je,z as pt,A as mt,C as ht,D as Qe,N as gt,T as dt,X as bt,W as kt,aa as wt,O as vt,a0 as Ot,e as he,w as Ne,H as ge,a1 as Ct,a2 as Ue}from"./index-BpRaDDNn.js";import"./pt-WpTh3RxT.js";import{P as it}from"./Pagination-Bvi2KDzm.js";function Xe(l,s,t){const e=l.slice();return e[45]=s[t],e[41]=t,e}function ye(l,s,t){const e=l.slice();return e[47]=s[t],e[49]=t,e}function Ke(l,s,t){const e=l.slice();return e[47]=s[t],e}function Ye(l,s,t){const e=l.slice();return e[39]=s[t],e[40]=s,e[41]=t,e}function Ze(l,s,t){const e=l.slice();return e[42]=s[t],e}function Lt(l){var J,R,p;let s,t,e,o,n,r,_,E,i,I,P=he(Object.keys(((J=l[10])==null?void 0:J[0])||[])),j=[];for(let m=0;m<P.length;m+=1)j[m]=$e(Ke(l,P,m));let S=he(l[10].slice(l[5]*l[4],l[5]*l[4]+l[4])),w=[];for(let m=0;m<S.length;m+=1)w[m]=et(Xe(l,S,m));return i=new it({props:{lang:(R=l[13])==null?void 0:R.lang,conf:(p=l[13])==null?void 0:p.conf,rows_per_page:l[4],page:l[5],total_rows:l[10].length}}),i.$on("pageChange",l[34]),{c(){s=g("div"),t=g("div"),e=g("table"),o=g("thead"),n=g("tr");for(let m=0;m<j.length;m+=1)j[m].c();r=N(),_=g("tbody");for(let m=0;m<w.length;m+=1)w[m].c();E=N(),Le(i.$$.fragment),c(e,"class","table table-zebra w-full normal-case table-xs"),c(t,"class","overflow-x-auto"),c(s,"class","w-full")},m(m,k){te(m,s,k),a(s,t),a(t,e),a(e,o),a(o,n);for(let O=0;O<j.length;O+=1)j[O]&&j[O].m(n,null);a(e,r),a(e,_);for(let O=0;O<w.length;O+=1)w[O]&&w[O].m(_,null);a(s,E),je(i,s,null),I=!0},p(m,k){var u,b,T;if(k[0]&1024){P=he(Object.keys(((u=m[10])==null?void 0:u[0])||[]));let v;for(v=0;v<P.length;v+=1){const W=Ke(m,P,v);j[v]?j[v].p(W,k):(j[v]=$e(W),j[v].c(),j[v].m(n,null))}for(;v<j.length;v+=1)j[v].d(1);j.length=P.length}if(k[0]&1072){S=he(m[10].slice(m[5]*m[4],m[5]*m[4]+m[4]));let v;for(v=0;v<S.length;v+=1){const W=Xe(m,S,v);w[v]?w[v].p(W,k):(w[v]=et(W),w[v].c(),w[v].m(_,null))}for(;v<w.length;v+=1)w[v].d(1);w.length=S.length}const O={};k[0]&8192&&(O.lang=(b=m[13])==null?void 0:b.lang),k[0]&8192&&(O.conf=(T=m[13])==null?void 0:T.conf),k[0]&16&&(O.rows_per_page=m[4]),k[0]&32&&(O.page=m[5]),k[0]&1024&&(O.total_rows=m[10].length),i.$set(O)},i(m){I||(ee(i.$$.fragment,m),I=!0)},o(m){re(i.$$.fragment,m),I=!1},d(m){m&&le(s),Ne(j,m),Ne(w,m),Ee(i)}}}function jt(l){var ke,we;let s,t,e,o,n,r,_=l[14].t("crud.db")+"",E,i,I=l[14].t("crud.field")+"",P,j,S,w=l[14].t("crud.field")+"",J,R,p=l[14].t("crud.label")+"",m,k,O,u=l[14].t("crud.match")+"",b,T,v=l[14].t("crud.file")+"",W,ne,fe=se(l[2])+"",K,ae,de,$=l[14].t("crud.deactivate")+"",me,ce,ue,be,oe,H,Y=he(Object.keys(l[8]||{}).slice(l[7]*l[6],l[7]*l[6]+l[6])),z=[];for(let f=0;f<Y.length;f+=1)z[f]=nt(Ye(l,Y,f));return oe=new it({props:{lang:(ke=l[13])==null?void 0:ke.lang,conf:(we=l[13])==null?void 0:we.conf,rows_per_page:l[6],page:l[7],total_rows:Object.keys(l[8]||{}).length}}),oe.$on("pageChange",l[33]),{c(){s=g("div"),t=g("div"),e=g("table"),o=g("thead"),n=g("tr"),r=g("th"),E=B(_),i=N(),P=B(I),j=N(),S=g("th"),J=B(w),R=N(),m=B(p),k=N(),O=g("th"),b=B(u),T=N(),W=B(v),ne=B(" - "),K=B(fe),ae=N(),de=g("th"),me=B($),ce=N(),ue=g("tbody");for(let f=0;f<z.length;f+=1)z[f].c();be=N(),Le(oe.$$.fragment),c(r,"class","normal-case"),c(S,"class","normal-case"),c(O,"class","normal-case"),c(de,"class","normal-case"),c(e,"class","table table-zebra w-full normal-case table-xs"),c(t,"class","overflow-x-auto"),c(s,"class","w-full")},m(f,d){te(f,s,d),a(s,t),a(t,e),a(e,o),a(o,n),a(n,r),a(r,E),a(r,i),a(r,P),a(n,j),a(n,S),a(S,J),a(S,R),a(S,m),a(n,k),a(n,O),a(O,b),a(O,T),a(O,W),a(O,ne),a(O,K),a(n,ae),a(n,de),a(de,me),a(e,ce),a(e,ue);for(let C=0;C<z.length;C+=1)z[C]&&z[C].m(ue,null);a(s,be),je(oe,s,null),H=!0},p(f,d){var G,Z;if((!H||d[0]&16384)&&_!==(_=f[14].t("crud.db")+"")&&y(E,_),(!H||d[0]&16384)&&I!==(I=f[14].t("crud.field")+"")&&y(P,I),(!H||d[0]&16384)&&w!==(w=f[14].t("crud.field")+"")&&y(J,w),(!H||d[0]&16384)&&p!==(p=f[14].t("crud.label")+"")&&y(m,p),(!H||d[0]&16384)&&u!==(u=f[14].t("crud.match")+"")&&y(b,u),(!H||d[0]&16384)&&v!==(v=f[14].t("crud.file")+"")&&y(W,v),(!H||d[0]&4)&&fe!==(fe=se(f[2])+"")&&y(K,fe),(!H||d[0]&16384)&&$!==($=f[14].t("crud.deactivate")+"")&&y(me,$),d[0]&960){Y=he(Object.keys(f[8]||{}).slice(f[7]*f[6],f[7]*f[6]+f[6]));let M;for(M=0;M<Y.length;M+=1){const _e=Ye(f,Y,M);z[M]?z[M].p(_e,d):(z[M]=nt(_e),z[M].c(),z[M].m(ue,null))}for(;M<z.length;M+=1)z[M].d(1);z.length=Y.length}const C={};d[0]&8192&&(C.lang=(G=f[13])==null?void 0:G.lang),d[0]&8192&&(C.conf=(Z=f[13])==null?void 0:Z.conf),d[0]&64&&(C.rows_per_page=f[6]),d[0]&128&&(C.page=f[7]),d[0]&256&&(C.total_rows=Object.keys(f[8]||{}).length),oe.$set(C)},i(f){H||(ee(oe.$$.fragment,f),H=!0)},o(f){re(oe.$$.fragment,f),H=!1},d(f){f&&le(s),Ne(z,f),Ee(oe)}}}function $e(l){let s,t=se(l[47],30)+"",e,o,n;return{c(){s=g("th"),e=B(t),o=N(),c(s,"class","normal-case"),c(s,"title",n=ge(l[47],30))},m(r,_){te(r,s,_),a(s,e),a(s,o)},p(r,_){_[0]&1024&&t!==(t=se(r[47],30)+"")&&y(e,t),_[0]&1024&&n!==(n=ge(r[47],30))&&c(s,"title",n)},d(r){r&&le(s)}}}function Et(l){let s,t=se(l[45][l[47]],30)+"",e,o;return{c(){s=g("td"),e=B(t),c(s,"title",o=ge(l[45][l[47]],30))},m(n,r){te(n,s,r),a(s,e)},p(n,r){r[0]&1072&&t!==(t=se(n[45][n[47]],30)+"")&&y(e,t),r[0]&1072&&o!==(o=ge(n[45][n[47]],30))&&c(s,"title",o)},d(n){n&&le(s)}}}function Rt(l){let s,t=se(l[45][l[47]],30)+"",e,o;return{c(){s=g("th"),e=B(t),c(s,"title",o=ge(l[45][l[47]],30))},m(n,r){te(n,s,r),a(s,e)},p(n,r){r[0]&1072&&t!==(t=se(n[45][n[47]],30)+"")&&y(e,t),r[0]&1072&&o!==(o=ge(n[45][n[47]],30))&&c(s,"title",o)},d(n){n&&le(s)}}}function xe(l){let s;function t(n,r){return n[49]===0?Rt:Et}let o=t(l)(l);return{c(){o.c(),s=ot()},m(n,r){o.m(n,r),te(n,s,r)},p(n,r){o.p(n,r)},d(n){n&&le(s),o.d(n)}}}function et(l){var n;let s,t,e=he(Object.keys(((n=l[10])==null?void 0:n[0])||[])),o=[];for(let r=0;r<e.length;r+=1)o[r]=xe(ye(l,e,r));return{c(){s=g("tr");for(let r=0;r<o.length;r+=1)o[r].c();t=N(),c(s,"class","hover")},m(r,_){te(r,s,_);for(let E=0;E<o.length;E+=1)o[E]&&o[E].m(s,null);a(s,t)},p(r,_){var E;if(_[0]&1072){e=he(Object.keys(((E=r[10])==null?void 0:E[0])||[]));let i;for(i=0;i<e.length;i+=1){const I=ye(r,e,i);o[i]?o[i].p(I,_):(o[i]=xe(I),o[i].c(),o[i].m(s,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=e.length}},d(r){r&&le(s),Ne(o,r)}}}function tt(l){let s,t,e,o=he(l[9]||[]),n=[];for(let _=0;_<o.length;_+=1)n[_]=lt(Ze(l,o,_));function r(){l[31].call(s,l[39])}return{c(){s=g("select");for(let _=0;_<n.length;_+=1)n[_].c();c(s,"class","select select-sm p-0.5 w-full bg-transparent"),l[8][l[39]].file_field_match===void 0&&Ct(r)},m(_,E){te(_,s,E);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(s,null);Ue(s,l[8][l[39]].file_field_match,!0),t||(e=ve(s,"change",r),t=!0)},p(_,E){if(l=_,E[0]&512){o=he(l[9]||[]);let i;for(i=0;i<o.length;i+=1){const I=Ze(l,o,i);n[i]?n[i].p(I,E):(n[i]=lt(I),n[i].c(),n[i].m(s,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=o.length}E[0]&960&&Ue(s,l[8][l[39]].file_field_match)},d(_){_&&le(s),Ne(n,_),t=!1,e()}}}function lt(l){let s,t=l[42]+"",e,o;return{c(){s=g("option"),e=B(t),s.__value=o=l[42],Pe(s,s.__value)},m(n,r){te(n,s,r),a(s,e)},p(n,r){r[0]&512&&t!==(t=n[42]+"")&&y(e,t),r[0]&512&&o!==(o=n[42])&&(s.__value=o,Pe(s,s.__value))},d(n){n&&le(s)}}}function st(l){let s,t,e;function o(){l[32].call(s,l[39])}return{c(){s=g("input"),c(s,"type","checkbox"),c(s,"class","checkbox checkbox-sm")},m(n,r){te(n,s,r),s.checked=l[8][l[39]].deactivate,t||(e=ve(s,"change",o),t=!0)},p(n,r){l=n,r[0]&960&&(s.checked=l[8][l[39]].deactivate)},d(n){n&&le(s),t=!1,e()}}}function nt(l){var m,k,O,u;let s,t,e=se(l[39],30)+"",o,n,r,_,E=se((k=(m=l[8])==null?void 0:m[l[39]])==null?void 0:k.comment,30)+"",i,I,P,j,S,w,J,R=((O=l[8])==null?void 0:O[l[39]])&&tt(l),p=((u=l[8])==null?void 0:u[l[39]])&&st(l);return{c(){var b,T;s=g("tr"),t=g("th"),o=B(e),r=N(),_=g("td"),i=B(E),P=N(),j=g("td"),R&&R.c(),S=N(),w=g("td"),p&&p.c(),J=N(),c(t,"title",n=ge(l[39],30)),c(_,"title",I=ge((T=(b=l[8])==null?void 0:b[l[39]])==null?void 0:T.comment,30)),c(j,"class","p-0"),c(w,"class","p-0 text-center"),c(s,"class","hover")},m(b,T){te(b,s,T),a(s,t),a(t,o),a(s,r),a(s,_),a(_,i),a(s,P),a(s,j),R&&R.m(j,null),a(s,S),a(s,w),p&&p.m(w,null),a(s,J)},p(b,T){var v,W,ne,fe,K,ae;T[0]&448&&e!==(e=se(b[39],30)+"")&&y(o,e),T[0]&960&&n!==(n=ge(b[39],30))&&c(t,"title",n),T[0]&448&&E!==(E=se((W=(v=b[8])==null?void 0:v[b[39]])==null?void 0:W.comment,30)+"")&&y(i,E),T[0]&960&&I!==(I=ge((fe=(ne=b[8])==null?void 0:ne[b[39]])==null?void 0:fe.comment,30))&&c(_,"title",I),(K=b[8])!=null&&K[b[39]]?R?R.p(b,T):(R=tt(b),R.c(),R.m(j,null)):R&&(R.d(1),R=null),(ae=b[8])!=null&&ae[b[39]]?p?p.p(b,T):(p=st(b),p.c(),p.m(w,null)):p&&(p.d(1),p=null)},d(b){b&&le(s),R&&R.d(),p&&p.d()}}}function ft(l){let s,t;return s=new gt({props:{open:l[12]}}),{c(){Le(s.$$.fragment)},m(e,o){je(s,e,o),t=!0},p(e,o){const n={};o[0]&4096&&(n.open=e[12]),s.$set(n)},i(e){t||(ee(s.$$.fragment,e),t=!0)},o(e){re(s.$$.fragment,e),t=!1},d(e){Ee(s,e)}}}function at(l){let s,t;return s=new dt({props:{open:l[11].open,type:l[11].type,msg:l[11].msg,timer:2e4}}),s.$on("dismiss",l[35]),{c(){Le(s.$$.fragment)},m(e,o){je(s,e,o),t=!0},p(e,o){const n={};o[0]&2048&&(n.open=e[11].open),o[0]&2048&&(n.type=e[11].type),o[0]&2048&&(n.msg=e[11].msg),s.$set(n)},i(e){t||(ee(s.$$.fragment,e),t=!0)},o(e){re(s.$$.fragment,e),t=!1},d(e){Ee(s,e)}}}function qt(l){let s,t,e,o,n,r,_,E,i,I,P,j,S,w,J,R,p,m,k,O,u,b,T,v=l[14].t("crud.save_as_tmp")+"",W,ne,fe,K,ae,de,$,me,ce,ue,be,oe,H,Y,z,ke,we=se(l[14].t("crud.match"),30)+"",f,d,C,G,Z,M=l[14].t("crud.preview")+"",_e,pe,L=l[14].t("crud.file")+"",A,x,F,Ce,ie,Q,V,Se,qe,Ie,D,Te,Fe;n=new ze({props:{type:"outline",icon:"link",path:"icons"}}),R=new ze({props:{type:"outline",icon:"paper-clip",path:"icons"}}),ce=new ze({props:{type:"outline",icon:"refresh",path:"icons"}});const We=[jt,Lt],Oe=[];function De(h,q){var Re;return h[1]===0?0:h[1]===1&&((Re=h[10])==null?void 0:Re.length)>0?1:-1}~(Q=De(l))&&(V=Oe[Q]=We[Q](l));let U=l[12]&&ft(l),X=l[11].open&&at(l);return{c(){var h;s=g("div"),t=g("div"),e=g("a"),o=g("span"),Le(n.$$.fragment),E=N(),i=g("input"),S=N(),w=g("button"),J=g("span"),Le(R.$$.fragment),m=N(),k=g("div"),O=g("label"),u=g("input"),T=g("span"),W=B(v),fe=N(),K=g("input"),de=N(),$=g("button"),me=g("span"),Le(ce.$$.fragment),oe=N(),H=g("div"),Y=g("div"),z=g("span"),ke=g("b"),f=B(we),C=N(),G=g("span"),Z=g("b"),_e=B(M),pe=N(),A=B(L),F=N(),Ce=g("span"),Ce.innerHTML="<b></b>",ie=N(),V&&V.c(),Se=N(),U&&U.c(),qe=N(),X&&X.c(),Ie=ot(),c(o,"class","w-5 h-5"),c(e,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),c(e,"title",r=l[14].t("crud.download")),c(e,"target","_blank"),c(e,"href",_=`${Ve((h=l[13])==null?void 0:h.conf,!0)}/${l[2]}`),He(e,"display",l[2]?null:"none"),c(i,"type","text"),c(i,"id",I=`${l[0]}-file-to-import`),c(i,"placeholder",P=l[14].t("crud.file")),c(i,"class",j="grow input "+(l[2]?"pl-8":"")+" pr-8 input-bordered w-full input-sm"),c(i,"autocomplete","off"),c(i,"autocorrect","off"),c(J,"class","w-5 h-5"),c(w,"class","btn btn-square btn-ghost btn-sm -ml-8 z-[1]"),c(w,"title",p=`${l[14].t("crud.attach")} ${l[14].t("crud.file")}`),c(u,"type","checkbox"),c(u,"class","checkbox checkbox-sm mr-2"),c(u,"id",b=l[0]+"-tmp"),c(T,"class","label-text"),c(O,"class","label cursor-pointer justify-start"),c(O,"for",ne=l[0]+"-tmp"),c(k,"class","form-control w-auto p-0 ml-2"),c(K,"type","file"),c(K,"id",ae=`${l[0]}-file-to-import-file`),He(K,"display","none"),c(me,"class","w-5 h-5"),c($,"class","btn btn-square btn-sm ml-2"),c($,"title",ue=`${l[14].t("crud.refresh")}`),$.disabled=be=!l[2],c(t,"class","flex mb-2 mt-2"),c(ke,"class","pr-2"),c(z,"class",d="tab tab-lifted text-md "+(l[1]===0?"tab-active active":"")),c(Z,"class","pr-2"),c(G,"class",x="tab tab-lifted text-md "+(l[1]===1?"tab-active active":"")),c(Ce,"class","tab tab-lifted text-md grow"),c(Y,"class","tabs w-full"),c(H,"class","grow w-full"),c(s,"class","flex flex-col")},m(h,q){te(h,s,q),a(s,t),a(t,e),a(e,o),je(n,o,null),a(t,E),a(t,i),Pe(i,l[2]),a(t,S),a(t,w),a(w,J),je(R,J,null),a(t,m),a(t,k),a(k,O),a(O,u),u.checked=l[3],a(O,T),a(T,W),a(t,fe),a(t,K),a(t,de),a(t,$),a($,me),je(ce,me,null),a(s,oe),a(s,H),a(H,Y),a(Y,z),a(z,ke),a(ke,f),a(Y,C),a(Y,G),a(G,Z),a(Z,_e),a(Z,pe),a(Z,A),a(Y,F),a(Y,Ce),a(H,ie),~Q&&Oe[Q].m(H,null),te(h,Se,q),U&&U.m(h,q),te(h,qe,q),X&&X.m(h,q),te(h,Ie,q),D=!0,Te||(Fe=[ve(i,"input",l[24]),ve(w,"click",l[25]),ve(u,"change",l[26]),ve(K,"change",l[27]),ve($,"click",l[28]),ve(z,"click",Be(l[29])),ve(G,"click",Be(l[30]))],Te=!0)},p(h,q){var Ge;(!D||q[0]&16384&&r!==(r=h[14].t("crud.download")))&&c(e,"title",r),(!D||q[0]&8196&&_!==(_=`${Ve((Ge=h[13])==null?void 0:Ge.conf,!0)}/${h[2]}`))&&c(e,"href",_),q[0]&4&&He(e,"display",h[2]?null:"none"),(!D||q[0]&1&&I!==(I=`${h[0]}-file-to-import`))&&c(i,"id",I),(!D||q[0]&16384&&P!==(P=h[14].t("crud.file")))&&c(i,"placeholder",P),(!D||q[0]&4&&j!==(j="grow input "+(h[2]?"pl-8":"")+" pr-8 input-bordered w-full input-sm"))&&c(i,"class",j),q[0]&4&&i.value!==h[2]&&Pe(i,h[2]),(!D||q[0]&16384&&p!==(p=`${h[14].t("crud.attach")} ${h[14].t("crud.file")}`))&&c(w,"title",p),(!D||q[0]&1&&b!==(b=h[0]+"-tmp"))&&c(u,"id",b),q[0]&8&&(u.checked=h[3]),(!D||q[0]&16384)&&v!==(v=h[14].t("crud.save_as_tmp")+"")&&y(W,v),(!D||q[0]&1&&ne!==(ne=h[0]+"-tmp"))&&c(O,"for",ne),(!D||q[0]&1&&ae!==(ae=`${h[0]}-file-to-import-file`))&&c(K,"id",ae),(!D||q[0]&16384&&ue!==(ue=`${h[14].t("crud.refresh")}`))&&c($,"title",ue),(!D||q[0]&4&&be!==(be=!h[2]))&&($.disabled=be),(!D||q[0]&16384)&&we!==(we=se(h[14].t("crud.match"),30)+"")&&y(f,we),(!D||q[0]&2&&d!==(d="tab tab-lifted text-md "+(h[1]===0?"tab-active active":"")))&&c(z,"class",d),(!D||q[0]&16384)&&M!==(M=h[14].t("crud.preview")+"")&&y(_e,M),(!D||q[0]&16384)&&L!==(L=h[14].t("crud.file")+"")&&y(A,L),(!D||q[0]&2&&x!==(x="tab tab-lifted text-md "+(h[1]===1?"tab-active active":"")))&&c(G,"class",x);let Re=Q;Q=De(h),Q===Re?~Q&&Oe[Q].p(h,q):(V&&(Me(),re(Oe[Re],1,1,()=>{Oe[Re]=null}),Ae()),~Q?(V=Oe[Q],V?V.p(h,q):(V=Oe[Q]=We[Q](h),V.c()),ee(V,1),V.m(H,null)):V=null),h[12]?U?(U.p(h,q),q[0]&4096&&ee(U,1)):(U=ft(h),U.c(),ee(U,1),U.m(qe.parentNode,qe)):U&&(Me(),re(U,1,1,()=>{U=null}),Ae()),h[11].open?X?(X.p(h,q),q[0]&2048&&ee(X,1)):(X=at(h),X.c(),ee(X,1),X.m(Ie.parentNode,Ie)):X&&(Me(),re(X,1,1,()=>{X=null}),Ae())},i(h){D||(ee(n.$$.fragment,h),ee(R.$$.fragment,h),ee(ce.$$.fragment,h),ee(V),ee(U),ee(X),D=!0)},o(h){re(n.$$.fragment,h),re(R.$$.fragment,h),re(ce.$$.fragment,h),re(V),re(U),re(X),D=!1},d(h){h&&(le(s),le(Se),le(qe),le(Ie)),Ee(n),Ee(R),Ee(ce),~Q&&Oe[Q].d(),U&&U.d(h),X&&X.d(h),Te=!1,_t(Fe)}}}function It(l,s,t){let e,o;Je(l,pt,f=>t(13,e=f)),Je(l,mt,f=>t(14,o=f));let{table:n}=s,{main_table:r}=s,{action:_={}}=s,{data:E={}}=s,{option:i={}}=s,I=0,P,j=!0,S=10,w=0,J=10,R=0,p={},m=[],k=[],O={},u={open:!1,msg:null,type:null},b=!1;const T=async f=>{t(12,b=!0);const d={lang:e==null?void 0:e.lang,conf:e==null?void 0:e.conf,token:e==null?void 0:e.token,app:e==null?void 0:e.selected_app,table:n,data:k};if(!d.data||!d.table)return t(12,b=!1),null;const C=await bt(d);C.success===!0?(t(11,u.open=!0,u),t(11,u.type="success",u),t(11,u.msg=C.msg,u),C!=null&&C.inserted_primary_key,await ae({table:n,main_table:r,data:E}),await W({file:P,tmp:j})):(t(11,u.open=!0,u),t(11,u.type="error",u),t(11,u.msg=C.msg,u)),t(12,b=!1)},v=f=>{try{document.getElementById(f.id).click()}catch(d){console.log(d.message)}},W=async f=>{var d;if(f.file){t(12,b=!0);const C={lang:e==null?void 0:e.lang,conf:e==null?void 0:e.conf,token:e==null?void 0:e.token,app:e==null?void 0:e.selected_app,_method:"dump_file_2_object",data:f},G=await kt(C);if(G.success===!0&&G.data){t(10,k=G.data),t(1,I=1);for(let L=0;L<k.length;L++)t(10,k[L]={...k[L],...E,order:L+1,field_order:L+1},k);t(9,m=Object.keys(k[0])),m.forEach(L=>{var A,x,F,Ce;if(p!=null&&p[L])t(8,p[L].file_field_match=L,p);else for(const ie in p){const Q=new RegExp(ie.replace("sql_","").replace("field_",""),"i");if(Object.hasOwnProperty.call(p,ie)&&(((A=p[ie])==null?void 0:A.comment.toLowerCase())===L.toLowerCase()||((x=p[ie])==null?void 0:x.field.toLowerCase())===L.toLowerCase()||L.match(Q))&&t(8,p[ie].file_field_match=L,p),i!=null&&i.data){if((F=i==null?void 0:i.data)!=null&&F[ie]&&!p[ie].file_field_match){for(let V=0;V<m.length;V++)if(((Ce=i==null?void 0:i.data)==null?void 0:Ce[ie].indexOf(m[V].toLowerCase()))!==-1){t(8,p[ie].file_field_match=m[V],p);break}}}}});let Z=((d=i==null?void 0:i.data)==null?void 0:d.key)||"field_name";k.map(L=>{var x;for(const F in p)Object.hasOwnProperty.call(p,F)&&p[F].file_field_match&&(L[F]=L[p[F].file_field_match]);let A=O.filter(F=>F[Z]===L[Z]);for(const F in(A==null?void 0:A[0])||{})Object.hasOwnProperty.call(A==null?void 0:A[0],F)&&(p!=null&&p[F])&&!F.match(/sql|SQL|SELECT|WHERE|FROM|GROUP|ORDER|HAVING|JOIN|WINDOW/i)&&(L[F]||(L[F]=(x=A==null?void 0:A[0])==null?void 0:x[F]),p[F].file_field_match||t(8,p[F].file_field_match=F,p));return L});const M=k.map(L=>L==null?void 0:L[Z]),_e=k.map(L=>{var A,x;return L==null?void 0:L[(x=(A=e==null?void 0:e.tables)==null?void 0:A[n])==null?void 0:x.pk]});let pe=O.filter(L=>{var A,x;return M.indexOf(L[Z])===-1||_e.indexOf(L[(x=(A=e==null?void 0:e.tables)==null?void 0:A[n])==null?void 0:x.pk])===-1});pe=pe.map(L=>({...L,excluded:!0,table:n})),t(10,k=[...k,...pe])}else t(11,u.open=!0,u),t(11,u.type="error",u),t(11,u.msg=G.msg,u);t(12,b=!1)}},ne=async f=>{t(12,b=!0);try{t(2,P=f.event.currentTarget.files[0].name);const d={lang:e==null?void 0:e.lang,conf:e==null?void 0:e.conf,token:e==null?void 0:e.token,file:f.event.currentTarget.files[0],tmp:j,path:null},C=await wt(d);C.success===!0?(t(2,P=C.file),t(11,u.open=!0,u),t(11,u.type="success",u),t(11,u.msg=C.msg,u),await W({file:P,tmp:j})):(t(11,u.open=!0,u),t(11,u.type="error",u),t(11,u.msg=C.msg,u))}catch(d){console.log(d.message),t(11,u.open=!0,u),t(11,u.type="error",u),t(11,u.msg=d.message,u)}t(12,b=!1)},fe=f=>{f.type==="next"?t(5,w+=1):f.type==="back"?t(5,w-=1):f.type==="first"?t(5,w=0):f.type==="last"?t(5,w=Math.ceil(S/((k==null?void 0:k.length)||S))):f.type==="rows_per_page"&&(t(4,S=f.rows_per_page),t(5,w=0))},K=f=>{f.type==="next"?t(7,R+=1):f.type==="back"?t(7,R-=1):f.type==="first"?t(7,R=0):f.type==="last"?t(7,R=Math.ceil(J/((k==null?void 0:k.length)||S))):f.type==="rows_per_page"&&(t(6,J=f.rows_per_page),t(7,R=0))},ae=async f=>{var G;f.no_loding||t(12,b=!0);const d={lang:e==null?void 0:e.lang,conf:e==null?void 0:e.conf,token:e==null?void 0:e.token,app:e==null?void 0:e.selected_app,table:n,filters:[{field:"etl_rbase_output_id",cond:"=",value:(G=f==null?void 0:f.data)==null?void 0:G.etl_rbase_output_id}],limit:-1},C=await vt(d);console.log("_data_uploaded:",d,C),C.success===!0&&C.data?O=C.data:(t(11,u.open=!0,u),t(11,u.type="error",u),t(11,u.msg=C.msg,u)),t(12,b=!1)};ht(()=>{var f,d,C,G,Z,M,_e;o.changeLanguage(e==null?void 0:e.lang),console.log(n,r,i,E,(f=e==null?void 0:e.tables)==null?void 0:f[n]);try{Qe.locale(e==null?void 0:e.lang)}catch{Qe.locale("en-us")}for(let pe in((C=(d=e==null?void 0:e.tables)==null?void 0:d[n])==null?void 0:C.fields)||{})t(8,p[pe]={field:pe,comment:(_e=(M=(Z=(G=e==null?void 0:e.tables)==null?void 0:G[n])==null?void 0:Z.fields)==null?void 0:M[pe])==null?void 0:_e.comment,file_field_match:null},p);ae({table:n,main_table:r,data:E})});function de(){P=this.value,t(2,P)}const $=f=>v({id:`${n}-file-to-import-file`});function me(){j=this.checked,t(3,j)}const ce=f=>ne({event:f}),ue=f=>W({file:P,tmp:j}),be=()=>{t(1,I=0)},oe=()=>{t(1,I=1)};function H(f){p[f].file_field_match=Ot(this),t(8,p),t(9,m)}function Y(f){p[f].deactivate=this.checked,t(8,p),t(9,m)}const z=f=>K(f.detail),ke=f=>fe(f.detail),we=f=>{t(11,u.open=!1,u)};return l.$$set=f=>{"table"in f&&t(0,n=f.table),"main_table"in f&&t(20,r=f.main_table),"action"in f&&t(21,_=f.action),"data"in f&&t(22,E=f.data),"option"in f&&t(23,i=f.option)},l.$$.update=()=>{var f,d,C;l.$$.dirty[0]&1&&console.log({table:n}),l.$$.dirty[0]&2097152&&(((f=_==null?void 0:_.name)==null?void 0:f.toLowerCase())=="CANCEL".toLowerCase()&&(_==null||_.action()),((d=_==null?void 0:_.name)==null?void 0:d.toLowerCase())=="REFRESH".toLowerCase()&&console.log(_),((C=_==null?void 0:_.name)==null?void 0:C.toLowerCase())=="SAVE".toLowerCase()&&(console.log(_),T()))},[n,I,P,j,S,w,J,R,p,m,k,u,b,e,o,v,W,ne,fe,K,r,_,E,i,de,$,me,ce,ue,be,oe,H,Y,z,ke,we]}class Tt extends rt{constructor(s){super(),ct(this,s,It,qt,ut,{table:0,main_table:20,action:21,data:22,option:23},null,[-1,-1])}}export{Tt as default};
