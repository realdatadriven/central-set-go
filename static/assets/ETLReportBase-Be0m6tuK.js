const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./GlobalForm-ciaD9fnn.js","./index-XSy4RcHY.js","./index-CFjTrgiX.css","./pt-C8dmXWAd.js","./ObjectEditor-C_zv1y2x.js","./PickDates-Dg1OZM7q.js","./DBExplorer-ivI6VOVv.js","./Pagination-CGKBM0ax.js","./CrudHandler-DyhX_xV5.js","./EditConf-B2sqiuCT.js"])))=>i.map(i=>d[i]);
import{S as SvelteComponent,i as init,s as safe_not_equal,D as hooks,e as ensure_array_like,a as element,b as space,t as text,d as attr,f as set_style,g as insert,h as append,o as transition_in,p as group_outros,r as check_outros,n as set_data,q as transition_out,u as detach,w as destroy_each,y as component_subscribe,z as _global,A as i18n,C as onMount,l as lodashExports,G as string_ellipsis,H as string_ellipsis_title,k as listen,E as prevent_default,F as empty,N as Loadingv2,c as create_component,m as mount_component,v as destroy_component,T as Toast,J as assign,M as Modal,K as get_spread_update,L as get_spread_object,Z as create_update,P as read,R as __vitePreload,ab as upload,a2 as select_value,W as gbl_api_call,$ as format_number,I as Icons,j as set_input_value,x as run_all,X as noop,a6 as HtmlTag,a8 as get_upload_api,a3 as add_render_callback,a4 as select_option}from"./index-XSy4RcHY.js";import"./pt-C8dmXWAd.js";import{P as Pagination}from"./Pagination-CGKBM0ax.js";function get_each_context(e,t,n){const l=e.slice();return l[86]=t[n],l[87]=t,l[88]=n,l}function get_each_context_2(e,t,n){const l=e.slice();return l[89]=t[n],l[92]=t,l[93]=n,l}function get_each_context_3(e,t,n){const l=e.slice();return l[94]=t[n],l[95]=t,l[96]=n,l}function get_each_context_4(e,t,n){const l=e.slice();return l[97]=t[n],l}function get_each_context_5(e,t,n){const l=e.slice();return l[94]=t[n],l[100]=t,l[101]=n,l}function get_each_context_6(e,t,n){const l=e.slice();return l[102]=t[n],l}function get_each_context_1(e,t,n){const l=e.slice();return l[89]=t[n],l}function get_each_context_7(e,t,n){const l=e.slice();return l[86]=t[n],l[88]=n,l}function create_each_block_7(e){let t,n,l=string_ellipsis(e[86].label,30)+"",a,r,s,o,_;function i(){return e[33](e[88])}return{c(){var c;t=element("li"),n=element("b"),a=text(l),attr(t,"class",r="step step-lifted text-sm cursor-pointer "+(e[5]>=e[88]?" step-primary ":"")),attr(t,"title",s=string_ellipsis_title(e[86].label,30)),set_style(t,"display",e[16](((c=e[86])==null?void 0:c.show)||"true",e[86],null,e[1])?null:"none")},m(c,u){insert(c,t,u),append(t,n),append(n,a),o||(_=listen(t,"click",prevent_default(i)),o=!0)},p(c,u){var m;e=c,u[0]&4&&l!==(l=string_ellipsis(e[86].label,30)+"")&&set_data(a,l),u[0]&32&&r!==(r="step step-lifted text-sm cursor-pointer "+(e[5]>=e[88]?" step-primary ":""))&&attr(t,"class",r),u[0]&4&&s!==(s=string_ellipsis_title(e[86].label,30))&&attr(t,"title",s),u[0]&6&&set_style(t,"display",e[16](((m=e[86])==null?void 0:m.show)||"true",e[86],null,e[1])?null:"none")},d(c){c&&detach(t),o=!1,_()}}}function create_if_block_3(e){let t,n,l,a,r;const s=[create_if_block_4,create_else_block],o=[];function _(i,c){var u,m;return((u=i[86])==null?void 0:u.table)==="etl_rb_reconcilia"&&((m=i[86])!=null&&m.show_html)?0:1}return n=_(e),l=o[n]=s[n](e),{c(){t=element("div"),l.c(),a=space(),attr(t,"class","w-full p-2")},m(i,c){insert(i,t,c),o[n].m(t,null),append(t,a),r=!0},p(i,c){let u=n;n=_(i),n===u?o[n].p(i,c):(group_outros(),transition_out(o[u],1,1,()=>{o[u]=null}),check_outros(),l=o[n],l?l.p(i,c):(l=o[n]=s[n](i),l.c()),transition_in(l,1),l.m(t,a))},i(i){r||(transition_in(l),r=!0)},o(i){transition_out(l),r=!1},d(i){i&&detach(t),o[n].d()}}}function create_else_block(e){var D,N,G,x,y,ne,le,B,ae,re,_e,oe,ce,ue,de,fe,me,be,$,Q,ie,F,ke,$e,he;let t,n,l,a,r,s,o,_,i,c,u,m,b,f,h,p,g,w,v,E,Y,T,O,C,U,K,W,P=(e[5]===0||((D=e[86])==null?void 0:D.date_ref))&&create_if_block_30(e);s=new Icons({props:{type:"outline",icon:"search",path:"icons"}});function J(){e[38].call(_,e[87],e[88])}let R=ensure_array_like(((N=e[86])==null?void 0:N.pre_filters)||[]),A=[];for(let I=0;I<R.length;I+=1)A[I]=create_each_block_6(get_each_context_6(e,R,I));let M=((G=e[86])==null?void 0:G.dates_refs)&&create_if_block_29(e),H=((x=e[86])==null?void 0:x.table)==="etl_report_base_log"&&((B=(le=(ne=e[4])==null?void 0:ne[(y=e[86])==null?void 0:y.table])==null?void 0:le.data)==null?void 0:B.length)>0&&create_if_block_28(e),z=ensure_array_like(((ae=e[86])==null?void 0:ae.fields)||[]),k=[];for(let I=0;I<z.length;I+=1)k[I]=create_each_block_5(get_each_context_5(e,z,I));const L=I=>transition_out(k[I],1,1,()=>{k[I]=null});let V=e[9]&&create_if_block_18(e),Z=ensure_array_like(e[11](e[86],(oe=(_e=e[4])==null?void 0:_e[(re=e[86])==null?void 0:re.table])==null?void 0:oe.data).slice((((ce=e[86])==null?void 0:ce.offset)||0)*(((ue=e[86])==null?void 0:ue.limit)||10),(((de=e[86])==null?void 0:de.offset)||0)*(((fe=e[86])==null?void 0:fe.limit)||10)+(((me=e[86])==null?void 0:me.limit)||10))),S=[];for(let I=0;I<Z.length;I+=1)S[I]=create_each_block_2(get_each_context_2(e,Z,I));const ee=I=>transition_out(S[I],1,1,()=>{S[I]=null});function te(...I){return e[67](e[86],e[88],...I)}return C=new Pagination({props:{lang:(be=e[12])==null?void 0:be.lang,conf:($=e[12])==null?void 0:$.conf,rows_per_page:((Q=e[86])==null?void 0:Q.limit)||10,page:((ie=e[86])==null?void 0:ie.offset)||0,total_rows:(he=e[11](e[86],($e=(ke=e[4])==null?void 0:ke[(F=e[86])==null?void 0:F.table])==null?void 0:$e.data))==null?void 0:he.length}}),C.$on("pageChange",te),{c(){var I;t=element("div"),P&&P.c(),n=space(),l=element("div"),a=element("button"),r=element("span"),create_component(s.$$.fragment),o=space(),_=element("input"),u=space(),m=element("datalist");for(let q=0;q<A.length;q+=1)A[q].c();b=space(),M&&M.c(),f=space(),H&&H.c(),h=space(),p=element("div"),g=element("table"),w=element("thead"),v=element("tr");for(let q=0;q<k.length;q+=1)k[q].c();E=space(),Y=element("tbody"),V&&V.c(),T=space();for(let q=0;q<S.length;q+=1)S[q].c();O=space(),create_component(C.$$.fragment),attr(r,"class","w-5 h-5"),attr(a,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),attr(_,"type","text"),attr(_,"name",i=`${(I=e[86])==null?void 0:I.table}_filter`),attr(_,"placeholder",c=`${e[13].t("crud.filter")} ${e[86].label}`),attr(_,"class","grow input pl-8 input-bordered w-full input-sm"),attr(_,"autocomplete","off"),attr(_,"autocorrect","off"),attr(_,"list",`pre_filter_${e[88]}`),attr(m,"id",`pre_filter_${e[88]}`),attr(l,"class","w-64 flex"),attr(t,"class","p-2 w-full flex flex-row gap-2"),attr(g,"class","table table-zebra w-[98%] normal-case table-xs"),attr(p,"class","w-full overflow-x-auto")},m(I,q){insert(I,t,q),P&&P.m(t,null),append(t,n),append(t,l),append(l,a),append(a,r),mount_component(s,r,null),append(l,o),append(l,_),set_input_value(_,e[86].filter),append(l,u),append(l,m);for(let X=0;X<A.length;X+=1)A[X]&&A[X].m(m,null);append(t,b),M&&M.m(t,null),append(t,f),H&&H.m(t,null),insert(I,h,q),insert(I,p,q),append(p,g),append(g,w),append(w,v);for(let X=0;X<k.length;X+=1)k[X]&&k[X].m(v,null);append(g,E),append(g,Y),V&&V.m(Y,null),append(Y,T);for(let X=0;X<S.length;X+=1)S[X]&&S[X].m(Y,null);insert(I,O,q),mount_component(C,I,q),U=!0,K||(W=listen(_,"input",J),K=!0)},p(I,q){var ge,pe,ve,we,De,Ee,qe,Ye,Oe,Me,Te,Ie,Ne,je,Le,Pe,Ce,Re,Se,Ae,ze,Be,Fe,He,Je,Ve;if(e=I,e[5]===0||(ge=e[86])!=null&&ge.date_ref?P?(P.p(e,q),q[0]&36&&transition_in(P,1)):(P=create_if_block_30(e),P.c(),transition_in(P,1),P.m(t,n)):P&&(group_outros(),transition_out(P,1,1,()=>{P=null}),check_outros()),(!U||q[0]&4&&i!==(i=`${(pe=e[86])==null?void 0:pe.table}_filter`))&&attr(_,"name",i),(!U||q[0]&8196&&c!==(c=`${e[13].t("crud.filter")} ${e[86].label}`))&&attr(_,"placeholder",c),q[0]&4&&_.value!==e[86].filter&&set_input_value(_,e[86].filter),q[0]&4){R=ensure_array_like(((ve=e[86])==null?void 0:ve.pre_filters)||[]);let j;for(j=0;j<R.length;j+=1){const se=get_each_context_6(e,R,j);A[j]?A[j].p(se,q):(A[j]=create_each_block_6(se),A[j].c(),A[j].m(m,null))}for(;j<A.length;j+=1)A[j].d(1);A.length=R.length}if((we=e[86])!=null&&we.dates_refs?M?(M.p(e,q),q[0]&4&&transition_in(M,1)):(M=create_if_block_29(e),M.c(),transition_in(M,1),M.m(t,f)):M&&(group_outros(),transition_out(M,1,1,()=>{M=null}),check_outros()),((De=e[86])==null?void 0:De.table)==="etl_report_base_log"&&((Oe=(Ye=(qe=e[4])==null?void 0:qe[(Ee=e[86])==null?void 0:Ee.table])==null?void 0:Ye.data)==null?void 0:Oe.length)>0?H?(H.p(e,q),q[0]&20&&transition_in(H,1)):(H=create_if_block_28(e),H.c(),transition_in(H,1),H.m(t,null)):H&&(group_outros(),transition_out(H,1,1,()=>{H=null}),check_outros()),q[0]&302658055){z=ensure_array_like(((Me=e[86])==null?void 0:Me.fields)||[]);let j;for(j=0;j<z.length;j+=1){const se=get_each_context_5(e,z,j);k[j]?(k[j].p(se,q),transition_in(k[j],1)):(k[j]=create_each_block_5(se),k[j].c(),transition_in(k[j],1),k[j].m(v,null))}for(group_outros(),j=z.length;j<k.length;j+=1)L(j);check_outros()}if(e[9]?V?V.p(e,q):(V=create_if_block_18(e),V.c(),V.m(Y,T)):V&&(V.d(1),V=null),q[0]&702626334){Z=ensure_array_like(e[11](e[86],(Ne=(Ie=e[4])==null?void 0:Ie[(Te=e[86])==null?void 0:Te.table])==null?void 0:Ne.data).slice((((je=e[86])==null?void 0:je.offset)||0)*(((Le=e[86])==null?void 0:Le.limit)||10),(((Pe=e[86])==null?void 0:Pe.offset)||0)*(((Ce=e[86])==null?void 0:Ce.limit)||10)+(((Re=e[86])==null?void 0:Re.limit)||10)));let j;for(j=0;j<Z.length;j+=1){const se=get_each_context_2(e,Z,j);S[j]?(S[j].p(se,q),transition_in(S[j],1)):(S[j]=create_each_block_2(se),S[j].c(),transition_in(S[j],1),S[j].m(Y,null))}for(group_outros(),j=Z.length;j<S.length;j+=1)ee(j);check_outros()}const X={};q[0]&4096&&(X.lang=(Se=e[12])==null?void 0:Se.lang),q[0]&4096&&(X.conf=(Ae=e[12])==null?void 0:Ae.conf),q[0]&4&&(X.rows_per_page=((ze=e[86])==null?void 0:ze.limit)||10),q[0]&4&&(X.page=((Be=e[86])==null?void 0:Be.offset)||0),q[0]&2068&&(X.total_rows=(Ve=e[11](e[86],(Je=(He=e[4])==null?void 0:He[(Fe=e[86])==null?void 0:Fe.table])==null?void 0:Je.data))==null?void 0:Ve.length),C.$set(X)},i(I){if(!U){transition_in(P),transition_in(s.$$.fragment,I),transition_in(M),transition_in(H);for(let q=0;q<z.length;q+=1)transition_in(k[q]);for(let q=0;q<Z.length;q+=1)transition_in(S[q]);transition_in(C.$$.fragment,I),U=!0}},o(I){transition_out(P),transition_out(s.$$.fragment,I),transition_out(M),transition_out(H),k=k.filter(Boolean);for(let q=0;q<k.length;q+=1)transition_out(k[q]);S=S.filter(Boolean);for(let q=0;q<S.length;q+=1)transition_out(S[q]);transition_out(C.$$.fragment,I),U=!1},d(I){I&&(detach(t),detach(h),detach(p),detach(O)),P&&P.d(),destroy_component(s),destroy_each(A,I),M&&M.d(),H&&H.d(),destroy_each(k,I),V&&V.d(),destroy_each(S,I),destroy_component(C,I),K=!1,W()}}}function create_if_block_4(e){var s,o,_;let t,n,l=ensure_array_like(e[11](e[86],(_=(o=e[4])==null?void 0:o[(s=e[86])==null?void 0:s.table])==null?void 0:_.data)),a=[];for(let i=0;i<l.length;i+=1)a[i]=create_each_block_1(get_each_context_1(e,l,i));const r=i=>transition_out(a[i],1,1,()=>{a[i]=null});return{c(){for(let i=0;i<a.length;i+=1)a[i].c();t=empty()},m(i,c){for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(i,c);insert(i,t,c),n=!0},p(i,c){var u,m,b;if(c[0]&134219796){l=ensure_array_like(i[11](i[86],(b=(m=i[4])==null?void 0:m[(u=i[86])==null?void 0:u.table])==null?void 0:b.data));let f;for(f=0;f<l.length;f+=1){const h=get_each_context_1(i,l,f);a[f]?(a[f].p(h,c),transition_in(a[f],1)):(a[f]=create_each_block_1(h),a[f].c(),transition_in(a[f],1),a[f].m(t.parentNode,t))}for(group_outros(),f=l.length;f<a.length;f+=1)r(f);check_outros()}},i(i){if(!n){for(let c=0;c<l.length;c+=1)transition_in(a[c]);n=!0}},o(i){a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)transition_out(a[c]);n=!1},d(i){i&&detach(t),destroy_each(a,i)}}}function create_if_block_30(e){let t,n,l,a,r,s,o,_,i,c,u,m,b,f,h;a=new Icons({props:{type:"outline",icon:"calendar-days",path:"icons"}});function p(){e[35].call(s,e[87],e[88])}function g(...v){return e[36](e[86],...v)}u=new Icons({props:{type:"outline",icon:"arrow-right-on-rectangle",path:"icons"}});function w(...v){return e[37](e[86],...v)}return{c(){t=element("div"),n=element("button"),l=element("span"),create_component(a.$$.fragment),r=space(),s=element("input"),_=space(),i=element("button"),c=element("span"),create_component(u.$$.fragment),attr(l,"class","w-5 h-5"),attr(n,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),attr(s,"type","date"),attr(s,"name","date_ref"),attr(s,"placeholder",o=`${e[13].t("crud.date")} ${e[86].label}`),attr(s,"class","grow input pl-8 input-bordered w-full input-sm"),attr(s,"autocomplete","off"),attr(s,"autocorrect","off"),attr(c,"class","w-5 h-5"),attr(i,"class","btn btn-square btn-ghost btn-sm --ml-8 z-[1]"),attr(i,"title",m=e[13].t("crud.set_date_2_all_steps")),attr(t,"class","w-48 flex")},m(v,E){insert(v,t,E),append(t,n),append(n,l),mount_component(a,l,null),append(t,r),append(t,s),set_input_value(s,e[86].date_ref),append(t,_),append(t,i),append(i,c),mount_component(u,c,null),b=!0,f||(h=[listen(s,"input",p),listen(s,"change",g),listen(i,"click",w)],f=!0)},p(v,E){e=v,(!b||E[0]&8196&&o!==(o=`${e[13].t("crud.date")} ${e[86].label}`))&&attr(s,"placeholder",o),E[0]&4&&set_input_value(s,e[86].date_ref),(!b||E[0]&8192&&m!==(m=e[13].t("crud.set_date_2_all_steps")))&&attr(i,"title",m)},i(v){b||(transition_in(a.$$.fragment,v),transition_in(u.$$.fragment,v),b=!0)},o(v){transition_out(a.$$.fragment,v),transition_out(u.$$.fragment,v),b=!1},d(v){v&&detach(t),destroy_component(a),destroy_component(u),f=!1,run_all(h)}}}function create_each_block_6(e){let t,n=e[102]+"",l,a;return{c(){t=element("option"),l=text(n),t.__value=a=e[102],set_input_value(t,t.__value)},m(r,s){insert(r,t,s),append(t,l)},p(r,s){s[0]&4&&n!==(n=r[102]+"")&&set_data(l,n),s[0]&4&&a!==(a=r[102])&&(t.__value=a,set_input_value(t,t.__value))},d(r){r&&detach(t)}}}function create_if_block_29(e){let t,n,l,a,r,s,o,_,i,c,u;a=new Icons({props:{type:"outline",icon:"calendar-days",path:"icons"}});function m(){return e[39](e[86])}function b(){return e[42](e[86])}return{c(){var f,h,p,g;t=element("div"),n=element("button"),l=element("span"),create_component(a.$$.fragment),r=space(),s=element("input"),attr(l,"class","w-5 h-5"),attr(n,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),attr(s,"type","text"),attr(s,"class","grow input pl-8 input-bordered w-full input-sm"),attr(s,"title",o=string_ellipsis_title((h=(f=e[86])==null?void 0:f.dates_refs)==null?void 0:h.map(e[40]).join(", "),30)),s.value=_=string_ellipsis((g=(p=e[86])==null?void 0:p.dates_refs)==null?void 0:g.map(e[41]).join(", "),30),attr(t,"class","w-64 flex")},m(f,h){insert(f,t,h),append(t,n),append(n,l),mount_component(a,l,null),append(t,r),append(t,s),i=!0,c||(u=[listen(n,"click",m),listen(s,"focus",b)],c=!0)},p(f,h){var p,g,w,v;e=f,(!i||h[0]&8196&&o!==(o=string_ellipsis_title((g=(p=e[86])==null?void 0:p.dates_refs)==null?void 0:g.map(e[40]).join(", "),30)))&&attr(s,"title",o),(!i||h[0]&8196&&_!==(_=string_ellipsis((v=(w=e[86])==null?void 0:w.dates_refs)==null?void 0:v.map(e[41]).join(", "),30))&&s.value!==_)&&(s.value=_)},i(f){i||(transition_in(a.$$.fragment,f),i=!0)},o(f){transition_out(a.$$.fragment,f),i=!1},d(f){f&&detach(t),destroy_component(a),c=!1,run_all(u)}}}function create_if_block_28(e){let t,n,l,a,r,s,o;l=new Icons({props:{type:"outline",icon:"save",path:"icons"}});function _(){return e[43](e[86])}return{c(){t=element("button"),n=element("span"),create_component(l.$$.fragment),attr(n,"class","w-5 h-5"),attr(t,"class","btn btn-square btn-ghost btn-sm"),attr(t,"title",a=e[13].t("crud.save"))},m(i,c){insert(i,t,c),append(t,n),mount_component(l,n,null),r=!0,s||(o=listen(t,"click",_),s=!0)},p(i,c){e=i,(!r||c[0]&8192&&a!==(a=e[13].t("crud.save")))&&attr(t,"title",a)},i(i){r||(transition_in(l.$$.fragment,i),r=!0)},o(i){transition_out(l.$$.fragment,i),r=!1},d(i){i&&detach(t),destroy_component(l),s=!1,o()}}}function create_else_block_7(e){var l,a,r,s,o,_,i,c,u;let t=(((l=e[94])==null?void 0:l.label)||((c=(i=(o=(s=(a=e[12])==null?void 0:a.tables)==null?void 0:s[(r=e[86])==null?void 0:r.table])==null?void 0:o.fields)==null?void 0:i[(_=e[94])==null?void 0:_.name])==null?void 0:c.comment)||((u=e[94])==null?void 0:u.name))+"",n;return{c(){n=text(t)},m(m,b){insert(m,n,b)},p(m,b){var f,h,p,g,w,v,E,Y,T;b[0]&4100&&t!==(t=(((f=m[94])==null?void 0:f.label)||((Y=(E=(w=(g=(h=m[12])==null?void 0:h.tables)==null?void 0:g[(p=m[86])==null?void 0:p.table])==null?void 0:w.fields)==null?void 0:E[(v=m[94])==null?void 0:v.name])==null?void 0:Y.comment)||((T=m[94])==null?void 0:T.name))+"")&&set_data(n,t)},i:noop,o:noop,d(m){m&&detach(n)}}}function create_if_block_27(e){var b,f,h,p,g,w,v,E;let t,n,l,a,r,s=(((b=e[94])==null?void 0:b.label)||((E=(v=(g=(p=(f=e[12])==null?void 0:f.tables)==null?void 0:p[(h=e[86])==null?void 0:h.table])==null?void 0:g.fields)==null?void 0:v[(w=e[94])==null?void 0:w.name])==null?void 0:E.comment))+"",o,_,i,c;function u(){e[49].call(l,e[94],e[87],e[88])}function m(...Y){return e[50](e[94],e[86],...Y)}return{c(){var Y,T;t=element("div"),n=element("label"),l=element("input"),r=element("span"),o=text(s),attr(l,"type","checkbox"),attr(l,"id",a=`${e[94].name}-${(Y=e[86])==null?void 0:Y.table}-${e[101]}`),attr(l,"class","toggle toggle-sm toggle-primary mr-2"),l.disabled=e[9],attr(r,"class","label-text font-normal"),attr(n,"class","label cursor-pointer justify-start p-0"),attr(n,"for",_=`${e[94].name}-${(T=e[86])==null?void 0:T.table}-${e[101]}`),attr(t,"class","form-control w-full max-w-xs m-auto p-0")},m(Y,T){var O;insert(Y,t,T),append(t,n),append(n,l),l.checked=e[86][(O=e[94])==null?void 0:O.name],append(n,r),append(r,o),i||(c=[listen(l,"change",u),listen(l,"change",m)],i=!0)},p(Y,T){var O,C,U,K,W,P,J,R,A,M,H;e=Y,T[0]&4&&a!==(a=`${e[94].name}-${(O=e[86])==null?void 0:O.table}-${e[101]}`)&&attr(l,"id",a),T[0]&512&&(l.disabled=e[9]),T[0]&4&&(l.checked=e[86][(C=e[94])==null?void 0:C.name]),T[0]&4100&&s!==(s=(((U=e[94])==null?void 0:U.label)||((M=(A=(J=(P=(K=e[12])==null?void 0:K.tables)==null?void 0:P[(W=e[86])==null?void 0:W.table])==null?void 0:J.fields)==null?void 0:A[(R=e[94])==null?void 0:R.name])==null?void 0:M.comment))+"")&&set_data(o,s),T[0]&4&&_!==(_=`${e[94].name}-${(H=e[86])==null?void 0:H.table}-${e[101]}`)&&attr(n,"for",_)},i:noop,o:noop,d(Y){Y&&detach(t),i=!1,run_all(c)}}}function create_if_block_19(e){let t,n,l,a;const r=[create_if_block_20,create_if_block_22,create_if_block_23,create_if_block_24,create_else_block_6],s=[];function o(_,i){var c,u,m,b,f,h,p,g;return _[101]===((u=(c=_[86])==null?void 0:c.fields)==null?void 0:u.length)-4?0:_[101]===((b=(m=_[86])==null?void 0:m.fields)==null?void 0:b.length)-3?1:_[101]===((h=(f=_[86])==null?void 0:f.fields)==null?void 0:h.length)-2?2:_[101]===((g=(p=_[86])==null?void 0:p.fields)==null?void 0:g.length)-1?3:4}return t=o(e),n=s[t]=r[t](e),{c(){n.c(),l=empty()},m(_,i){s[t].m(_,i),insert(_,l,i),a=!0},p(_,i){let c=t;t=o(_),t===c?s[t].p(_,i):(group_outros(),transition_out(s[c],1,1,()=>{s[c]=null}),check_outros(),n=s[t],n?n.p(_,i):(n=s[t]=r[t](_),n.c()),transition_in(n,1),n.m(l.parentNode,l))},i(_){a||(transition_in(n),a=!0)},o(_){transition_out(n),a=!1},d(_){_&&detach(l),s[t].d(_)}}}function create_else_block_6(e){let t="",n;return{c(){n=text(t)},m(l,a){insert(l,n,a)},p:noop,i:noop,o:noop,d(l){l&&detach(n)}}}function create_if_block_24(e){let t,n,l,a,r,s;const o=[create_if_block_25,create_if_block_26,create_else_block_5],_=[];function i(c,u){var m,b;return u[0]&4&&(t=null),u[0]&4&&(n=null),t==null&&(t=["data_quality","data_reconcilia","__notify"].indexOf((m=c[86])==null?void 0:m.run_all_action)!==-1),t?0:(n==null&&(n=["notify"].indexOf((b=c[86])==null?void 0:b.run_all_action)!==-1),n?1:2)}return l=i(e,[-1,-1,-1,-1]),a=_[l]=o[l](e),{c(){a.c(),r=empty()},m(c,u){_[l].m(c,u),insert(c,r,u),s=!0},p(c,u){let m=l;l=i(c,u),l===m?_[l].p(c,u):(group_outros(),transition_out(_[m],1,1,()=>{_[m]=null}),check_outros(),a=_[l],a?a.p(c,u):(a=_[l]=o[l](c),a.c()),transition_in(a,1),a.m(r.parentNode,r))},i(c){s||(transition_in(a),s=!0)},o(c){transition_out(a),s=!1},d(c){c&&detach(r),_[l].d(c)}}}function create_if_block_23(e){let t,n,l,a,r,s;l=new Icons({props:{type:"outline",icon:"bolt",path:"icons"}});function o(){return e[46](e[86])}return{c(){t=element("button"),n=element("span"),create_component(l.$$.fragment),attr(n,"class","w-6"),attr(t,"class","btn btn-circle btn-ghost btn-sm text-xs -m-1"),t.disabled=e[9]},m(_,i){insert(_,t,i),append(t,n),mount_component(l,n,null),a=!0,r||(s=listen(t,"click",o),r=!0)},p(_,i){e=_,(!a||i[0]&512)&&(t.disabled=e[9])},i(_){a||(transition_in(l.$$.fragment,_),a=!0)},o(_){transition_out(l.$$.fragment,_),a=!1},d(_){_&&detach(t),destroy_component(l),r=!1,s()}}}function create_if_block_22(e){let t,n,l,a,r,s;l=new Icons({props:{type:"outline",icon:"plus",path:"icons"}});function o(){return e[45](e[86])}return{c(){t=element("button"),n=element("span"),create_component(l.$$.fragment),attr(n,"class","w-6"),attr(t,"class","btn btn-circle btn-ghost btn-sm text-xs -m-1"),t.disabled=e[9]},m(_,i){insert(_,t,i),append(t,n),mount_component(l,n,null),a=!0,r||(s=listen(t,"click",o),r=!0)},p(_,i){e=_,(!a||i[0]&512)&&(t.disabled=e[9])},i(_){a||(transition_in(l.$$.fragment,_),a=!0)},o(_){transition_out(l.$$.fragment,_),a=!1},d(_){_&&detach(t),destroy_component(l),r=!1,s()}}}function create_if_block_20(e){var r;let t=["extract","transform"].indexOf((r=e[86])==null?void 0:r.run_all_action)!==-1,n,l,a=t&&create_if_block_21(e);return{c(){a&&a.c(),n=empty()},m(s,o){a&&a.m(s,o),insert(s,n,o),l=!0},p(s,o){var _;o[0]&4&&(t=["extract","transform"].indexOf((_=s[86])==null?void 0:_.run_all_action)!==-1),t?a?(a.p(s,o),o[0]&4&&transition_in(a,1)):(a=create_if_block_21(s),a.c(),transition_in(a,1),a.m(n.parentNode,n)):a&&(group_outros(),transition_out(a,1,1,()=>{a=null}),check_outros())},i(s){l||(transition_in(a),l=!0)},o(s){transition_out(a),l=!1},d(s){s&&detach(n),a&&a.d(s)}}}function create_else_block_5(e){let t,n,l,a,r,s,o;l=new Icons({props:{type:"outline",icon:"database",path:"icons"}});function _(){return e[48](e[86])}return{c(){t=element("button"),n=element("span"),create_component(l.$$.fragment),attr(n,"class","w-6"),attr(t,"class","btn btn-circle btn-ghost btn-sm text-xs -m-1"),attr(t,"title",a=`${e[13].t("crud.explore_db")}`),t.disabled=e[9]},m(i,c){insert(i,t,c),append(t,n),mount_component(l,n,null),r=!0,s||(o=listen(t,"click",_),s=!0)},p(i,c){e=i,(!r||c[0]&8192&&a!==(a=`${e[13].t("crud.explore_db")}`))&&attr(t,"title",a),(!r||c[0]&512)&&(t.disabled=e[9])},i(i){r||(transition_in(l.$$.fragment,i),r=!0)},o(i){transition_out(l.$$.fragment,i),r=!1},d(i){i&&detach(t),destroy_component(l),s=!1,o()}}}function create_if_block_26(e){let t;return{c(){t=element("span")},m(n,l){insert(n,t,l)},p:noop,i:noop,o:noop,d(n){n&&detach(t)}}}function create_if_block_25(e){let t,n,l,a,r,s,o;l=new Icons({props:{type:"outline",icon:"document-arrow-down",path:"icons"}});function _(){return e[47](e[86])}return{c(){t=element("button"),n=element("span"),create_component(l.$$.fragment),attr(n,"class","w-6"),attr(t,"class","btn btn-circle btn-ghost btn-sm text-xs -m-1"),attr(t,"title",a=`${e[13].t("crud.export")}`),t.disabled=e[9]},m(i,c){insert(i,t,c),append(t,n),mount_component(l,n,null),r=!0,s||(o=listen(t,"click",_),s=!0)},p(i,c){e=i,(!r||c[0]&8192&&a!==(a=`${e[13].t("crud.export")}`))&&attr(t,"title",a),(!r||c[0]&512)&&(t.disabled=e[9])},i(i){r||(transition_in(l.$$.fragment,i),r=!0)},o(i){transition_out(l.$$.fragment,i),r=!1},d(i){i&&detach(t),destroy_component(l),s=!1,o()}}}function create_if_block_21(e){let t,n,l,a,r,s,o;l=new Icons({props:{type:"outline",icon:"trash",path:"icons"}});function _(){return e[44](e[86])}return{c(){t=element("button"),n=element("span"),create_component(l.$$.fragment),attr(n,"class","w-6"),attr(t,"class","btn btn-circle btn-ghost btn-sm text-xs -m-1"),attr(t,"title",a=`${e[13].t("crud.delete")}`),t.disabled=e[9]},m(i,c){insert(i,t,c),append(t,n),mount_component(l,n,null),r=!0,s||(o=listen(t,"click",_),s=!0)},p(i,c){e=i,(!r||c[0]&8192&&a!==(a=`${e[13].t("crud.delete")}`))&&attr(t,"title",a),(!r||c[0]&512)&&(t.disabled=e[9])},i(i){r||(transition_in(l.$$.fragment,i),r=!0)},o(i){transition_out(l.$$.fragment,i),r=!1},d(i){i&&detach(t),destroy_component(l),s=!1,o()}}}function create_each_block_5(e){let t,n,l,a,r,s,o;const _=[create_if_block_19,create_if_block_27,create_else_block_7],i=[];function c(u,m){var b,f;return((b=u[94])==null?void 0:b.type)==="button"?0:((f=u[94])==null?void 0:f.type)==="boolean"?1:2}return n=c(e),l=i[n]=_[n](e),{c(){var u,m,b;t=element("th"),l.c(),a=space(),attr(t,"class",r="normal-case "+(((u=e[94])==null?void 0:u.width)||"")+" "+(((m=e[94])==null?void 0:m.type)==="button"?"p-1":"")),attr(t,"style",s=((b=e[94])==null?void 0:b.style)||"")},m(u,m){insert(u,t,m),i[n].m(t,null),append(t,a),o=!0},p(u,m){var f,h,p;let b=n;n=c(u),n===b?i[n].p(u,m):(group_outros(),transition_out(i[b],1,1,()=>{i[b]=null}),check_outros(),l=i[n],l?l.p(u,m):(l=i[n]=_[n](u),l.c()),transition_in(l,1),l.m(t,a)),(!o||m[0]&4&&r!==(r="normal-case "+(((f=u[94])==null?void 0:f.width)||"")+" "+(((h=u[94])==null?void 0:h.type)==="button"?"p-1":"")))&&attr(t,"class",r),(!o||m[0]&4&&s!==(s=((p=u[94])==null?void 0:p.style)||""))&&attr(t,"style",s)},i(u){o||(transition_in(l),o=!0)},o(u){transition_out(l),o=!1},d(u){u&&detach(t),i[n].d()}}}function create_if_block_18(e){let t,n,l,a;return{c(){var r;t=element("tr"),n=element("td"),l=element("progress"),attr(l,"class","progress progress-primary w-full -mt-1 -mb-3"),set_style(l,"vertical-align","top"),attr(n,"colspan",a=(((r=e[86])==null?void 0:r.fields)||[]).length||1),attr(n,"class","p-0 m-0"),attr(n,"style","line-height: 0rem;!important"),attr(t,"class","p-0")},m(r,s){insert(r,t,s),append(t,n),append(n,l)},p(r,s){var o;s[0]&4&&a!==(a=(((o=r[86])==null?void 0:o.fields)||[]).length||1)&&attr(n,"colspan",a)},d(r){r&&detach(t)}}}function create_else_block_1(e){var s;let t,n,l=ensure_array_like(((s=e[86])==null?void 0:s.fields)||[]),a=[];for(let o=0;o<l.length;o+=1)a[o]=create_each_block_3(get_each_context_3(e,l,o));const r=o=>transition_out(a[o],1,1,()=>{a[o]=null});return{c(){for(let o=0;o<a.length;o+=1)a[o].c();t=empty()},m(o,_){for(let i=0;i<a.length;i+=1)a[i]&&a[i].m(o,_);insert(o,t,_),n=!0},p(o,_){var i;if(_[0]&702626334){l=ensure_array_like(((i=o[86])==null?void 0:i.fields)||[]);let c;for(c=0;c<l.length;c+=1){const u=get_each_context_3(o,l,c);a[c]?(a[c].p(u,_),transition_in(a[c],1)):(a[c]=create_each_block_3(u),a[c].c(),transition_in(a[c],1),a[c].m(t.parentNode,t))}for(group_outros(),c=l.length;c<a.length;c+=1)r(c);check_outros()}},i(o){if(!n){for(let _=0;_<l.length;_+=1)transition_in(a[_]);n=!0}},o(o){a=a.filter(Boolean);for(let _=0;_<a.length;_+=1)transition_out(a[_]);n=!1},d(o){o&&detach(t),destroy_each(a,o)}}}function create_if_block_6(e){var p;let t,n,l,a,r,s,o,_,i,c=((p=e[89])==null?void 0:p.html)+"",u,m,b,f;o=new Icons({props:{type:"outline",icon:"x",path:"icons"}});function h(){return e[51](e[89],e[92],e[93])}return{c(){var g,w,v;t=element("td"),n=element("div"),l=element("span"),a=space(),r=element("button"),s=element("span"),create_component(o.$$.fragment),_=space(),i=new HtmlTag(!1),attr(l,"class","grow"),attr(s,"class","w-5"),attr(r,"class","btn btn-circle btn-ghost btn-sm m-0 text-xs"),set_style(r,"display",(g=e[89])!=null&&g.html?null:"none"),attr(n,"class","flex flex-row z-[2] !-mb-7"),i.a=null,attr(t,"class","normal-case"),attr(t,"colspan",u=(v=(w=e[86])==null?void 0:w.fields)==null?void 0:v.length)},m(g,w){insert(g,t,w),append(t,n),append(n,l),append(n,a),append(n,r),append(r,s),mount_component(o,s,null),append(t,_),i.m(c,t),m=!0,b||(f=listen(r,"click",h),b=!0)},p(g,w){var v,E,Y,T;e=g,w[0]&2068&&set_style(r,"display",(v=e[89])!=null&&v.html?null:"none"),(!m||w[0]&2068)&&c!==(c=((E=e[89])==null?void 0:E.html)+"")&&i.p(c),(!m||w[0]&4&&u!==(u=(T=(Y=e[86])==null?void 0:Y.fields)==null?void 0:T.length))&&attr(t,"colspan",u)},i(g){m||(transition_in(o.$$.fragment,g),m=!0)},o(g){transition_out(o.$$.fragment,g),m=!1},d(g){g&&detach(t),destroy_component(o),b=!1,f()}}}function create_else_block_4(e){let t,n,l,a,r,s,o;function _(){e[66].call(n,e[94],e[92],e[93])}return{c(){var i,c;t=element("td"),n=element("input"),a=space(),attr(n,"type","text"),attr(n,"class",l="input input-xs p-0 "+(((i=e[94])==null?void 0:i.width)||"w-full")+" bg-transparent"),n.disabled=e[9],attr(t,"class",r="p-0.5 "+(((c=e[94])==null?void 0:c.width)||""))},m(i,c){var u;insert(i,t,c),append(t,n),set_input_value(n,e[89][(u=e[94])==null?void 0:u.name]),append(t,a),s||(o=listen(n,"input",_),s=!0)},p(i,c){var u,m,b,f;e=i,c[0]&4&&l!==(l="input input-xs p-0 "+(((u=e[94])==null?void 0:u.width)||"w-full")+" bg-transparent")&&attr(n,"class",l),c[0]&512&&(n.disabled=e[9]),c[0]&2068&&n.value!==e[89][(m=e[94])==null?void 0:m.name]&&set_input_value(n,e[89][(b=e[94])==null?void 0:b.name]),c[0]&4&&r!==(r="p-0.5 "+(((f=e[94])==null?void 0:f.width)||""))&&attr(t,"class",r)},i:noop,o:noop,d(i){i&&detach(t),s=!1,o()}}}function create_if_block_17(e){let t,n,l,a,r,s,o;function _(){e[65].call(n,e[94],e[92],e[93])}return{c(){var i,c;t=element("td"),n=element("input"),a=space(),attr(n,"type","date"),attr(n,"class",l="input input-xs p-0 pl-2 pr-2 "+(((i=e[94])==null?void 0:i.width)||"w-full")+" --input-bordered bg-transparent"),n.disabled=e[9],attr(t,"class",r="p-0.5 "+(((c=e[94])==null?void 0:c.width)||""))},m(i,c){var u;insert(i,t,c),append(t,n),set_input_value(n,e[89][(u=e[94])==null?void 0:u.name]),append(t,a),s||(o=listen(n,"input",_),s=!0)},p(i,c){var u,m,b;e=i,c[0]&4&&l!==(l="input input-xs p-0 pl-2 pr-2 "+(((u=e[94])==null?void 0:u.width)||"w-full")+" --input-bordered bg-transparent")&&attr(n,"class",l),c[0]&512&&(n.disabled=e[9]),c[0]&2068&&set_input_value(n,e[89][(m=e[94])==null?void 0:m.name]),c[0]&4&&r!==(r="p-0.5 "+(((b=e[94])==null?void 0:b.width)||""))&&attr(t,"class",r)},i:noop,o:noop,d(i){i&&detach(t),s=!1,o()}}}function create_if_block_16(e){let t,n,l,a,r,s,o,_,i,c,u,m,b,f,h,p,g,w,v,E,Y,T,O,C,U;r=new Icons({props:{type:"outline",icon:"link",path:"icons"}});function K(){e[56].call(i,e[94],e[92],e[93])}function W(...k){return e[57](e[94],e[86],e[89],e[93],...k)}function P(...k){return e[58](e[94],e[89],e[86],...k)}function J(...k){return e[59](e[94],e[89],e[86],...k)}function R(...k){return e[60](e[94],e[89],e[86],...k)}function A(...k){return e[61](e[94],e[89],e[86],...k)}function M(...k){return e[62](e[94],e[86],e[89],e[93],...k)}p=new Icons({props:{type:"outline",icon:"paper-clip",path:"icons"}});function H(...k){return e[63](e[94],e[86],e[88],e[89],e[93],...k)}function z(...k){return e[64](e[94],e[86],e[89],e[93],...k)}return{c(){var k,L,V,Z,S,ee,te,D,N,G,x,y;t=element("td"),n=element("div"),l=element("a"),a=element("span"),create_component(r.$$.fragment),_=space(),i=element("input"),b=space(),f=element("button"),h=element("span"),create_component(p.$$.fragment),w=space(),v=element("input"),Y=space(),attr(a,"class","w-5 h-5"),attr(l,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),attr(l,"title",s=e[13].t("crud.download")),attr(l,"target","_blank"),attr(l,"href",o=`${get_upload_api((k=e[12])==null?void 0:k.conf,!0)}/${e[89][e[94].name]}`),set_style(l,"display",e[89][e[94].name]&&!((L=e[89])!=null&&L.save_only_temp)?null:"none"),attr(i,"type","text"),attr(i,"id",c=`${(V=e[86])==null?void 0:V.table}-${e[94].name}-${e[88]}-${((Z=e[89])==null?void 0:Z.index)||e[93]}`),attr(i,"name",u=e[94].name),attr(i,"class",m="grow input "+(e[89][e[94].name]&&!((S=e[89])!=null&&S.save_only_temp)?"pl-8":"")+" pr-8 --input-bordered bg-transparent w-full input-sm "+(((N=e[3])==null?void 0:N[`${e[94].name}_${e[89][(D=(te=(ee=e[86])==null?void 0:ee.fields)==null?void 0:te[0])==null?void 0:D.name]}`])||"")),attr(i,"autocomplete","off"),attr(i,"autocorrect","off"),attr(h,"class","w-5 h-5"),attr(f,"class","btn btn-square btn-ghost btn-sm -ml-8 z-[1]"),attr(f,"title",g=`${e[13].t("crud.attach")} ${e[13].t("crud.file")}`),f.disabled=e[9],attr(v,"type","file"),attr(v,"id",E=`${(G=e[86])==null?void 0:G.table}-${e[94].name}-${e[88]}-${((x=e[89])==null?void 0:x.index)||e[93]}-file`),set_style(v,"display","none"),attr(n,"class","flex p-0"),attr(t,"class",T="p-0.5 "+(((y=e[94])==null?void 0:y.width)||""))},m(k,L){insert(k,t,L),append(t,n),append(n,l),append(l,a),mount_component(r,a,null),append(n,_),append(n,i),set_input_value(i,e[89][e[94].name]),append(n,b),append(n,f),append(f,h),mount_component(p,h,null),append(n,w),append(n,v),append(t,Y),O=!0,C||(U=[listen(i,"input",K),listen(i,"drop",W),listen(i,"dragexit",P),listen(i,"dragend",J),listen(i,"dragleave",R),listen(i,"dragenter",A),listen(i,"paste",M),listen(f,"click",H),listen(v,"change",z)],C=!0)},p(k,L){var V,Z,S,ee,te,D,N,G,x,y,ne,le;e=k,(!O||L[0]&8192&&s!==(s=e[13].t("crud.download")))&&attr(l,"title",s),(!O||L[0]&6164&&o!==(o=`${get_upload_api((V=e[12])==null?void 0:V.conf,!0)}/${e[89][e[94].name]}`))&&attr(l,"href",o),L[0]&2068&&set_style(l,"display",e[89][e[94].name]&&!((Z=e[89])!=null&&Z.save_only_temp)?null:"none"),(!O||L[0]&2068&&c!==(c=`${(S=e[86])==null?void 0:S.table}-${e[94].name}-${e[88]}-${((ee=e[89])==null?void 0:ee.index)||e[93]}`))&&attr(i,"id",c),(!O||L[0]&4&&u!==(u=e[94].name))&&attr(i,"name",u),(!O||L[0]&2076&&m!==(m="grow input "+(e[89][e[94].name]&&!((te=e[89])!=null&&te.save_only_temp)?"pl-8":"")+" pr-8 --input-bordered bg-transparent w-full input-sm "+(((x=e[3])==null?void 0:x[`${e[94].name}_${e[89][(G=(N=(D=e[86])==null?void 0:D.fields)==null?void 0:N[0])==null?void 0:G.name]}`])||"")))&&attr(i,"class",m),L[0]&2068&&i.value!==e[89][e[94].name]&&set_input_value(i,e[89][e[94].name]),(!O||L[0]&8192&&g!==(g=`${e[13].t("crud.attach")} ${e[13].t("crud.file")}`))&&attr(f,"title",g),(!O||L[0]&512)&&(f.disabled=e[9]),(!O||L[0]&2068&&E!==(E=`${(y=e[86])==null?void 0:y.table}-${e[94].name}-${e[88]}-${((ne=e[89])==null?void 0:ne.index)||e[93]}-file`))&&attr(v,"id",E),(!O||L[0]&4&&T!==(T="p-0.5 "+(((le=e[94])==null?void 0:le.width)||"")))&&attr(t,"class",T)},i(k){O||(transition_in(r.$$.fragment,k),transition_in(p.$$.fragment,k),O=!0)},o(k){transition_out(r.$$.fragment,k),transition_out(p.$$.fragment,k),O=!1},d(k){k&&detach(t),destroy_component(r),destroy_component(p),C=!1,run_all(U)}}}function create_if_block_15(e){var m;let t,n,l,a,r,s,o,_,i,c;a=new Icons({props:{type:"outline",icon:(m=e[94])==null?void 0:m.icon,path:"icons"}});function u(){return e[55](e[94],e[89],e[93],e[86])}return{c(){var b,f;t=element("td"),n=element("button"),l=element("span"),create_component(a.$$.fragment),s=space(),attr(l,"class","w-5 h-5"),attr(n,"class","btn btn-circle btn-ghost btn-sm m-0 text-xs"),n.disabled=r=e[16](((b=e[94])==null?void 0:b.disabled)||"false",e[89],null,e[1])?!0:e[9],attr(t,"class","p-0.5 w-8 text-right"),attr(t,"title",o=(f=e[94])==null?void 0:f.label)},m(b,f){insert(b,t,f),append(t,n),append(n,l),mount_component(a,l,null),append(t,s),_=!0,i||(c=listen(n,"click",u),i=!0)},p(b,f){var p,g,w;e=b;const h={};f[0]&4&&(h.icon=(p=e[94])==null?void 0:p.icon),a.$set(h),(!_||f[0]&2582&&r!==(r=e[16](((g=e[94])==null?void 0:g.disabled)||"false",e[89],null,e[1])?!0:e[9]))&&(n.disabled=r),(!_||f[0]&4&&o!==(o=(w=e[94])==null?void 0:w.label))&&attr(t,"title",o)},i(b){_||(transition_in(a.$$.fragment,b),_=!0)},o(b){transition_out(a.$$.fragment,b),_=!1},d(b){b&&detach(t),destroy_component(a),i=!1,c()}}}function create_if_block_14(e){var u;let t,n,l,a,r,s,o,_=ensure_array_like(((u=e[94])==null?void 0:u.options)||[]),i=[];for(let m=0;m<_.length;m+=1)i[m]=create_each_block_4(get_each_context_4(e,_,m));function c(){e[54].call(n,e[94],e[92],e[93])}return{c(){var m,b,f;t=element("td"),n=element("select");for(let h=0;h<i.length;h+=1)i[h].c();a=space(),attr(n,"class",l="select select-sm p-0.5 "+(((m=e[94])==null?void 0:m.width)||"w-full bg-transparent")),e[89][(b=e[94])==null?void 0:b.name]===void 0&&add_render_callback(c),attr(t,"class",r="p-0.5 "+(((f=e[94])==null?void 0:f.width)||""))},m(m,b){var f;insert(m,t,b),append(t,n);for(let h=0;h<i.length;h+=1)i[h]&&i[h].m(n,null);select_option(n,e[89][(f=e[94])==null?void 0:f.name],!0),append(t,a),s||(o=listen(n,"change",c),s=!0)},p(m,b){var f,h,p,g;if(e=m,b[0]&4){_=ensure_array_like(((f=e[94])==null?void 0:f.options)||[]);let w;for(w=0;w<_.length;w+=1){const v=get_each_context_4(e,_,w);i[w]?i[w].p(v,b):(i[w]=create_each_block_4(v),i[w].c(),i[w].m(n,null))}for(;w<i.length;w+=1)i[w].d(1);i.length=_.length}b[0]&4&&l!==(l="select select-sm p-0.5 "+(((h=e[94])==null?void 0:h.width)||"w-full bg-transparent"))&&attr(n,"class",l),b[0]&2068&&select_option(n,e[89][(p=e[94])==null?void 0:p.name]),b[0]&4&&r!==(r="p-0.5 "+(((g=e[94])==null?void 0:g.width)||""))&&attr(t,"class",r)},i:noop,o:noop,d(m){m&&detach(t),destroy_each(i,m),s=!1,o()}}}function create_if_block_13(e){let t,n,l,a,r,s;function o(){e[53].call(n,e[94],e[92],e[93])}return{c(){var _;t=element("td"),n=element("input"),l=space(),attr(n,"type","checkbox"),attr(n,"class","toggle toggle-sm toggle-primary"),n.disabled=e[9],attr(t,"class",a="p-0.5 text-center align-middle "+(((_=e[94])==null?void 0:_.width)||""))},m(_,i){var c;insert(_,t,i),append(t,n),n.checked=e[89][(c=e[94])==null?void 0:c.name],append(t,l),r||(s=listen(n,"change",o),r=!0)},p(_,i){var c,u;e=_,i[0]&512&&(n.disabled=e[9]),i[0]&2068&&(n.checked=e[89][(c=e[94])==null?void 0:c.name]),i[0]&4&&a!==(a="p-0.5 text-center align-middle "+(((u=e[94])==null?void 0:u.width)||""))&&attr(t,"class",a)},i:noop,o:noop,d(_){_&&detach(t),r=!1,s()}}}function create_if_block_12(e){var c,u,m;let t,n,l=string_ellipsis((((u=e[89])==null?void 0:u[(c=e[94])==null?void 0:c.name])||"").replace(/^\w+\/|.+\//,""),((m=e[94])==null?void 0:m.ellipsis)||30)+"",a,r,s,o,_,i;return{c(){var b,f,h,p,g,w,v;t=element("td"),n=element("a"),a=text(l),o=space(),attr(n,"href",r=`${get_upload_api((b=e[12])==null?void 0:b.conf,!0)}/${e[89][e[94].name]}`),attr(n,"target","_blank"),attr(n,"class","link link-secondary"),attr(n,"title",s=e[89][(f=e[94])==null?void 0:f.tooltip]||string_ellipsis_title((e[89][(h=e[94])==null?void 0:h.name]||"").replace(/^\w+\/|.+\//,""),((p=e[94])==null?void 0:p.ellipsis)||30)),set_style(n,"display",e[89][(g=e[94])==null?void 0:g.name]?null:"none"),attr(t,"class",_="normal-case "+(((w=e[94])==null?void 0:w.width)||"")),attr(t,"style",i=((v=e[94])==null?void 0:v.style)||"")},m(b,f){insert(b,t,f),append(t,n),append(n,a),append(t,o)},p(b,f){var h,p,g,w,v,E,Y,T,O,C;f[0]&2068&&l!==(l=string_ellipsis((((p=b[89])==null?void 0:p[(h=b[94])==null?void 0:h.name])||"").replace(/^\w+\/|.+\//,""),((g=b[94])==null?void 0:g.ellipsis)||30)+"")&&set_data(a,l),f[0]&6164&&r!==(r=`${get_upload_api((w=b[12])==null?void 0:w.conf,!0)}/${b[89][b[94].name]}`)&&attr(n,"href",r),f[0]&2068&&s!==(s=b[89][(v=b[94])==null?void 0:v.tooltip]||string_ellipsis_title((b[89][(E=b[94])==null?void 0:E.name]||"").replace(/^\w+\/|.+\//,""),((Y=b[94])==null?void 0:Y.ellipsis)||30))&&attr(n,"title",s),f[0]&2068&&set_style(n,"display",b[89][(T=b[94])==null?void 0:T.name]?null:"none"),f[0]&4&&_!==(_="normal-case "+(((O=b[94])==null?void 0:O.width)||""))&&attr(t,"class",_),f[0]&4&&i!==(i=((C=b[94])==null?void 0:C.style)||"")&&attr(t,"style",i)},i:noop,o:noop,d(b){b&&detach(t)}}}function create_if_block_7(e){let t,n,l,a,r,s,o;const _=[create_if_block_8,create_if_block_9,create_if_block_11,create_else_block_3],i=[];function c(u,m){var b,f,h;return u[94].dt_frmt?0:((b=u[94])==null?void 0:b.name)==="value"&&((f=u[86])==null?void 0:f.table)==="etl_report_base_log"?1:(h=u[94])!=null&&h.check_first?2:3}return n=c(e),l=i[n]=_[n](e),{c(){var u,m;t=element("td"),l.c(),a=space(),attr(t,"class",r="normal-case "+(((u=e[94])==null?void 0:u.width)||"")),attr(t,"style",s=((m=e[94])==null?void 0:m.style)||"")},m(u,m){insert(u,t,m),i[n].m(t,null),append(t,a),o=!0},p(u,m){var f,h;let b=n;n=c(u),n===b?i[n].p(u,m):(group_outros(),transition_out(i[b],1,1,()=>{i[b]=null}),check_outros(),l=i[n],l?l.p(u,m):(l=i[n]=_[n](u),l.c()),transition_in(l,1),l.m(t,a)),(!o||m[0]&4&&r!==(r="normal-case "+(((f=u[94])==null?void 0:f.width)||"")))&&attr(t,"class",r),(!o||m[0]&4&&s!==(s=((h=u[94])==null?void 0:h.style)||""))&&attr(t,"style",s)},i(u){o||(transition_in(l),o=!0)},o(u){transition_out(l),o=!1},d(u){u&&detach(t),i[n].d()}}}function create_each_block_4(e){let t,n=e[97].label+"",l,a;return{c(){t=element("option"),l=text(n),t.__value=a=e[97].value,set_input_value(t,t.__value)},m(r,s){insert(r,t,s),append(t,l)},p(r,s){s[0]&4&&n!==(n=r[97].label+"")&&set_data(l,n),s[0]&4&&a!==(a=r[97].value)&&(t.__value=a,set_input_value(t,t.__value))},d(r){r&&detach(t)}}}function create_else_block_3(e){var r,s,o;let t,n=string_ellipsis((s=e[89])==null?void 0:s[(r=e[94])==null?void 0:r.name],((o=e[94])==null?void 0:o.ellipsis)||30)+"",l,a;return{c(){var _,i,c;t=element("span"),l=text(n),attr(t,"title",a=e[89][(_=e[94])==null?void 0:_.tooltip]||string_ellipsis_title(e[89][(i=e[94])==null?void 0:i.name],((c=e[94])==null?void 0:c.ellipsis)||30))},m(_,i){insert(_,t,i),append(t,l)},p(_,i){var c,u,m,b,f,h;i[0]&2068&&n!==(n=string_ellipsis((u=_[89])==null?void 0:u[(c=_[94])==null?void 0:c.name],((m=_[94])==null?void 0:m.ellipsis)||30)+"")&&set_data(l,n),i[0]&2068&&a!==(a=_[89][(b=_[94])==null?void 0:b.tooltip]||string_ellipsis_title(_[89][(f=_[94])==null?void 0:f.name],((h=_[94])==null?void 0:h.ellipsis)||30))&&attr(t,"title",a)},i:noop,o:noop,d(_){_&&detach(t)}}}function create_if_block_11(e){var r;let t,n=string_ellipsis(e[29]({d:e[89],field:e[94]}),((r=e[94])==null?void 0:r.ellipsis)||30)+"",l,a;return{c(){var s,o;t=element("span"),l=text(n),attr(t,"title",a=e[89][(s=e[94])==null?void 0:s.tooltip]||string_ellipsis_title(e[29]({d:e[89],field:e[94]}),((o=e[94])==null?void 0:o.ellipsis)||30))},m(s,o){insert(s,t,o),append(t,l)},p(s,o){var _,i,c;o[0]&2068&&n!==(n=string_ellipsis(s[29]({d:s[89],field:s[94]}),((_=s[94])==null?void 0:_.ellipsis)||30)+"")&&set_data(l,n),o[0]&2068&&a!==(a=s[89][(i=s[94])==null?void 0:i.tooltip]||string_ellipsis_title(s[29]({d:s[89],field:s[94]}),((c=s[94])==null?void 0:c.ellipsis)||30))&&attr(t,"title",a)},i:noop,o:noop,d(s){s&&detach(t)}}}function create_if_block_9(e){let t,n,l,a,r,s,o,_,i;l=new Icons({props:{type:"outline",icon:"eye",path:"icons"}});function c(){return e[52](e[89],e[92],e[93])}function u(f,h){var p,g;return h[0]&2068&&(r=null),r==null&&(r=!!(((g=(p=f[89])==null?void 0:p.type)==null?void 0:g.toLowerCase())==="export"&&f[29]({d:f[89],field:f[94]}))),r?create_if_block_10:create_else_block_2}let m=u(e,[-1,-1,-1,-1]),b=m(e);return{c(){var f;t=element("button"),n=element("span"),create_component(l.$$.fragment),a=space(),b.c(),s=empty(),attr(n,"class","w-5"),attr(t,"class","btn btn-circle btn-ghost btn-sm m-0 text-xs"),t.disabled=e[9],set_style(t,"display",(f=e[89])!=null&&f.html?null:"none")},m(f,h){insert(f,t,h),append(t,n),mount_component(l,n,null),insert(f,a,h),b.m(f,h),insert(f,s,h),o=!0,_||(i=listen(t,"click",c),_=!0)},p(f,h){var p;e=f,(!o||h[0]&512)&&(t.disabled=e[9]),h[0]&2068&&set_style(t,"display",(p=e[89])!=null&&p.html?null:"none"),m===(m=u(e,h))&&b?b.p(e,h):(b.d(1),b=m(e),b&&(b.c(),b.m(s.parentNode,s)))},i(f){o||(transition_in(l.$$.fragment,f),o=!0)},o(f){transition_out(l.$$.fragment,f),o=!1},d(f){f&&(detach(t),detach(a),detach(s)),destroy_component(l),b.d(f),_=!1,i()}}}function create_if_block_8(e){var l,a;let t=hooks((a=e[89])==null?void 0:a[(l=e[94])==null?void 0:l.name]).format(e[94].dt_frmt)+"",n;return{c(){n=text(t)},m(r,s){insert(r,n,s)},p(r,s){var o,_;s[0]&2068&&t!==(t=hooks((_=r[89])==null?void 0:_[(o=r[94])==null?void 0:o.name]).format(r[94].dt_frmt)+"")&&set_data(n,t)},i:noop,o:noop,d(r){r&&detach(n)}}}function create_else_block_2(e){var r;let t,n=string_ellipsis(e[29]({d:e[89],field:e[94]}),((r=e[94])==null?void 0:r.ellipsis)||30)+"",l,a;return{c(){var s,o;t=element("span"),l=text(n),attr(t,"title",a=e[89][(s=e[94])==null?void 0:s.tooltip]||string_ellipsis_title(e[29]({d:e[89],field:e[94]}),((o=e[94])==null?void 0:o.ellipsis)||30))},m(s,o){insert(s,t,o),append(t,l)},p(s,o){var _,i,c;o[0]&2068&&n!==(n=string_ellipsis(s[29]({d:s[89],field:s[94]}),((_=s[94])==null?void 0:_.ellipsis)||30)+"")&&set_data(l,n),o[0]&2068&&a!==(a=s[89][(i=s[94])==null?void 0:i.tooltip]||string_ellipsis_title(s[29]({d:s[89],field:s[94]}),((c=s[94])==null?void 0:c.ellipsis)||30))&&attr(t,"title",a)},d(s){s&&detach(t)}}}function create_if_block_10(e){var s;let t,n=string_ellipsis((e[29]({d:e[89],field:e[94]})||"").replace(/^\w+\/|.+\//,""),((s=e[94])==null?void 0:s.ellipsis)||30)+"",l,a,r;return{c(){var o,_,i;t=element("a"),l=text(n),attr(t,"href",a=`${get_upload_api((o=e[12])==null?void 0:o.conf,!0)}/${e[29]({d:e[89],field:e[94]})}`),attr(t,"target","_blank"),attr(t,"class","link link-secondary"),attr(t,"title",r=e[89][(_=e[94])==null?void 0:_.tooltip]||string_ellipsis_title((e[29]({d:e[89],field:e[94]})||"").replace(/^\w+\/|.+\//,""),((i=e[94])==null?void 0:i.ellipsis)||30)),set_style(t,"display",e[29]({d:e[89],field:e[94]})?null:"none")},m(o,_){insert(o,t,_),append(t,l)},p(o,_){var i,c,u,m;_[0]&2068&&n!==(n=string_ellipsis((o[29]({d:o[89],field:o[94]})||"").replace(/^\w+\/|.+\//,""),((i=o[94])==null?void 0:i.ellipsis)||30)+"")&&set_data(l,n),_[0]&6164&&a!==(a=`${get_upload_api((c=o[12])==null?void 0:c.conf,!0)}/${o[29]({d:o[89],field:o[94]})}`)&&attr(t,"href",a),_[0]&2068&&r!==(r=o[89][(u=o[94])==null?void 0:u.tooltip]||string_ellipsis_title((o[29]({d:o[89],field:o[94]})||"").replace(/^\w+\/|.+\//,""),((m=o[94])==null?void 0:m.ellipsis)||30))&&attr(t,"title",r),_[0]&2068&&set_style(t,"display",o[29]({d:o[89],field:o[94]})?null:"none")},d(o){o&&detach(t)}}}function create_each_block_3(e){let t,n,l,a;const r=[create_if_block_7,create_if_block_12,create_if_block_13,create_if_block_14,create_if_block_15,create_if_block_16,create_if_block_17,create_else_block_4],s=[];function o(_,i){var c,u,m,b,f,h,p;return((c=_[94])==null?void 0:c.type)==="data"?0:((u=_[94])==null?void 0:u.type)==="link"?1:((m=_[94])==null?void 0:m.type)==="boolean"?2:((b=_[94])==null?void 0:b.type)==="select"?3:((f=_[94])==null?void 0:f.type)==="button"?4:((h=_[94])==null?void 0:h.type)==="file"?5:((p=_[94])==null?void 0:p.type)==="date"?6:7}return t=o(e),n=s[t]=r[t](e),{c(){n.c(),l=empty()},m(_,i){s[t].m(_,i),insert(_,l,i),a=!0},p(_,i){let c=t;t=o(_),t===c?s[t].p(_,i):(group_outros(),transition_out(s[c],1,1,()=>{s[c]=null}),check_outros(),n=s[t],n?n.p(_,i):(n=s[t]=r[t](_),n.c()),transition_in(n,1),n.m(l.parentNode,l))},i(_){a||(transition_in(n),a=!0)},o(_){transition_out(n),a=!1},d(_){_&&detach(l),s[t].d(_)}}}function create_each_block_2(e){let t,n,l,a,r;const s=[create_if_block_6,create_else_block_1],o=[];function _(i,c){var u;return i[89].show_html&&((u=i[89])!=null&&u.html)?0:1}return n=_(e),l=o[n]=s[n](e),{c(){t=element("tr"),l.c(),a=space(),attr(t,"class","hover"),set_style(t,"display",e[89].excluded?"None":null)},m(i,c){insert(i,t,c),o[n].m(t,null),append(t,a),r=!0},p(i,c){let u=n;n=_(i),n===u?o[n].p(i,c):(group_outros(),transition_out(o[u],1,1,()=>{o[u]=null}),check_outros(),l=o[n],l?l.p(i,c):(l=o[n]=s[n](i),l.c()),transition_in(l,1),l.m(t,a)),c[0]&2068&&set_style(t,"display",i[89].excluded?"None":null)},i(i){r||(transition_in(l),r=!0)},o(i){transition_out(l),r=!1},d(i){i&&detach(t),o[n].d()}}}function create_if_block_5(e){var E,Y,T,O,C,U,K,W,P;let t,n,l,a,r,s=string_ellipsis(`${(O=e[89])==null?void 0:O[(T=(Y=(E=e[86])==null?void 0:E.fields)==null?void 0:Y[0])==null?void 0:T.name]} - ${(W=e[89])==null?void 0:W[(K=(U=(C=e[86])==null?void 0:C.fields)==null?void 0:U[1])==null?void 0:K.name]}`,60)+"",o,_,i,c,u,m,b,f=(((P=e[89])==null?void 0:P.html)||" ")+"",h,p,g,w;u=new Icons({props:{type:"outline",icon:"arrow-uturn-left",path:"icons"}});function v(){return e[34](e[86])}return{c(){t=element("div"),n=element("input"),l=space(),a=element("div"),r=element("div"),o=text(s),_=space(),i=element("button"),c=element("span"),create_component(u.$$.fragment),m=space(),b=element("div"),h=space(),attr(n,"type","radio"),attr(n,"name","my-accordion-2"),n.checked="checked",attr(r,"class","flex-grow"),attr(c,"class","w-6"),attr(i,"class","btn btn-circle btn-ghost btn-sm text-xs z-[1]"),attr(a,"class","collapse-title text-md font-medium flex row"),attr(b,"class","collapse-content"),attr(t,"class","collapse collapse-arrow bg-base-200")},m(J,R){insert(J,t,R),append(t,n),append(t,l),append(t,a),append(a,r),append(r,o),append(a,_),append(a,i),append(i,c),mount_component(u,c,null),append(t,m),append(t,b),b.innerHTML=f,append(t,h),p=!0,g||(w=listen(i,"click",v),g=!0)},p(J,R){var A,M,H,z,k,L,V,Z,S;e=J,(!p||R[0]&2068)&&s!==(s=string_ellipsis(`${(z=e[89])==null?void 0:z[(H=(M=(A=e[86])==null?void 0:A.fields)==null?void 0:M[0])==null?void 0:H.name]} - ${(Z=e[89])==null?void 0:Z[(V=(L=(k=e[86])==null?void 0:k.fields)==null?void 0:L[1])==null?void 0:V.name]}`,60)+"")&&set_data(o,s),(!p||R[0]&2068)&&f!==(f=(((S=e[89])==null?void 0:S.html)||" ")+"")&&(b.innerHTML=f)},i(J){p||(transition_in(u.$$.fragment,J),p=!0)},o(J){transition_out(u.$$.fragment,J),p=!1},d(J){J&&detach(t),destroy_component(u),g=!1,w()}}}function create_each_block_1(e){var a;let t,n,l=((a=e[89])==null?void 0:a.html)&&create_if_block_5(e);return{c(){l&&l.c(),t=empty()},m(r,s){l&&l.m(r,s),insert(r,t,s),n=!0},p(r,s){var o;(o=r[89])!=null&&o.html?l?(l.p(r,s),s[0]&2068&&transition_in(l,1)):(l=create_if_block_5(r),l.c(),transition_in(l,1),l.m(t.parentNode,t)):l&&(group_outros(),transition_out(l,1,1,()=>{l=null}),check_outros())},i(r){n||(transition_in(l),n=!0)},o(r){transition_out(l),n=!1},d(r){r&&detach(t),l&&l.d(r)}}}function create_each_block(e){var r;let t=e[5]===e[88]&&e[16](((r=e[86])==null?void 0:r.show)||"true",e[86],null,e[1]),n,l,a=t&&create_if_block_3(e);return{c(){a&&a.c(),n=empty()},m(s,o){a&&a.m(s,o),insert(s,n,o),l=!0},p(s,o){var _;o[0]&38&&(t=s[5]===s[88]&&s[16](((_=s[86])==null?void 0:_.show)||"true",s[86],null,s[1])),t?a?(a.p(s,o),o[0]&38&&transition_in(a,1)):(a=create_if_block_3(s),a.c(),transition_in(a,1),a.m(n.parentNode,n)):a&&(group_outros(),transition_out(a,1,1,()=>{a=null}),check_outros())},i(s){l||(transition_in(a),l=!0)},o(s){transition_out(a),l=!1},d(s){s&&detach(n),a&&a.d(s)}}}function create_if_block_2(e){let t,n;return t=new Loadingv2({props:{open:e[8]}}),{c(){create_component(t.$$.fragment)},m(l,a){mount_component(t,l,a),n=!0},p(l,a){const r={};a[0]&256&&(r.open=l[8]),t.$set(r)},i(l){n||(transition_in(t.$$.fragment,l),n=!0)},o(l){transition_out(t.$$.fragment,l),n=!1},d(l){destroy_component(t,l)}}}function create_if_block_1(e){let t,n;return t=new Toast({props:{open:e[6].open,type:e[6].type,msg:e[6].msg,timer:2e4}}),t.$on("dismiss",e[68]),{c(){create_component(t.$$.fragment)},m(l,a){mount_component(t,l,a),n=!0},p(l,a){const r={};a[0]&64&&(r.open=l[6].open),a[0]&64&&(r.type=l[6].type),a[0]&64&&(r.msg=l[6].msg),t.$set(r)},i(l){n||(transition_in(t.$$.fragment,l),n=!0)},o(l){transition_out(t.$$.fragment,l),n=!1},d(l){destroy_component(t,l)}}}function create_if_block(e){let t,n;const l=[e[7]];let a={};for(let r=0;r<l.length;r+=1)a=assign(a,l[r]);return t=new Modal({props:a}),t.$on("dismiss",e[69]),{c(){create_component(t.$$.fragment)},m(r,s){mount_component(t,r,s),n=!0},p(r,s){const o=s[0]&128?get_spread_update(l,[get_spread_object(r[7])]):{};t.$set(o)},i(r){n||(transition_in(t.$$.fragment,r),n=!0)},o(r){transition_out(t.$$.fragment,r),n=!1},d(r){destroy_component(t,r)}}}function create_fragment(e){var V,Z,S,ee,te;let t,n,l,a,r,s,o,_=((V=e[10])==null?void 0:V.type)+"",i,c,u=((Z=e[10])==null?void 0:Z.name)+"",m,b,f,h=hooks((S=e[10])==null?void 0:S.ref).format(e[13].t("fmrt.date"))+"",p,g,w=hooks((ee=e[10])==null?void 0:ee.start).format(e[13].t("fmrt.datetime"))+"",v,E,Y=((te=e[10])==null?void 0:te.timer)+"",T,O,C,U,K,W,P,J=ensure_array_like(e[2]),R=[];for(let D=0;D<J.length;D+=1)R[D]=create_each_block_7(get_each_context_7(e,J,D));let A=ensure_array_like(e[2]),M=[];for(let D=0;D<A.length;D+=1)M[D]=create_each_block(get_each_context(e,A,D));const H=D=>transition_out(M[D],1,1,()=>{M[D]=null});let z=e[8]&&create_if_block_2(e),k=e[6].open&&create_if_block_1(e),L=e[7].open&&create_if_block(e);return{c(){t=element("div"),n=element("ul");for(let D=0;D<R.length;D+=1)R[D].c();l=space();for(let D=0;D<M.length;D+=1)M[D].c();a=space(),r=element("div"),s=element("i"),o=element("b"),i=text(_),c=text("/"),m=text(u),b=text(":"),f=space(),p=text(h),g=text(" -> "),v=text(w),E=text(" -> "),T=text(Y),O=space(),z&&z.c(),C=space(),k&&k.c(),U=space(),L&&L.c(),K=space(),W=element("div"),attr(n,"class","steps w-full p-2"),attr(r,"class","pl-2 pr-2 -pt-8"),set_style(r,"font-family","'Courier New', Courier, monospace"),set_style(r,"display",e[9]?null:"none"),attr(t,"class","--flex --flex-col"),attr(W,"class","input-primary input-lg"),set_style(W,"display","none")},m(D,N){insert(D,t,N),append(t,n);for(let G=0;G<R.length;G+=1)R[G]&&R[G].m(n,null);append(t,l);for(let G=0;G<M.length;G+=1)M[G]&&M[G].m(t,null);append(t,a),append(t,r),append(r,s),append(s,o),append(o,i),append(o,c),append(o,m),append(o,b),append(s,f),append(s,p),append(s,g),append(s,v),append(s,E),append(s,T),insert(D,O,N),z&&z.m(D,N),insert(D,C,N),k&&k.m(D,N),insert(D,U,N),L&&L.m(D,N),insert(D,K,N),insert(D,W,N),P=!0},p(D,N){var G,x,y,ne,le;if(N[0]&65574){J=ensure_array_like(D[2]);let B;for(B=0;B<J.length;B+=1){const ae=get_each_context_7(D,J,B);R[B]?R[B].p(ae,N):(R[B]=create_each_block_7(ae),R[B].c(),R[B].m(n,null))}for(;B<R.length;B+=1)R[B].d(1);R.length=J.length}if(N[0]&1072691775){A=ensure_array_like(D[2]);let B;for(B=0;B<A.length;B+=1){const ae=get_each_context(D,A,B);M[B]?(M[B].p(ae,N),transition_in(M[B],1)):(M[B]=create_each_block(ae),M[B].c(),transition_in(M[B],1),M[B].m(t,a))}for(group_outros(),B=A.length;B<M.length;B+=1)H(B);check_outros()}(!P||N[0]&1024)&&_!==(_=((G=D[10])==null?void 0:G.type)+"")&&set_data(i,_),(!P||N[0]&1024)&&u!==(u=((x=D[10])==null?void 0:x.name)+"")&&set_data(m,u),(!P||N[0]&9216)&&h!==(h=hooks((y=D[10])==null?void 0:y.ref).format(D[13].t("fmrt.date"))+"")&&set_data(p,h),(!P||N[0]&9216)&&w!==(w=hooks((ne=D[10])==null?void 0:ne.start).format(D[13].t("fmrt.datetime"))+"")&&set_data(v,w),(!P||N[0]&1024)&&Y!==(Y=((le=D[10])==null?void 0:le.timer)+"")&&set_data(T,Y),N[0]&512&&set_style(r,"display",D[9]?null:"none"),D[8]?z?(z.p(D,N),N[0]&256&&transition_in(z,1)):(z=create_if_block_2(D),z.c(),transition_in(z,1),z.m(C.parentNode,C)):z&&(group_outros(),transition_out(z,1,1,()=>{z=null}),check_outros()),D[6].open?k?(k.p(D,N),N[0]&64&&transition_in(k,1)):(k=create_if_block_1(D),k.c(),transition_in(k,1),k.m(U.parentNode,U)):k&&(group_outros(),transition_out(k,1,1,()=>{k=null}),check_outros()),D[7].open?L?(L.p(D,N),N[0]&128&&transition_in(L,1)):(L=create_if_block(D),L.c(),transition_in(L,1),L.m(K.parentNode,K)):L&&(group_outros(),transition_out(L,1,1,()=>{L=null}),check_outros())},i(D){if(!P){for(let N=0;N<A.length;N+=1)transition_in(M[N]);transition_in(z),transition_in(k),transition_in(L),P=!0}},o(D){M=M.filter(Boolean);for(let N=0;N<M.length;N+=1)transition_out(M[N]);transition_out(z),transition_out(k),transition_out(L),P=!1},d(D){D&&(detach(t),detach(O),detach(C),detach(U),detach(K),detach(W)),destroy_each(R,D),destroy_each(M,D),z&&z.d(D),k&&k.d(D),L&&L.d(D)}}}function instance($$self,$$props,$$invalidate){let $_global,$i18n;component_subscribe($$self,_global,e=>$$invalidate(12,$_global=e)),component_subscribe($$self,i18n,e=>$$invalidate(13,$i18n=e));let{table}=$$props,{data}=$$props,{option={}}=$$props,{action={}}=$$props,selected_etlrb={};const tables=["etl_report_base","etl_rbase_input","etl_rbase_output","etl_rbase_quality","etl_rb_reconcilia","etl_rb_reconc_dtail","etl_rbase_export","etl_report_base_log","etl_rbase_notify","etl_rbase_backup","etl_rbase_script"];let steps=[{table:"etl_rbase_input",label:`${$i18n.t("crud.extract")} | ${$i18n.t("crud.input")}`,date_ref:hooks().subtract(1,"days").format("YYYY-MM-DD"),run_all_action:"extract",fields:[{name:"etl_rbase_input",type:"data",tooltip:"etl_rbase_input_desc",ellipsis:30},{name:"destination_table",type:"data",label:`${$i18n.t("table")}`,ellipsis:30},{name:"date_ref",label:`${$i18n.t("date")}`,type:"date",input:!0},{name:"file",label:`${$i18n.t("crud.file")}`,type:"file",input:!0},{name:"num_rows",label:`${$i18n.t("crud.n_rows")}`,type:"data",input:!0,style:"text-align: right"},{name:"ignore",label:`${$i18n.t("crud.ignore")}`,type:"boolean",input:!0},{name:"btn_extract",label:`${$i18n.t("crud.extract")}`,type:"button",input:!0,action:"extract",icon:"play",width:"w-10",disabled:"!d?.active || !d?.allow_import || (!d?.file && !d?.etl_rbase_input_conf)"},{name:"btn_nrows",label:`${$i18n.t("crud.n_rows")}`,type:"button",input:!0,action:"n_rows",icon:"check",width:"w-10"},{name:"btn_delete",label:`${$i18n.t("crud.delete")}`,type:"button",input:!0,action:"delete",icon:"trash",width:"w-10"},{name:"btn_edit",label:`${$i18n.t("crud.edit")}`,type:"button",input:!0,action:"edit",icon:"pencil",width:"w-10"},{name:"btn_copy",label:`${$i18n.t("crud.clone")}`,type:"button",input:!0,action:"copy",icon:"duplicate",width:"w-10"},{name:"btn_explore",label:`${$i18n.t("crud.explore_db")}`,type:"button",input:!0,action:"explore_db",icon:"table-cells",width:"w-10"},{name:"btn_edit_cnf",label:`${$i18n.t("crud.edit_cnf")}`,type:"button",input:!0,action:"edit_cnf",icon:"cog-8-tooth",width:"w-10",conf_field:"etl_rbase_input_conf",disabled:"!d?.active || !d?.etl_rbase_input_conf"}]},{table:"etl_rbase_output",detail_table:"etl_rb_output_field",label:`${$i18n.t("crud.transform")} | ${$i18n.t("crud.output")}`,show:"selected_etlrb?.includes_output",dates_refs:[hooks().subtract(1,"days").format("YYYY-MM-DD")],run_all_action:"transform",fields:[{name:"etl_rbase_output",type:"data",tooltip:"etl_rbase_output_desc",ellipsis:30},{name:"etl_rbase_output_desc",type:"data",ellipsis:40},{name:"destination_table",type:"data",label:`${$i18n.t("table")}`,ellipsis:30},{name:"num_rows",label:`${$i18n.t("crud.n_rows")}`,type:"data",input:!0,style:"text-align: right"},{name:"ignore",label:`${$i18n.t("crud.ignore")}`,type:"boolean",input:!0},{name:"btn_transform",label:`${$i18n.t("crud.transform")}`,type:"button",input:!0,action:"transform",icon:"play",width:"w-10",disabled:"!d?.active"},{name:"btn_nrows",label:`${$i18n.t("crud.n_rows")}`,type:"button",input:!0,action:"n_rows",icon:"check",width:"w-10"},{name:"btn_details",label:`${$i18n.t("crud.details")}`,type:"button",input:!0,action:"details",icon:"ellipsis-vertical",width:"w-10"},{name:"btn_delete",label:`${$i18n.t("crud.delete")}`,type:"button",input:!0,action:"delete",icon:"trash",width:"w-10"},{name:"btn_edit",label:`${$i18n.t("crud.edit")}`,type:"button",input:!0,action:"edit",icon:"pencil",width:"w-10"},{name:"btn_copy",label:`${$i18n.t("crud.clone")}`,type:"button",input:!0,action:"copy",icon:"duplicate",width:"w-10"},{name:"btn_explore",label:`${$i18n.t("crud.explore_db")}`,type:"button",input:!0,action:"explore_db",icon:"table-cells",width:"w-10"}]},{table:"etl_rbase_quality",label:`${$i18n.t("crud.data_quality")}`,show:"selected_etlrb?.includes_data_quality",dates_refs:[hooks().subtract(1,"days").format("YYYY-MM-DD")],run_all_action:"data_quality",pre_filters:["num_erros_check:\\d{1,}","num_erros_fix:\\d{1,}"],fields:[{name:"etl_rbase_quality",type:"data",tooltip:"etl_rbase_output_desc",ellipsis:30},{name:"etl_rbase_quality_desc",type:"data",ellipsis:40},{name:"num_erros_check",label:`${$i18n.t("crud.num_erros_check")}`,type:"data",input:!0,style:"text-align: right"},{name:"num_erros_fix",label:`${$i18n.t("crud.num_erros_fix")}`,type:"data",input:!0,style:"text-align: right"},{name:"ignore",label:`${$i18n.t("crud.ignore")}`,type:"boolean",input:!0},{name:"btn_check",label:`${$i18n.t("crud.check")}`,type:"button",input:!0,action:"data_quality_check",icon:"check",width:"w-10",disabled:"!d?.active || !d?.sql_quality_check"},{name:"btn_fix",label:`${$i18n.t("crud.fix")}`,type:"button",input:!0,action:"data_quality_fix",icon:"play",width:"w-10",disabled:"!d?.active || !(d?.num_erros_check || d?.num_erros_check > 0) || !d?.sql_quality_fix"},{name:"btn_details",label:`${$i18n.t("crud.details")}`,type:"button",input:!0,action:"err_details",icon:"ellipsis-vertical",width:"w-10",disabled:"!(d?.num_erros_check || d?.num_erros_check > 0)"},{name:"btn_edit",label:`${$i18n.t("crud.edit")}`,type:"button",input:!0,action:"edit",icon:"pencil",width:"w-10"},{name:"btn_copy",label:`${$i18n.t("crud.clone")}`,type:"button",input:!0,action:"copy",icon:"duplicate",width:"w-10"}]},{table:"etl_rb_reconcilia",detail_table:"etl_rb_reconc_dtail",label:`${$i18n.t("crud.reconciliation")}`,show:"selected_etlrb?.includes_data_reconci",dates_refs:[hooks().subtract(1,"days").format("YYYY-MM-DD")],run_all_action:"data_reconcilia",fields:[{name:"etl_rb_reconcilia",type:"data",tooltip:"etl_rbase_output_desc",ellipsis:30},{name:"etl_rb_reconcilia_desc",type:"data",ellipsis:80},{name:"ignore",label:`${$i18n.t("crud.ignore")}`,type:"boolean",input:!0},{name:"btn_check",label:`${$i18n.t("crud.execute")}`,type:"button",input:!0,action:"data_reconcilia",icon:"play",width:"w-10",disabled:"!d?.active"},{name:"btn_preview",label:`${$i18n.t("crud.preview")}`,type:"button",input:!0,action:"data_reconcilia_preview",icon:"eye",width:"w-10",disabled:"!d?.active || !d.html"},{name:"btn_details",label:`${$i18n.t("crud.details")}`,type:"button",input:!0,action:"details",icon:"ellipsis-vertical",width:"w-10"},{name:"btn_edit",label:`${$i18n.t("crud.edit")}`,type:"button",input:!0,action:"edit",icon:"pencil",width:"w-10"},{name:"btn_copy",label:`${$i18n.t("crud.clone")}`,type:"button",input:!0,action:"copy",icon:"duplicate",width:"w-10"}]},{table:"etl_rbase_export",detail_table:"etl_rb_exp_dtail",label:`${$i18n.t("crud.export")} | ${$i18n.t("crud.template")}`,show:"selected_etlrb?.includes_exports",dates_refs:[hooks().subtract(1,"days").format("YYYY-MM-DD")],run_all_action:"export",fields:[{name:"etl_rbase_export",type:"data",tooltip:"etl_rbase_export_desc",ellipsis:30},{name:"etl_rbase_export_desc",type:"data",ellipsis:40},{name:"attach_file_template",type:"link",ellipsis:30},{name:"file",label:`${$i18n.t("crud.file")}`,type:"link",input:!0,ellipsis:30},{name:"ignore",label:`${$i18n.t("crud.ignore")}`,type:"boolean",input:!0},{name:"btn_check",label:`${$i18n.t("crud.execute")}`,type:"button",input:!0,action:"export",icon:"play",width:"w-10",disabled:"!d?.active"},{name:"btn_details",label:`${$i18n.t("crud.details")}`,type:"button",input:!0,action:"details",icon:"ellipsis-vertical",width:"w-10"},{name:"btn_edit",label:`${$i18n.t("crud.edit")}`,type:"button",input:!0,action:"edit",icon:"pencil",width:"w-10"},{name:"btn_copy",label:`${$i18n.t("crud.clone")}`,type:"button",input:!0,action:"copy",icon:"duplicate",width:"w-10"}]},{table:"etl_rbase_backup",label:`${$i18n.t("crud.backup")}`,show:"selected_etlrb?.includes_backup",dates_refs:[hooks().subtract(1,"days").format("YYYY-MM-DD")],run_all_action:"backup",fields:[{name:"backup",type:"data",ellipsis:30},{name:"backup_sql",type:"data",ellipsis:40},{name:"backup_copy_to",type:"data",ellipsis:30},{name:"backup_copy_path",type:"data",ellipsis:30},{name:"ignore",label:`${$i18n.t("crud.ignore")}`,type:"boolean",input:!0},{name:"btn_backup",label:`${$i18n.t("crud.execute")}`,type:"button",input:!0,action:"backup",icon:"play",width:"w-10",disabled:"!d?.active"},{name:"btn_edit",label:`${$i18n.t("crud.edit")}`,type:"button",input:!0,action:"edit",icon:"pencil",width:"w-10"},{name:"btn_copy",label:`${$i18n.t("crud.clone")}`,type:"button",input:!0,action:"copy",icon:"duplicate",width:"w-10"}]},{table:"etl_rbase_script",label:`${$i18n.t("crud.script")}`,show:"selected_etlrb?.includes_script",dates_refs:[hooks().subtract(1,"days").format("YYYY-MM-DD")],run_all_action:"script",fields:[{name:"script",type:"data",ellipsis:30},{name:"script_sql",type:"data",ellipsis:90},{name:"ignore",label:`${$i18n.t("crud.ignore")}`,type:"boolean",input:!0},{name:"btn_script",label:`${$i18n.t("crud.execute")}`,type:"button",input:!0,action:"script",icon:"play",width:"w-10",disabled:"!d?.active"},{name:"btn_edit",label:`${$i18n.t("crud.edit")}`,type:"button",input:!0,action:"edit",icon:"pencil",width:"w-10"},{name:"btn_copy",label:`${$i18n.t("crud.clone")}`,type:"button",input:!0,action:"copy",icon:"duplicate",width:"w-10"}]},{table:"etl_report_base_log",label:`${$i18n.t("crud.log")}`,order_by_field:"start",pre_filters:["success:true","name:extract|input","name:transform|output","name:reconcilia","name:load|export","name:quality"],fields:[{name:"type",type:"data"},{name:"name",type:"data",ellipsis:30},{name:"ref",type:"data",dt_frmt:`${$i18n.t("fmrt.date")}`,style:"text-align: right"},{name:"start",type:"data",dt_frmt:`${$i18n.t("fmrt.datetime")}`,style:"text-align: right"},{name:"timer",type:"data",style:"text-align: right"},{name:"end",type:"data",dt_frmt:`${$i18n.t("fmrt.datetime")}`,style:"text-align: right"},{name:"success",type:"data"},{name:"msg",type:"data",ellipsis:30},{name:"value",type:"data",ellipsis:30,check_first:["n_rows","num_rows","fname","file","filename","errors","fixes","html"]}]},{table:"etl_rbase_notify",label:`${$i18n.t("crud.alert")} | ${$i18n.t("crud.notify")}`,show:"selected_etlrb?.includes_notify",dates_refs:[hooks().subtract(1,"days").format("YYYY-MM-DD")],run_all_action:"notify",fields:[{name:"notify_subject",type:"data",ellipsis:30},{name:"notify_body",type:"data",ellipsis:40},{name:"notify_to",type:"data",ellipsis:30},{name:"notify_cc",type:"data",ellipsis:30},{name:"ignore",label:`${$i18n.t("crud.ignore")}`,type:"boolean",input:!0},{name:"btn_notify",label:`${$i18n.t("crud.execute")}`,type:"button",input:!0,action:"notify",icon:"play",width:"w-10",disabled:"!d?.active"},{name:"btn_edit",label:`${$i18n.t("crud.edit")}`,type:"button",input:!0,action:"edit",icon:"pencil",width:"w-10"},{name:"btn_copy",label:`${$i18n.t("crud.clone")}`,type:"button",input:!0,action:"copy",icon:"duplicate",width:"w-10"}]}],field_order={};const drag_start_class={};let db_data={},tab=0,toast={open:!1,msg:null,type:null},modal_data={open:!1,width:12,heigth:85,header:!0,title:"Dialog Title",header_actions:[],component:null},loading=!1,loading_level2=!1,log={};const save=async e=>{var r,s,o,_,i,c,u,m;let t=((r=db_data==null?void 0:db_data[e.table])==null?void 0:r.data)||[];const n=lodashExports.cloneDeep(e.data||t);if(Array.isArray(n))n.forEach((b,f)=>{var h,p,g,w,v,E,Y;for(const T in(p=(h=$_global==null?void 0:$_global.tables)==null?void 0:h[e==null?void 0:e.table])==null?void 0:p.fields)if(Object.hasOwnProperty.call((w=(g=$_global==null?void 0:$_global.tables)==null?void 0:g[e==null?void 0:e.table])==null?void 0:w.fields,T)){const O=(E=(v=$_global==null?void 0:$_global.tables)==null?void 0:v[e==null?void 0:e.table])==null?void 0:E.fields[T];if(b!=null&&b[O.name]&&["date","datetime","time","timestamp"].includes((Y=O==null?void 0:O.type)==null?void 0:Y.toLowerCase())){const C=b[O.name];n[f][O.name]=hooks(b[O.name]).format(),console.log(O.name,C,n[f][O.name])}}});else if(typeof n=="object"){for(const b in(o=(s=$_global==null?void 0:$_global.tables)==null?void 0:s[e==null?void 0:e.table])==null?void 0:o.fields)if(Object.hasOwnProperty.call((i=(_=$_global==null?void 0:$_global.tables)==null?void 0:_[e==null?void 0:e.table])==null?void 0:i.fields,b)){const f=(u=(c=$_global==null?void 0:$_global.tables)==null?void 0:c[e==null?void 0:e.table])==null?void 0:u.fields[b];n!=null&&n[f.name]&&["date","datetime","time","timestamp"].includes((m=f==null?void 0:f.type)==null?void 0:m.toLowerCase())&&(_aux=n[f.name],n[f.name]=hooks(n[b.name]).format(),console.log(f.name,_aux,n[f.name]))}}console.log({_data:n}),$$invalidate(8,loading=!0);const l={lang:$_global==null?void 0:$_global.lang,conf:$_global==null?void 0:$_global.conf,token:$_global==null?void 0:$_global.token,app:$_global==null?void 0:$_global.selected_app,table:e.table,data:n};if(!l.data||!l.table)return $$invalidate(8,loading=!1),null;const a=await create_update(l);a.success===!0?($$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="success",toast),$$invalidate(6,toast.msg=a.msg,toast),e!=null&&e.do_not_reload?console.log(a):get_data({})):($$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="error",toast),$$invalidate(6,toast.msg=a.msg,toast)),$$invalidate(8,loading=!1)},get_data=async e=>{var l,a,r,s,o,_;e.no_loding||$$invalidate(8,loading=!0);const t={lang:$_global==null?void 0:$_global.lang,conf:$_global==null?void 0:$_global.conf,token:$_global==null?void 0:$_global.token,app:$_global==null?void 0:$_global.selected_app,table:tables,filters:[{field:"etl_report_base_id",cond:"=",value:(e==null?void 0:e.etl_report_base_id)||(selected_etlrb==null?void 0:selected_etlrb.etl_report_base_id)},{field:"ref",cond:"LIKE",value:hooks((l=steps[0])==null?void 0:l.date_ref).format("YYYY-MM-DD")}],ignore_filter:{etl_report_base:["etl_report_base_id","database"]},limit:-1},n=await read(t);if(console.log("data:",n),n.success===!0&&n.data){(s=(r=(a=n.data)==null?void 0:a[tables[1]])==null?void 0:r.data)==null||s.forEach(i=>{var c;i.date_ref=(c=steps==null?void 0:steps[0])==null?void 0:c.date_ref}),$$invalidate(2,steps[3].show_html=!1,steps);for(const i in n.data)Object.hasOwnProperty.call(n.data,i)&&((_=(o=n.data[i])==null?void 0:o.data)==null||_.map((c,u)=>(c.index=u,c)));$$invalidate(4,db_data={...n.data})}else $$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="error",toast),$$invalidate(6,toast.msg=n.msg,toast);$$invalidate(8,loading=!1)},handle_pagination=e=>{var t,n,l;steps[e._index].offset||$$invalidate(2,steps[e._index].offset=0,steps),steps[e._index].limit||$$invalidate(2,steps[e._index].limit=10,steps),e.detail.type==="next"?$$invalidate(2,steps[e._index].offset=((t=steps==null?void 0:steps[e._index])==null?void 0:t.offset)+1,steps):e.detail.type==="back"?$$invalidate(2,steps[e._index].offset=((n=steps==null?void 0:steps[e._index])==null?void 0:n.offset)-1,steps):e.detail.type==="first"?$$invalidate(2,steps[e._index].offset=0,steps):e.detail.type==="last"?$$invalidate(2,steps[e._index].offset=Math.ceil(((e==null?void 0:e._length)||steps[e._index].limit)/steps[e._index].limit)-1,steps):e.detail.type==="rows_per_page"&&($$invalidate(2,steps[e._index].limit=((l=e==null?void 0:e.detail)==null?void 0:l.rows_per_page)||10,steps),$$invalidate(2,steps[e._index].offset=0,steps)),$$invalidate(2,steps=[...steps])},_sort=(e,t,n)=>{var l;try{return field_order!=null&&field_order[t==null?void 0:t.table]||(field_order[t==null?void 0:t.table]={}),(l=field_order==null?void 0:field_order[t==null?void 0:t.table])!=null&&l[n==null?void 0:n.name]?field_order[t==null?void 0:t.table][n==null?void 0:n.name]=(field_order[t==null?void 0:t.table][n==null?void 0:n.name]||1)*-1:field_order[t==null?void 0:t.table][n==null?void 0:n.name]=1,e.sort((a,r)=>{let s;return a[n==null?void 0:n.name]>r[n==null?void 0:n.name]?s=1:(r[n==null?void 0:n.name]>a[n==null?void 0:n.name],s=-1),s*field_order[t==null?void 0:t.table][n==null?void 0:n.name]})}catch{return e}},get_step_data=(e,t)=>{var l;const n=(t||[]).filter(a=>{var s;let r=!0;if(e!=null&&e.filter){if(!(((s=e==null?void 0:e.filter)==null?void 0:s.length)<3)){r=!1;let o=e==null?void 0:e.filter;const _=o.split(":");let i=null;_.length>1&&(i=_[0],o=_[1],console.log({_field:i,_filter:o}));try{const c=new RegExp(o,"i");if(i)((a==null?void 0:a[i])||"").toString().match(c)&&(r=!0);else for(let u=0;u<Object.keys(a).length;u++){const m=Object.keys(a)[u];if(a[m]){if(a[m].toString().length<3)continue}else continue;if(a[m].toString().match(c)){r=!0;break}}}catch(c){console.log(c.message)}}}return r});if(e!=null&&e.order_by_field){const a=(l=e==null?void 0:e.fields)==null?void 0:l.filter(r=>(r==null?void 0:r.name)===(e==null?void 0:e.order_by_field))[0];return _sort(n,e,a)}else return n},get_eval=(payload,d,field,selected_etlrb)=>{try{return eval(payload)}catch(e){return console.log(payload,d,field,selected_etlrb,e.message),!1}},after_save_form=e=>{console.log("after_save_form".toUpperCase(),e),get_data({})},get_form_conf=e=>{var t,n,l,a,r,s;if((l=(n=(t=$_global==null?void 0:$_global.tables)==null?void 0:t[e])==null?void 0:n.custom_form)!=null&&l.config)try{return JSON.parse((s=(r=(a=$_global==null?void 0:$_global.tables)==null?void 0:a[e])==null?void 0:r.custom_form)==null?void 0:s.config)}catch(o){return console.log(o.message),{}}},get_form=async e=>{var t,n,l,a,r,s,o,_,i,c,u;try{const m=lodashExports.cloneDeep(e.data||{});e.clone===!0&&(m._original_pk=m[(n=(t=$_global==null?void 0:$_global.tables)==null?void 0:t[e.table])==null?void 0:n.pk],delete m[(a=(l=$_global==null?void 0:$_global.tables)==null?void 0:l[e.table])==null?void 0:a.pk],m.clone=!0);let b=`${$i18n.t("crud.add")} - ${(s=(r=$_global==null?void 0:$_global.tables)==null?void 0:r[e.table])==null?void 0:s.comment}`;m!=null&&m[(_=(o=$_global==null?void 0:$_global.tables)==null?void 0:o[e.table])==null?void 0:_.pk]&&(b=`${$i18n.t("crud.edit")} - ${(c=(i=$_global==null?void 0:$_global.tables)==null?void 0:i[e.table])==null?void 0:c.comment}`),$$invalidate(8,loading=!0);const f=(await __vitePreload(async()=>{const{default:p}=await import("./GlobalForm-ciaD9fnn.js");return{default:p}},__vite__mapDeps([0,1,2,3,4]),import.meta.url)).default;$$invalidate(7,modal_data.actions=null,modal_data),$$invalidate(7,modal_data.header=!0,modal_data),$$invalidate(7,modal_data.component=f,modal_data),$$invalidate(7,modal_data.msg=null,modal_data),$$invalidate(7,modal_data.html_msg=null,modal_data),$$invalidate(7,modal_data.header_actions=[{type:"icon",icon:"cog-8-tooth",name:"form_customization",label:$i18n.t("crud.form_customization")},{type:"icon",icon:"save",name:"save",label:$i18n.t("crud.save"),action:after_save_form}],modal_data),$$invalidate(7,modal_data.title=b,modal_data),$$invalidate(7,modal_data.data={table:e==null?void 0:e.table,data:m,aux_data:lodashExports.cloneDeep(e==null?void 0:e.aux_data),main_table:(e==null?void 0:e.main_table)||table},modal_data);const h=get_form_conf(e==null?void 0:e.table);$$invalidate(7,modal_data.width=((u=h==null?void 0:h.layout)==null?void 0:u.size)||10,modal_data),$$invalidate(7,modal_data.heigth=null,modal_data),$$invalidate(7,modal_data.open=!0,modal_data),$$invalidate(8,loading=!1)}catch(m){$$invalidate(8,loading=!1),console.log(m.message),$$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="error",toast),$$invalidate(6,toast.msg=m.message,toast)}},set_dates=e=>{if((e==null?void 0:e.length)>0){const t=steps;t[tab].dates_refs=lodashExports.cloneDeep(e),$$invalidate(2,steps=[...lodashExports.cloneDeep(t)]),dismiss_modal()}},pick_dates=async e=>{try{$$invalidate(8,loading=!0);const t=(await __vitePreload(async()=>{const{default:n}=await import("./PickDates-Dg1OZM7q.js");return{default:n}},__vite__mapDeps([5,1,2,3]),import.meta.url)).default;$$invalidate(7,modal_data.actions=null,modal_data),$$invalidate(7,modal_data.header=!0,modal_data),$$invalidate(7,modal_data.component=t,modal_data),$$invalidate(7,modal_data.msg=null,modal_data),$$invalidate(7,modal_data.html_msg=null,modal_data),$$invalidate(7,modal_data.header_actions=[],modal_data),$$invalidate(7,modal_data.title=`${$i18n.t("crud.set")} ${$i18n.t("crud.date")}s`,modal_data),$$invalidate(7,modal_data.data={dates_refs:lodashExports.cloneDeep((e==null?void 0:e.dates_refs)||[]),set_dates},modal_data),$$invalidate(7,modal_data.actions=[{type:"btn",icon:"ban",name:"CANCEL",class:"btn-sm text-error",label:$i18n.t("crud.cancel"),action:dismiss_modal},{type:"btn",icon:"trash",name:"CLEAN",class:"btn-sm text-warning",label:$i18n.t("crud.clean")},{type:"btn",icon:"check",name:"SET",class:"btn-sm text-success",label:$i18n.t("crud.set"),action:set_dates}],modal_data),$$invalidate(7,modal_data.width=4,modal_data),$$invalidate(7,modal_data.heigth=null,modal_data),$$invalidate(7,modal_data.open=!0,modal_data),$$invalidate(8,loading=!1)}catch(t){$$invalidate(8,loading=!1),console.log(t.message),$$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="error",toast),$$invalidate(6,toast.msg=t.message,toast)}},explore_db=async e=>{var t,n,l;try{let a=`${$i18n.t("crud.explore_db")} - ${selected_etlrb==null?void 0:selected_etlrb.database}`,r=(t=e==null?void 0:e.data)==null?void 0:t.destination_table;((n=e==null?void 0:e.step)==null?void 0:n.table)==="etl_rbase_input"&&(r=(l=e==null?void 0:e.data)==null?void 0:l.destination_table),$$invalidate(8,loading=!0);const s=(await __vitePreload(async()=>{const{default:o}=await import("./DBExplorer-ivI6VOVv.js");return{default:o}},__vite__mapDeps([6,1,2,3,7]),import.meta.url)).default;$$invalidate(7,modal_data.actions=null,modal_data),$$invalidate(7,modal_data.header=!0,modal_data),$$invalidate(7,modal_data.component=s,modal_data),$$invalidate(7,modal_data.msg=null,modal_data),$$invalidate(7,modal_data.html_msg=null,modal_data),$$invalidate(7,modal_data.header_actions=[{type:"btn",icon:"refresh",name:"REFRESH",class:"btn-sm text-info",label:$i18n.t("crud.refresh"),action:null},{type:"icon",icon:"save",name:"save",label:$i18n.t("crud.save"),action:after_save_form}],modal_data),$$invalidate(7,modal_data.title=a,modal_data),$$invalidate(7,modal_data.data={data:{manage_query_conf:e!=null&&e.manage_query_conf?JSON.stringify(e==null?void 0:e.manage_query_conf):null,table:r,database:selected_etlrb==null?void 0:selected_etlrb.database,etlrb:e==null?void 0:e.selected_etlrb,app:$_global==null?void 0:$_global.selected_app}},modal_data),$$invalidate(7,modal_data.width=95,modal_data),$$invalidate(7,modal_data.heigth=95,modal_data),$$invalidate(7,modal_data.open=!0,modal_data),$$invalidate(8,loading=!1)}catch(a){$$invalidate(8,loading=!1),console.log(a.message),$$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="error",toast),$$invalidate(6,toast.msg=a.message,toast)}},dismiss_modal=e=>{$$invalidate(7,modal_data.actions=null,modal_data),$$invalidate(7,modal_data.open=!1,modal_data)},select_file=e=>{try{document.getElementById(e.id).click()}catch(t){console.log(t.message)}},file_upload=async e=>{var t,n,l,a,r,s,o;$$invalidate(8,loading=!0);try{change_db_data({...e==null?void 0:e.data,value:(a=(l=(n=(t=e==null?void 0:e.event)==null?void 0:t.currentTarget)==null?void 0:n.files)==null?void 0:l[0])==null?void 0:a.name});const _={lang:$_global==null?void 0:$_global.lang,conf:$_global==null?void 0:$_global.conf,token:$_global==null?void 0:$_global.token,file:e.event.currentTarget.files[0],tmp:((s=(r=e==null?void 0:e.data)==null?void 0:r.data)==null?void 0:s.save_only_temp)||!1,path:null},i=await upload(_);console.log("upload:",i),i.success===!0?($$invalidate(30,data[(o=e==null?void 0:e.field)==null?void 0:o.name]=i.file,data),change_db_data({...e==null?void 0:e.data,value:i.file}),$$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="success",toast),$$invalidate(6,toast.msg=i.msg,toast)):($$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="error",toast),$$invalidate(6,toast.msg=i.msg,toast))}catch(_){console.log(_.message),$$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="error",toast),$$invalidate(6,toast.msg=_.message,toast)}$$invalidate(8,loading=!1)},drop_file_handler=(e,t)=>{try{e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&e.dataTransfer.files.length>0&&(file_upload({data:t,event:{currentTarget:{files:e.dataTransfer.files}}}),e.dataTransfer.clearData())}catch(n){console.log(n.message)}},paste_file_handler=(e,t)=>{try{e.stopPropagation(),console.log(e,t,e.clipboardData.files),e.clipboardData.files&&e.clipboardData.files.length>0&&(file_upload({data:t,event:{currentTarget:{files:e.clipboardData.files}}}),e.clipboardData.clearData())}catch(n){console.log(n.message)}},set_entire_col_val=e=>{console.log(e),db_data[e==null?void 0:e.table].data.forEach(t=>{t[e==null?void 0:e.field]=e==null?void 0:e.value}),$$invalidate(4,db_data={...db_data}),console.log(db_data[e==null?void 0:e.table].data)},_set_all=e=>{var n,l;const t=steps;if(hooks(e).isValid()){for(let a=0;a<t.length;a++)(n=t[a])!=null&&n.date_ref?t[a].date_ref=hooks(e).clone().format("YYYY-MM-DD"):(l=t[a])!=null&&l.dates_refs&&(t[a].dates_refs=[hooks(e).clone().format("YYYY-MM-DD")]);$$invalidate(2,steps=[...t])}},change_db_data=e=>{var t,n;!((t=db_data==null?void 0:db_data[e==null?void 0:e.table])!=null&&t.data[e==null?void 0:e.index])&&typeof(e==null?void 0:e.value)=="object"&&((n=db_data==null?void 0:db_data[e==null?void 0:e.table])!=null&&n.data)?(db_data[e==null?void 0:e.table].data.unshift(e==null?void 0:e.value),$$invalidate(4,db_data={...db_data})):($$invalidate(4,db_data[e==null?void 0:e.table].data[e==null?void 0:e.index][e==null?void 0:e.field]=e==null?void 0:e.value,db_data),$$invalidate(4,db_data={...db_data}))},submenu=async e=>{var t,n,l,a,r,s,o,_;try{e.closeModal===!0&&dismiss_modal(),console.log({payload:e}),$$invalidate(8,loading=!0),$$invalidate(7,modal_data.actions=null,modal_data),$$invalidate(7,modal_data.msg=null,modal_data),$$invalidate(7,modal_data.html_msg=null,modal_data),$$invalidate(7,modal_data.header=!1,modal_data),$$invalidate(7,modal_data.heigth=90,modal_data);const i=`${(n=(t=$_global==null?void 0:$_global.tables)==null?void 0:t[e==null?void 0:e.table])==null?void 0:n.comment}`;$$invalidate(7,modal_data.title=i,modal_data),$$invalidate(7,modal_data.data={table:e==null?void 0:e.table,data:{data:lodashExports.cloneDeep(e==null?void 0:e.data)},aux_data:{data:lodashExports.cloneDeep(e==null?void 0:e.data)},is_fk:!1,is_subform:!1,is_submenu:!0,main_table:(e==null?void 0:e.main_table)||table,label:(a=e==null?void 0:e.data)!=null&&a[(l=e==null?void 0:e.aux)==null?void 0:l.referred_columns_desc]?`${(s=(r=$_global==null?void 0:$_global.tables)==null?void 0:r[(e==null?void 0:e.main_table)||table])==null?void 0:s.comment}: ${(_=e==null?void 0:e.data)==null?void 0:_[(o=e==null?void 0:e.aux)==null?void 0:o.referred_columns_desc]}/${i}`:null,actions:{dismiss_modal}},modal_data),$$invalidate(7,modal_data.component=(await __vitePreload(async()=>{const{default:c}=await import("./CrudHandler-DyhX_xV5.js");return{default:c}},__vite__mapDeps([8,1,2]),import.meta.url)).default,modal_data),$$invalidate(7,modal_data.width=12,modal_data),$$invalidate(7,modal_data.open=!0,modal_data),$$invalidate(8,loading=!1)}catch(i){$$invalidate(8,loading=!1),console.log(i.message),$$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="error",toast),$$invalidate(6,toast.msg=i.message,toast)}},_lambd=e=>!(e!=null&&e.fix)&&(e!=null&&e.check)?e==null?void 0:e.check:e!=null&&e.fix&&!(e!=null&&e.check)?e==null?void 0:e.fix:!(e!=null&&e.fix)&&!(e!=null&&e.check)?0:`${e==null?void 0:e.fix} / ${e==null?void 0:e.check}`,run_action=async e=>{var a,r,s,o,_,i,c,u,m,b,f,h,p,g,w,v,E,Y,T,O,C,U,K,W,P,J,R,A,M,H,z,k,L,V,Z,S,ee,te,D,N,G,x,y,ne,le,B,ae,re,_e,oe,ce,ue,de,fe,me,be;change_db_data({table:(a=e==null?void 0:e.step)==null?void 0:a.table,index:e==null?void 0:e.index,field:"loading",value:!0});const t={class:"etl",method:(e==null?void 0:e.action)||((r=e==null?void 0:e.field)==null?void 0:r.action),conf:$_global==null?void 0:$_global.conf,token:$_global==null?void 0:$_global.token,app:$_global==null?void 0:$_global.selected_app,data:{...e,db_data:(e==null?void 0:e.action)=="notify"?db_data:null}};$$invalidate(9,loading_level2=!0),$$invalidate(10,log={type:(s=e==null?void 0:e.action)==null?void 0:s.toUpperCase(),name:(e==null?void 0:e.name)||`${(o=e==null?void 0:e.step)==null?void 0:o.label}/${e==null?void 0:e.action}`,ref:hooks((_=e==null?void 0:e.step)==null?void 0:_.date_ref),start:hooks(new Date),end:null,timer:null,success:null,msg:null,etl_report_base_id:selected_etlrb==null?void 0:selected_etlrb.etl_report_base_id,loading:!0}),db_data!=null&&db_data.etl_report_base_log||$$invalidate(4,db_data.etl_report_base_log={data:[]},db_data),db_data.etl_report_base_log.data.unshift(log);const n=0,l=setInterval(()=>{try{const $=hooks(new Date).diff(log==null?void 0:log.start,"milliseconds");$$invalidate(10,log.timer=`${($/1e3).toFixed(2)} s`,log),$/1e3>60&&$$invalidate(10,log.timer=`${($/1e3/60).toFixed(2)} m`,log),$$invalidate(4,db_data.etl_report_base_log.data[n].timer=log.timer,db_data),$$invalidate(4,db_data={...db_data})}catch($){console.log("TIMER ERR:",$),clearInterval(l)}},100);try{const $=await gbl_api_call(t);if($$invalidate(10,log.end=hooks(new Date),log),console.log("action res:",$),$.success===!0){if($$invalidate(10,log.msg=$.msg,log),$$invalidate(10,log.success=$.success,log),(i=e==null?void 0:e.step)!=null&&i.run_all||($$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="success",toast),$$invalidate(6,toast.msg=$.msg,toast)),Object.hasOwnProperty.call($,"n_rows")&&(change_db_data({table:(c=e==null?void 0:e.step)==null?void 0:c.table,index:e==null?void 0:e.index,field:"num_rows",value:format_number($.n_rows||"0"," ",0,null)}),$$invalidate(10,log.n_rows=$.n_rows,log),$$invalidate(10,log.num_rows=$.n_rows,log),$$invalidate(10,log.value=format_number($.n_rows||"0"," ",0,null),log),$.n_cols&&$$invalidate(10,log.value=`(${format_number($.n_rows||"0"," ",0,null)}, ${format_number($.n_cols||"0"," ",0,null)})`,log)),(u=$==null?void 0:$.data)!=null&&u.check||(m=$==null?void 0:$.data)!=null&&m.fix){const Q=lodashExports.cloneDeep(get_step_data({...e==null?void 0:e.step,filter:null,order_by_field:null},(f=db_data==null?void 0:db_data[(b=e==null?void 0:e.step)==null?void 0:b.table])==null?void 0:f.data)).map((F,ke)=>{var $e,he,I,q,X,ge,pe,ve;return(he=($e=$==null?void 0:$.data)==null?void 0:$e.check)!=null&&he[F==null?void 0:F.etl_rbase_quality_id]&&(F.num_erros_check=(q=(I=$==null?void 0:$.data)==null?void 0:I.check)==null?void 0:q[F==null?void 0:F.etl_rbase_quality_id],F.check=F.num_erros_check),(ge=(X=$==null?void 0:$.data)==null?void 0:X.fix)!=null&&ge[F==null?void 0:F.etl_rbase_quality_id]&&(F.num_erros_fix=(ve=(pe=$==null?void 0:$.data)==null?void 0:pe.fix)==null?void 0:ve[F==null?void 0:F.etl_rbase_quality_id],F.fix=F.num_erros_fix),F});$$invalidate(10,log._data=Q,log);const ie=((p=Object.keys((h=$==null?void 0:$.data)==null?void 0:h.check))==null?void 0:p[0])||((w=Object.keys((g=$==null?void 0:$.data)==null?void 0:g.fix))==null?void 0:w[0]);$$invalidate(10,log.value=_lambd({fix:(E=(v=$==null?void 0:$.data)==null?void 0:v.fix)==null?void 0:E[ie],check:(T=(Y=$==null?void 0:$.data)==null?void 0:Y.check)==null?void 0:T[ie]}),log),$$invalidate(10,log.errors=(C=(O=$==null?void 0:$.data)==null?void 0:O.check)==null?void 0:C[ie],log),$$invalidate(10,log.fixes=(K=(U=$==null?void 0:$.data)==null?void 0:U.fix)==null?void 0:K[ie],log),$$invalidate(4,db_data={...db_data,[(W=e==null?void 0:e.step)==null?void 0:W.table]:{...db_data==null?void 0:db_data[(P=e==null?void 0:e.step)==null?void 0:P.table],data:[...lodashExports.cloneDeep(Q)]}})}(e==null?void 0:e.action)==="data_reconcilia"&&($!=null&&$.html)?($$invalidate(10,log.html=$==null?void 0:$.html,log),$$invalidate(10,log._data=$==null?void 0:$.data,log),change_db_data({table:(J=e==null?void 0:e.step)==null?void 0:J.table,index:e==null?void 0:e.index,field:"html",value:$==null?void 0:$.html}),change_db_data({table:(R=e==null?void 0:e.step)==null?void 0:R.table,index:e==null?void 0:e.index,field:"data",value:$==null?void 0:$.data})):(e==null?void 0:e.action)==="export"&&($!=null&&$.data)&&($$invalidate(10,log.fname=(M=(A=$==null?void 0:$.data)==null?void 0:A[0])==null?void 0:M.fname,log),$$invalidate(10,log.value=(z=(H=$==null?void 0:$.data)==null?void 0:H[0])==null?void 0:z.fname,log),$$invalidate(10,log._data=$==null?void 0:$.data,log),change_db_data({table:(k=e==null?void 0:e.step)==null?void 0:k.table,index:e==null?void 0:e.index,field:"file",value:(V=(L=$==null?void 0:$.data)==null?void 0:L[0])==null?void 0:V.fname}),change_db_data({table:(Z=e==null?void 0:e.step)==null?void 0:Z.table,index:e==null?void 0:e.index,field:"data",value:$==null?void 0:$.data}))}else(S=e==null?void 0:e.step)!=null&&S.run_all||($$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="error",toast),$$invalidate(6,toast.msg=$.msg||$.toString(),toast)),$$invalidate(10,log.msg=$.msg,log),$$invalidate(10,log.success=$.success,log)}catch($){$$invalidate(10,log.end=hooks(new Date),log),(ee=e==null?void 0:e.step)!=null&&ee.run_all||($$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="error",toast),$$invalidate(6,toast.msg=`${(te=e==null?void 0:e.step)==null?void 0:te.label}/${e==null?void 0:e.action}: ${$==null?void 0:$.message}`,toast)),$$invalidate(10,log.msg=toast.msg,log),$$invalidate(10,log.success=!1,log)}try{const $=log.end.diff(log==null?void 0:log.start,"milliseconds");if($$invalidate(10,log.diff=$,log),$$invalidate(10,log.timer=`${($/1e3).toFixed(2)} s`,log),$/1e3>60&&$$invalidate(10,log.timer=`${($/1e3/60).toFixed(2)} m`,log),$$invalidate(10,log.loading=!1,log),$$invalidate(4,db_data.etl_report_base_log.data[n]=lodashExports.cloneDeep(log),db_data),log!=null&&log._data){if(((D=log==null?void 0:log._data)==null?void 0:D.length)>0){const Q={export:"fname",extract:"n_rows",n_rows:"n_rows",data_quality:[{check:"errors"},{fix:"fixes"}]};let ie=1;if(["data_quality","--data_quality_check","--data_quality_fix"].includes(e==null?void 0:e.action)&&(ie=0,$$invalidate(10,log=lodashExports.cloneDeep(log)),db_data.etl_report_base_log.data.splice(n,1)),Q!=null&&Q[e==null?void 0:e.action])for(let F=ie;F<((N=log==null?void 0:log._data)==null?void 0:N.length);F++)["data_quality","data_quality_check","data_quality_fix"].includes(e==null?void 0:e.action)?($$invalidate(10,log.value=_lambd((G=log==null?void 0:log._data)==null?void 0:G[F]),log),$$invalidate(10,log.errors=(y=(x=log==null?void 0:log._data)==null?void 0:x[F])==null?void 0:y.check,log),$$invalidate(10,log.fixes=(le=(ne=log==null?void 0:log._data)==null?void 0:ne[F])==null?void 0:le.fix,log),$$invalidate(10,log.name=(ae=(B=log==null?void 0:log._data)==null?void 0:B[F])==null?void 0:ae.etl_rbase_quality,log)):($$invalidate(10,log.value=(_e=(re=log==null?void 0:log._data)==null?void 0:re[F])==null?void 0:_e[Q==null?void 0:Q[e==null?void 0:e.action]],log),$$invalidate(10,log[Q==null?void 0:Q[e==null?void 0:e.action]]=(ce=(oe=log==null?void 0:log._data)==null?void 0:oe[F])==null?void 0:ce[Q==null?void 0:Q[e==null?void 0:e.action]],log)),(de=(ue=log==null?void 0:log._data)==null?void 0:ue[F])!=null&&de.date_ref&&$$invalidate(10,log.ref=hooks((me=(fe=log==null?void 0:log._data)==null?void 0:fe[F])==null?void 0:me.date_ref),log),db_data.etl_report_base_log.data.unshift(lodashExports.cloneDeep(log))}}$$invalidate(4,db_data={...db_data}),clearInterval(l),$$invalidate(9,loading_level2=!1),$$invalidate(10,log=null),change_db_data({table:(be=e==null?void 0:e.step)==null?void 0:be.table,index:e==null?void 0:e.index,field:"loading",value:!1})}catch($){console.log($),clearInterval(l)}return null},btn_action=e=>{var n,l,a,r,s,o,_,i,c,u,m,b,f,h,p,g;if(typeof(selected_etlrb==null?void 0:selected_etlrb.database)=="string"){if((n=selected_etlrb==null?void 0:selected_etlrb.database)!=null&&n.toString().match(/\{.*\}/))try{$$invalidate(1,selected_etlrb.database=JSON.parse(selected_etlrb.database),selected_etlrb)}catch{}}let t=(e==null?void 0:e.action)||((l=e==null?void 0:e.field)==null?void 0:l.action);switch(t){case"edit":get_form({data:e==null?void 0:e.data,table:(a=e==null?void 0:e.step)==null?void 0:a.table,main_table:table});break;case"copy":get_form({data:e==null?void 0:e.data,table:(r=e==null?void 0:e.step)==null?void 0:r.table,main_table:table,clone:!0});break;case"extract":run_action({...e,action:t,selected_etlrb});break;case"n_rows":run_action({...e,action:t,selected_etlrb});break;case"explore_db":explore_db({...e,action:t,selected_etlrb});break;case"data_reconcilia_preview":e.step.show_html=!e.step.show_html,$$invalidate(2,steps=[...steps]);break;case"details":submenu({table:(s=e==null?void 0:e.step)==null?void 0:s.detail_table,main_table:((o=e==null?void 0:e.step)==null?void 0:o.main_table)||((_=e==null?void 0:e.step)==null?void 0:_.table),data:lodashExports.cloneDeep(e==null?void 0:e.data)});break;case"err_details":let w=(i=e==null?void 0:e.data)==null?void 0:i.sql_quality_check,v=/,|;|\|/g,E=((u=(c=e==null?void 0:e.data)==null?void 0:c.tables)==null?void 0:u.split(v))||[],Y=((b=(m=e==null?void 0:e.data)==null?void 0:m.fields)==null?void 0:b.split(v))||[];Y.length>0?Y=[...Y.map(U=>({table:E==null?void 0:E[0],field:U}))]:Y=[{table:E==null?void 0:E[0],field:"*"}],v=/COUNT\(\"?.+\"?\).+\"?.+\"?/g,w=w.replace(v,Y.length>0?`"${Y.map(C=>C==null?void 0:C.field).join('", "')}"`:"*"),v=/\{.*?\}/g;const T=w.match(v);T&&T.forEach(C=>{var W,P,J,R;const U=C.replace(/\{|\}/g,""),K=(R=(J=((W=e==null?void 0:e.step)==null?void 0:W.dates_refs)||[(P=e==null?void 0:e.step)==null?void 0:P.date_ref])==null?void 0:J.map(A=>hooks(A).format(U)))==null?void 0:R[0];w=w.replace(v,K)});const O={tables:[...E],selecetd_table:E==null?void 0:E[0],selected_table_fields:[],selected_tab:string_ellipsis((f=e==null?void 0:e.data)==null?void 0:f.etl_rbase_quality),selected_tab_2_prev:string_ellipsis((h=e==null?void 0:e.data)==null?void 0:h.etl_rbase_quality),tabs:{[string_ellipsis((p=e==null?void 0:e.data)==null?void 0:p.etl_rbase_quality)]:{label:(g=e==null?void 0:e.data)==null?void 0:g.etl_rbase_quality,fields:[...Y],sql:w,show:!0,use:!0,limit:10,offset:0}}};explore_db({...e,manage_query_conf:O,action:t,selected_etlrb});break;case"delete":del_dialog({...e,action:t,selected_etlrb});break;case"edit_cnf":edit_cnf({...e,action:t,selected_etlrb});break;default:run_action({...e,action:t,selected_etlrb});break}},run_all=async e=>{let t=steps;for(let n=0;n<t.length;n++){const l=await run_step({...t[n],run_all:!0});if(l){if(l.cancel===!0)return l}}},set_conf=e=>{var t,n,l,a,r;try{let s=JSON.stringify(e==null?void 0:e.json_object);change_db_data({table:(n=(t=e==null?void 0:e.extras)==null?void 0:t.step)==null?void 0:n.table,index:(l=e==null?void 0:e.extras)==null?void 0:l.index,field:(r=(a=e==null?void 0:e.extras)==null?void 0:a.field)==null?void 0:r.conf_field,value:s})}catch(s){console.log(s==null?void 0:s.message)}dismiss_modal()},edit_cnf=async e=>{var t,n;try{console.log(e);let l={};try{l=JSON.parse((n=e==null?void 0:e.data)==null?void 0:n[(t=e==null?void 0:e.field)==null?void 0:t.conf_field])}catch{return null}$$invalidate(8,loading=!0);const a=(await __vitePreload(async()=>{const{default:r}=await import("./EditConf-B2sqiuCT.js");return{default:r}},__vite__mapDeps([9,1,2,4,3]),import.meta.url)).default;$$invalidate(7,modal_data.actions=null,modal_data),$$invalidate(7,modal_data.header=!0,modal_data),$$invalidate(7,modal_data.component=a,modal_data),$$invalidate(7,modal_data.msg=null,modal_data),$$invalidate(7,modal_data.html_msg=null,modal_data),$$invalidate(7,modal_data.header_actions=[],modal_data),$$invalidate(7,modal_data.title=`${$i18n.t("crud.edit_cnf")}`,modal_data),$$invalidate(7,modal_data.data={json_object:l,extras:e},modal_data),$$invalidate(7,modal_data.actions=[{type:"btn",icon:"ban",name:"CANCEL",class:"btn-sm text-error",label:$i18n.t("crud.cancel"),action:dismiss_modal},{type:"btn",icon:"code",name:"JSON",class:"btn-sm text-warning",label:$i18n.t("crud.code")},{type:"btn",icon:"check",name:"SET",class:"btn-sm text-success",label:$i18n.t("crud.set"),action:set_conf}],modal_data),$$invalidate(7,modal_data.width=6,modal_data),$$invalidate(7,modal_data.heigth=null,modal_data),$$invalidate(7,modal_data.open=!0,modal_data),$$invalidate(8,loading=!1)}catch(l){$$invalidate(8,loading=!1),console.log(l.message),$$invalidate(6,toast.open=!0,toast),$$invalidate(6,toast.type="error",toast),$$invalidate(6,toast.msg=l.message,toast)}},del_dialog=e=>{var n;const t=$i18n.t("crud.del_etl_alert",{item:e==null?void 0:e.name,len:e==null?void 0:e.items,s:(e==null?void 0:e.items)>1?"s":"",name:(e==null?void 0:e.label)||((n=e==null?void 0:e.step)==null?void 0:n.label)});$$invalidate(7,modal_data.actions=null,modal_data),$$invalidate(7,modal_data.component=null,modal_data),$$invalidate(7,modal_data.msg=null,modal_data),$$invalidate(7,modal_data.html_msg=`<span class="m-2 text-lg">${t}</span>`,modal_data),$$invalidate(7,modal_data.open=!0,modal_data),$$invalidate(7,modal_data.header=!1,modal_data),$$invalidate(7,modal_data.data=e,modal_data),$$invalidate(7,modal_data.actions=[{type:"btn",icon:"ban",name:"NO",class:"btn-sm text-error",label:$i18n.t("crud.no"),action:dismiss_modal},{type:"btn",icon:"check",name:"YES",class:"btn-sm text-success",label:$i18n.t("crud.yes"),action:deletion_confirm}],modal_data),$$invalidate(7,modal_data.width=4,modal_data),$$invalidate(7,modal_data.heigth=null,modal_data)},deletion_confirm=e=>{var t;console.log("deletion_confirm:",e==null?void 0:e.data),dismiss_modal(),(t=e==null?void 0:e.data)!=null&&t.is_step?run_step(e):run_action(e==null?void 0:e.data)},run_step=async e=>{var t,n,l,a,r,s,o,_,i,c,u,m,b,f,h,p;if(get_eval((e==null?void 0:e.show)||"true",e,null,selected_etlrb))if(e!=null&&e.run_all_action){const g=get_step_data(e,(t=db_data==null?void 0:db_data[e==null?void 0:e.table])==null?void 0:t.data);if((e==null?void 0:e.run_all_action)==="delete"&&!(e!=null&&e.del_confirmed))del_dialog({...e,del_confirmed:!0,is_step:!0,items:(g==null?void 0:g.length)||1});else{const w=e==null?void 0:e.run_all_action;if(["data_quality"].indexOf(w)!==-1){const v=await run_action({field:(n=e==null?void 0:e.fields)==null?void 0:n[0],index:0,step:e,action:w,selected_etlrb,name:(r=g[0])==null?void 0:r[(a=(l=e==null?void 0:e.fields)==null?void 0:l[0])==null?void 0:a.name]});if(v){if(v.cancel===!0)return v}}else{let v=(_=(o=(s=e==null?void 0:e.fields)==null?void 0:s.filter(E=>E.action===w))==null?void 0:o[0])==null?void 0:_.disabled;for(let E=0;E<g.length;E++){if(((i=g[E])==null?void 0:i.ignore)===!0)continue;if(Object.hasOwnProperty.call(g[E],"active")&&!((c=g[E])!=null&&c.active))continue;if(v&&get_eval(v,g[E],null,selected_etlrb))continue;const Y=(m=(u=e==null?void 0:e.fields)==null?void 0:u.filter(O=>(O==null?void 0:O.name)===(e==null?void 0:e.run_all_action)))==null?void 0:m[0],T=await run_action({field:Y,data:g[E],index:((b=g[E])==null?void 0:b.index)||E,step:e,action:w,selected_etlrb,name:((p=g[E])==null?void 0:p[(h=(f=e==null?void 0:e.fields)==null?void 0:f[0])==null?void 0:h.name])||(e==null?void 0:e.run_all_action)});if(T){if(T.cancel===!0)return T}}}}}else return null;else return null;return null},_get_value=e=>{var t,n,l,a,r,s,o,_;if(((n=(t=e==null?void 0:e.field)==null?void 0:t.check_first)==null?void 0:n.length)>0)for(let i=0;i<((l=e==null?void 0:e.field)==null?void 0:l.check_first.length);i++){const c=(a=e==null?void 0:e.field)==null?void 0:a.check_first[i];if((r=e==null?void 0:e.d)!=null&&r[c])return(s=e==null?void 0:e.d)==null?void 0:s[c]}return(_=e==null?void 0:e.d)==null?void 0:_[(o=e==null?void 0:e.field)==null?void 0:o.name]};onMount(async()=>{$i18n.changeLanguage($_global==null?void 0:$_global.lang);try{hooks.locale($_global==null?void 0:$_global.lang)}catch{hooks.locale("en-us")}console.log("ETL / REPORT  Mount:",{table,data,option}),(data==null?void 0:data.periodicity_id)===2&&_set_all(hooks().startOf("month").subtract(1,"days"));try{$$invalidate(1,selected_etlrb=lodashExports.cloneDeep(data))}catch(e){console.log(e.message)}(async()=>await get_data(data))()});const click_handler=e=>{$$invalidate(5,tab=e)},click_handler_1=e=>btn_action({field:{action:"data_reconcilia_preview"},step:e});function input_input_handler(e,t){e[t].date_ref=this.value,$$invalidate(2,steps)}const change_handler=(e,t)=>{var n;set_entire_col_val({value:(n=t.target)==null?void 0:n.value,field:t.target.name,table:e==null?void 0:e.table})},click_handler_2=(e,t)=>{_set_all(e.date_ref)};function input_input_handler_1(e,t){e[t].filter=this.value,$$invalidate(2,steps)}const click_handler_3=e=>pick_dates(e),func=e=>hooks(e).format($i18n.t("fmrt.date")),func_1=e=>hooks(e).format($i18n.t("fmrt.date")),focus_handler=e=>pick_dates(e),click_handler_4=e=>{var t,n;return save({table:e==null?void 0:e.table,data:(n=(t=db_data==null?void 0:db_data[e==null?void 0:e.table])==null?void 0:t.data)==null?void 0:n.map(l=>({...l,ref:hooks(l.ref).format("YYYY-MM-DD")})),do_not_reload:!1})},click_handler_5=e=>run_step({...e,run_all_action:"delete",run_all:!0}),click_handler_6=e=>get_form({data:selected_etlrb,table:e==null?void 0:e.table,main_table:table}),click_handler_7=e=>run_step({...e,run_all:!0}),click_handler_8=e=>{console.log("EXPORT STEP DATA","PDF","EXCEL",e)},click_handler_9=e=>explore_db(e);function input_change_handler(e,t,n){t[n][e==null?void 0:e.name]=this.checked,$$invalidate(2,steps)}const change_handler_1=(e,t,n)=>{var l;set_entire_col_val({value:(l=n.target)==null?void 0:l.checked,field:e==null?void 0:e.name,table:t==null?void 0:t.table})},click_handler_10=(e,t,n)=>{console.log(e==null?void 0:e.html),$$invalidate(11,t[n].show_html=!e.show_html,get_step_data,$$invalidate(2,steps),$$invalidate(4,db_data))},click_handler_11=(e,t,n)=>{$$invalidate(11,t[n].show_html=!e.show_html,get_step_data,$$invalidate(2,steps),$$invalidate(4,db_data))};function input_change_handler_1(e,t,n){t[n][e==null?void 0:e.name]=this.checked,$$invalidate(11,get_step_data),$$invalidate(2,steps),$$invalidate(4,db_data)}function select_change_handler(e,t,n){t[n][e==null?void 0:e.name]=select_value(this),$$invalidate(11,get_step_data),$$invalidate(2,steps),$$invalidate(4,db_data)}const click_handler_12=(e,t,n,l)=>{var a,r;return btn_action({field:e,data:t,index:(t==null?void 0:t.index)||n,step:l,name:t[(r=(a=l==null?void 0:l.fields)==null?void 0:a[0])==null?void 0:r.name]})};function input0_input_handler(e,t,n){t[n][e.name]=this.value,$$invalidate(11,get_step_data),$$invalidate(2,steps),$$invalidate(4,db_data)}const drop_handler=(e,t,n,l,a)=>{var r,s;drop_file_handler(a,{field:e==null?void 0:e.name,table:t==null?void 0:t.table,index:(n==null?void 0:n.index)||l,data:n}),delete drag_start_class[`${e.name}_${n[(s=(r=t==null?void 0:t.fields)==null?void 0:r[0])==null?void 0:s.name]}`]},dragexit_handler=(e,t,n,l)=>{var a,r;delete drag_start_class[`${e.name}_${t[(r=(a=n==null?void 0:n.fields)==null?void 0:a[0])==null?void 0:r.name]}`]},dragend_handler=(e,t,n,l)=>{var a,r;delete drag_start_class[`${e.name}_${t[(r=(a=n==null?void 0:n.fields)==null?void 0:a[0])==null?void 0:r.name]}`]},dragleave_handler=(e,t,n,l)=>{var a,r;delete drag_start_class[`${e.name}_${t[(r=(a=n==null?void 0:n.fields)==null?void 0:a[0])==null?void 0:r.name]}`]},dragenter_handler=(e,t,n,l)=>{var a,r;console.log("DRAG ENTER DO THE STYLING"),$$invalidate(3,drag_start_class[`${e.name}_${t[(r=(a=n==null?void 0:n.fields)==null?void 0:a[0])==null?void 0:r.name]}`]="input-bordered border border-dashed border-gray-600",drag_start_class)},paste_handler=(e,t,n,l,a)=>{paste_file_handler(a,{field:e==null?void 0:e.name,table:t==null?void 0:t.table,index:(n==null?void 0:n.index)||l,data:n})},click_handler_13=(e,t,n,l,a,r)=>select_file({field:e,id:`${t==null?void 0:t.table}-${e.name}-${n}-${(l==null?void 0:l.index)||a}-file`}),change_handler_2=(e,t,n,l,a)=>file_upload({event:a,data:{field:e==null?void 0:e.name,table:t==null?void 0:t.table,index:(n==null?void 0:n.index)||l,data:n}});function input_input_handler_2(e,t,n){t[n][e==null?void 0:e.name]=this.value,$$invalidate(11,get_step_data),$$invalidate(2,steps),$$invalidate(4,db_data)}function input_input_handler_3(e,t,n){t[n][e==null?void 0:e.name]=this.value,$$invalidate(11,get_step_data),$$invalidate(2,steps),$$invalidate(4,db_data)}const pageChange_handler=(e,t,n)=>{var l,a;return handle_pagination({detail:n.detail,data:e,_index:t,_length:(a=get_step_data(e,(l=db_data==null?void 0:db_data[e==null?void 0:e.table])==null?void 0:l.data))==null?void 0:a.length})},dismiss_handler=e=>{$$invalidate(6,toast.open=!1,toast)},dismiss_handler_1=e=>dismiss_modal(e.detail);return $$self.$$set=e=>{"table"in e&&$$invalidate(0,table=e.table),"data"in e&&$$invalidate(30,data=e.data),"option"in e&&$$invalidate(31,option=e.option),"action"in e&&$$invalidate(32,action=e.action)},$$self.$$.update=()=>{$$self.$$.dirty[0]&1&&console.log({table}),$$self.$$.dirty[1]&2&&((action==null?void 0:action.name)=="CANCEL"&&(action==null||action.action()),(action==null?void 0:action.name)=="SAVE"&&console.log(action),(action==null?void 0:action.name)=="REFRESH"&&(console.log(action),get_data({})),(action==null?void 0:action.name)=="RUN_ALL"&&(console.log(action),run_all()))},[table,selected_etlrb,steps,drag_start_class,db_data,tab,toast,modal_data,loading,loading_level2,log,get_step_data,$_global,$i18n,save,handle_pagination,get_eval,get_form,pick_dates,explore_db,dismiss_modal,select_file,file_upload,drop_file_handler,paste_file_handler,set_entire_col_val,_set_all,btn_action,run_step,_get_value,data,option,action,click_handler,click_handler_1,input_input_handler,change_handler,click_handler_2,input_input_handler_1,click_handler_3,func,func_1,focus_handler,click_handler_4,click_handler_5,click_handler_6,click_handler_7,click_handler_8,click_handler_9,input_change_handler,change_handler_1,click_handler_10,click_handler_11,input_change_handler_1,select_change_handler,click_handler_12,input0_input_handler,drop_handler,dragexit_handler,dragend_handler,dragleave_handler,dragenter_handler,paste_handler,click_handler_13,change_handler_2,input_input_handler_2,input_input_handler_3,pageChange_handler,dismiss_handler,dismiss_handler_1]}class ETLReportBase extends SvelteComponent{constructor(t){super(),init(this,t,instance,create_fragment,safe_not_equal,{table:0,data:30,option:31,action:32},null,[-1,-1,-1,-1])}}export{ETLReportBase as default};
