const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./FormCustomization-CIP9ZXm5.js","./index-e7pn43aD.js","./index-C05jt-3d.css","./pt-D4E-OZuv.js","./Pagination-CqxQbQBp.js","./CrudHandler-7W4IdyLN.js"])))=>i.map(i=>d[i]);
import{S as SvelteComponent,i as init,s as safe_not_equal,z as string_ellipsis,e as element,t as text,a as space,b as attr,A as string_ellipsis_title,B as set_style,d as insert,f as append,n as set_data,g as transition_in,h as group_outros,j as transition_out,k as check_outros,o as detach,q as component_subscribe,_ as _global,r as i18n,u as onMount,l as listen,y as lodashExports,a0 as select_value,I as Icons,c as create_component,m as mount_component,p as destroy_component,C as set_input_value,ao as is_function,V as noop,D as run_all,v as ensure_array_like,a1 as add_render_callback,a2 as select_option,x as destroy_each,w as empty,Y as format_number,F as createEventDispatcher,G as hooks,Q as __vitePreload,H as prevent_default,a3 as construct_svelte_component,K as get_spread_update,T as Toast,J as assign,M as Modal,L as get_spread_object,N as Loadingv2,X as create_update,aa as upload,O as read}from"./index-e7pn43aD.js";import"./pt-D4E-OZuv.js";import ObjectEditor from"./ObjectEditor-CII2MLKg.js";function get_each_context$1(e,t,a){const n=e.slice();return n[45]=t[a],n}function create_if_block_15(e){var b;let t=((b=e[0])==null?void 0:b.code)+"",a,n,o,l,_,f,s,r,i,u;const c=[create_if_block_16,create_else_block_4$1],k=[];function m(g,p){return g[0].json_object_editor===!0?0:1}return _=m(e),f=k[_]=c[_](e),{c(){a=text(t),n=space(),o=element("button"),l=element("span"),f.c(),attr(l,"class","w-5 h-5"),attr(o,"class","btn btn-square btn-ghost btn-sm z-[1]"),attr(o,"title",s=`${e[19].t("crud.object_editor")}`)},m(g,p){insert(g,a,p),insert(g,n,p),insert(g,o,p),append(o,l),k[_].m(l,null),r=!0,i||(u=listen(o,"click",e[22]),i=!0)},p(g,p){var v;(!r||p[0]&1)&&t!==(t=((v=g[0])==null?void 0:v.code)+"")&&set_data(a,t);let $=_;_=m(g),_!==$&&(group_outros(),transition_out(k[$],1,1,()=>{k[$]=null}),check_outros(),f=k[_],f||(f=k[_]=c[_](g),f.c()),transition_in(f,1),f.m(l,null)),(!r||p[0]&524288&&s!==(s=`${g[19].t("crud.object_editor")}`))&&attr(o,"title",s)},i(g){r||(transition_in(f),r=!0)},o(g){transition_out(f),r=!1},d(g){g&&(detach(a),detach(n),detach(o)),k[_].d(),i=!1,u()}}}function create_else_block_4$1(e){let t,a;return t=new Icons({props:{type:"outline",icon:"code",path:"icons"}}),{c(){create_component(t.$$.fragment)},m(n,o){mount_component(t,n,o),a=!0},i(n){a||(transition_in(t.$$.fragment,n),a=!0)},o(n){transition_out(t.$$.fragment,n),a=!1},d(n){destroy_component(t,n)}}}function create_if_block_16(e){let t,a;return t=new Icons({props:{type:"outline",icon:"save",path:"icons"}}),{c(){create_component(t.$$.fragment)},m(n,o){mount_component(t,n,o),a=!0},i(n){a||(transition_in(t.$$.fragment,n),a=!0)},o(n){transition_out(t.$$.fragment,n),a=!1},d(n){destroy_component(t,n)}}}function create_else_block_3$1(e){let t,a,n,o,l,_,f,s;return{c(){var r,i,u,c,k;t=element("input"),attr(t,"type","text"),attr(t,"id",a=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),t.required=n=e[0].nullable===!1||e[0].required,attr(t,"name",o=e[0].name),attr(t,"placeholder",""),attr(t,"class",l="input input-bordered w-full input-"+(e[7]||"sm")+" "+(["int","integer","float","decimal","real"].indexOf((i=(r=e[0])==null?void 0:r.type)==null?void 0:i.toLowerCase())!==-1&&!e[0].fk?"text-right":"")+" "+(((c=(u=e[6])==null?void 0:u[e[0].name])==null?void 0:c.type)==="error"?" input-error ":"")+" "+((k=e[0])!=null&&k.tous_sep?" decimal-separator ":"")),attr(t,"autocomplete","off"),attr(t,"autocorrect","off"),t.disabled=_=e[0].disabled},m(r,i){insert(r,t,i),set_input_value(t,e[2][e[0].name]),f||(s=[listen(t,"input",e[44]),listen(t,"change",function(){is_function(e[5])&&e[5].apply(this,arguments)})],f=!0)},p(r,i){var u,c,k,m,b;e=r,i[0]&8219&&a!==(a=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`)&&attr(t,"id",a),i[0]&8193&&n!==(n=e[0].nullable===!1||e[0].required)&&(t.required=n),i[0]&8193&&o!==(o=e[0].name)&&attr(t,"name",o),i[0]&8385&&l!==(l="input input-bordered w-full input-"+(e[7]||"sm")+" "+(["int","integer","float","decimal","real"].indexOf((c=(u=e[0])==null?void 0:u.type)==null?void 0:c.toLowerCase())!==-1&&!e[0].fk?"text-right":"")+" "+(((m=(k=e[6])==null?void 0:k[e[0].name])==null?void 0:m.type)==="error"?" input-error ":"")+" "+((b=e[0])!=null&&b.tous_sep?" decimal-separator ":""))&&attr(t,"class",l),i[0]&8193&&_!==(_=e[0].disabled)&&(t.disabled=_),i[0]&8197&&t.value!==e[2][e[0].name]&&set_input_value(t,e[2][e[0].name])},i:noop,o:noop,d(r){r&&detach(t),f=!1,run_all(s)}}}function create_if_block_14(e){let t,a,n,o,l,_,f,s;return{c(){var r,i;t=element("input"),attr(t,"type","password"),attr(t,"id",a=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),t.required=n=e[0].nullable===!1||e[0].required,attr(t,"name",o=e[0].name),attr(t,"placeholder",""),attr(t,"class",l="input input-bordered w-full input-"+(e[7]||"sm")+" "+(((i=(r=e[6])==null?void 0:r[e[0].name])==null?void 0:i.type)==="error"?"input-error":"")),attr(t,"autocomplete","off"),attr(t,"autocorrect","off"),t.disabled=_=e[0].disabled},m(r,i){insert(r,t,i),set_input_value(t,e[2][e[0].name]),f||(s=[listen(t,"input",e[41]),listen(t,"change",e[42]),listen(t,"keyup",e[43])],f=!0)},p(r,i){var u,c;i[0]&8219&&a!==(a=`${r[1]}-${r[4]}-${r[0].name}-${r[3]}`)&&attr(t,"id",a),i[0]&8193&&n!==(n=r[0].nullable===!1||r[0].required)&&(t.required=n),i[0]&8193&&o!==(o=r[0].name)&&attr(t,"name",o),i[0]&8385&&l!==(l="input input-bordered w-full input-"+(r[7]||"sm")+" "+(((c=(u=r[6])==null?void 0:u[r[0].name])==null?void 0:c.type)==="error"?"input-error":""))&&attr(t,"class",l),i[0]&8193&&_!==(_=r[0].disabled)&&(t.disabled=_),i[0]&8197&&t.value!==r[2][r[0].name]&&set_input_value(t,r[2][r[0].name])},i:noop,o:noop,d(r){r&&detach(t),f=!1,run_all(s)}}}function create_if_block_13(e){var $,v;let t,a,n,o,l,_,f,s,r,i,u,c,k,m,b;o=new Icons({props:{type:"outline",icon:"search",path:"icons"}});let g=ensure_array_like(((v=($=e[13])==null?void 0:$[e[0].referred_table])==null?void 0:v.data)||[]),p=[];for(let h=0;h<g.length;h+=1)p[h]=create_each_block$1(get_each_context$1(e,g,h));return{c(){t=element("div"),a=element("button"),n=element("span"),create_component(o.$$.fragment),f=space(),s=element("select");for(let h=0;h<p.length;h+=1)p[h].c();attr(n,"class","w-5 h-5"),attr(a,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),attr(a,"title",l=`${e[19].t("crud.load")} ${e[19].t("crud.ref")}`),a.disabled=_=e[0].disabled,attr(s,"class","grow pl-8 select select-sm select-bordered w-full"),attr(s,"id",r=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),s.required=i=e[0].nullable===!1||e[0].required,attr(s,"name",u=e[0].name),s.disabled=c=e[0].disabled,e[2][e[0].name]===void 0&&add_render_callback(()=>e[39].call(s)),attr(t,"class","flex")},m(h,y){insert(h,t,y),append(t,a),append(a,n),mount_component(o,n,null),append(t,f),append(t,s);for(let z=0;z<p.length;z+=1)p[z]&&p[z].m(s,null);select_option(s,e[2][e[0].name],!0),k=!0,m||(b=[listen(a,"click",e[37]),listen(s,"change",e[39]),listen(s,"change",e[40])],m=!0)},p(h,y){var z,I;if((!k||y[0]&524288&&l!==(l=`${h[19].t("crud.load")} ${h[19].t("crud.ref")}`))&&attr(a,"title",l),(!k||y[0]&8193&&_!==(_=h[0].disabled))&&(a.disabled=_),y[0]&12289){g=ensure_array_like(((I=(z=h[13])==null?void 0:z[h[0].referred_table])==null?void 0:I.data)||[]);let j;for(j=0;j<g.length;j+=1){const E=get_each_context$1(h,g,j);p[j]?p[j].p(E,y):(p[j]=create_each_block$1(E),p[j].c(),p[j].m(s,null))}for(;j<p.length;j+=1)p[j].d(1);p.length=g.length}(!k||y[0]&8219&&r!==(r=`${h[1]}-${h[4]}-${h[0].name}-${h[3]}`))&&attr(s,"id",r),(!k||y[0]&8193&&i!==(i=h[0].nullable===!1||h[0].required))&&(s.required=i),(!k||y[0]&8193&&u!==(u=h[0].name))&&attr(s,"name",u),(!k||y[0]&8193&&c!==(c=h[0].disabled))&&(s.disabled=c),y[0]&8197&&select_option(s,h[2][h[0].name])},i(h){k||(transition_in(o.$$.fragment,h),k=!0)},o(h){transition_out(o.$$.fragment,h),k=!1},d(h){h&&detach(t),destroy_component(o),destroy_each(p,h),m=!1,run_all(b)}}}function create_if_block_10$1(e){let t,a,n,o,l,_=e[0].__code&&create_if_block_12(e);const f=[create_if_block_11,create_else_block_2$1],s=[];function r(i,u){var c,k;return((c=i[0])==null?void 0:c.json_object_editor)===!0&&typeof((k=i[0])==null?void 0:k.json_object)=="object"?0:1}return a=r(e),n=s[a]=f[a](e),{c(){_&&_.c(),t=space(),n.c(),o=empty()},m(i,u){_&&_.m(i,u),insert(i,t,u),s[a].m(i,u),insert(i,o,u),l=!0},p(i,u){i[0].__code?_?_.p(i,u):(_=create_if_block_12(i),_.c(),_.m(t.parentNode,t)):_&&(_.d(1),_=null);let c=a;a=r(i),a===c?s[a].p(i,u):(group_outros(),transition_out(s[c],1,1,()=>{s[c]=null}),check_outros(),n=s[a],n?n.p(i,u):(n=s[a]=f[a](i),n.c()),transition_in(n,1),n.m(o.parentNode,o))},i(i){l||(transition_in(n),l=!0)},o(i){transition_out(n),l=!1},d(i){i&&(detach(t),detach(o)),_&&_.d(i),s[a].d(i)}}}function create_if_block_8$1(e){let t,a,n,o,l,_,f,s,r,i,u,c,k,m;const b=[create_if_block_9$1,create_else_block_1$1],g=[];function p($,v){return v[0]&5&&(a=null),a==null&&(a=!!$[21]($[2][$[0].name])),a?0:1}return n=p(e,[-1,-1]),o=g[n]=b[n](e),{c(){var $,v,h,y;t=element("div"),o.c(),l=space(),_=element("input"),attr(_,"type","text"),attr(_,"id",f=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),_.required=s=e[0].nullable===!1||e[0].required,attr(_,"name",r=e[0].name),attr(_,"placeholder",""),attr(_,"class",i="grow input "+(e[2][e[0].name]?"pl-8":"")+" input-bordered w-full input-"+(e[7]||"sm")+" "+(((v=($=e[6])==null?void 0:$[e[0].name])==null?void 0:v.type)==="error"?"input-error":"")+" "+(((y=e[17])==null?void 0:y[(h=e[0])==null?void 0:h.name])||"")),attr(_,"autocomplete","off"),attr(_,"autocorrect","off"),_.disabled=u=e[0].disabled,attr(t,"class","flex")},m($,v){insert($,t,v),g[n].m(t,null),append(t,l),append(t,_),set_input_value(_,e[2][e[0].name]),c=!0,k||(m=[listen(_,"input",e[35]),listen(_,"change",function(){is_function(e[5])&&e[5].apply(this,arguments)})],k=!0)},p($,v){var y,z,I,j;e=$;let h=n;n=p(e,v),n===h?g[n].p(e,v):(group_outros(),transition_out(g[h],1,1,()=>{g[h]=null}),check_outros(),o=g[n],o?o.p(e,v):(o=g[n]=b[n](e),o.c()),transition_in(o,1),o.m(t,l)),(!c||v[0]&8219&&f!==(f=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`))&&attr(_,"id",f),(!c||v[0]&8193&&s!==(s=e[0].nullable===!1||e[0].required))&&(_.required=s),(!c||v[0]&8193&&r!==(r=e[0].name))&&attr(_,"name",r),(!c||v[0]&139461&&i!==(i="grow input "+(e[2][e[0].name]?"pl-8":"")+" input-bordered w-full input-"+(e[7]||"sm")+" "+(((z=(y=e[6])==null?void 0:y[e[0].name])==null?void 0:z.type)==="error"?"input-error":"")+" "+(((j=e[17])==null?void 0:j[(I=e[0])==null?void 0:I.name])||"")))&&attr(_,"class",i),(!c||v[0]&8193&&u!==(u=e[0].disabled))&&(_.disabled=u),v[0]&8197&&_.value!==e[2][e[0].name]&&set_input_value(_,e[2][e[0].name])},i($){c||(transition_in(o),c=!0)},o($){transition_out(o),c=!1},d($){$&&detach(t),g[n].d(),k=!1,run_all(m)}}}function create_if_block_7$1(e){let t,a,n,o,l,_,f,s,r,i,u,c,k,m,b,g,p,$,v,h,y,z,I,j,E,P;return o=new Icons({props:{type:"outline",icon:"link",path:"icons"}}),p=new Icons({props:{type:"outline",icon:"paper-clip",path:"icons"}}),{c(){var w,C,D,A;t=element("div"),a=element("a"),n=element("span"),create_component(o.$$.fragment),f=space(),s=element("input"),m=space(),b=element("button"),g=element("span"),create_component(p.$$.fragment),h=space(),y=element("input"),attr(n,"class","w-5 h-5"),attr(a,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),attr(a,"title",l=e[19].t("crud.download")),attr(a,"target","_blank"),attr(a,"href",_=`${e[8](!0)}/${e[2][e[0].name]}`),set_style(a,"display",e[2][e[0].name]?null:"none"),attr(s,"type","text"),attr(s,"id",r=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),s.required=i=e[0].nullable===!1||e[0].required,attr(s,"name",u=e[0].name),attr(s,"placeholder",""),attr(s,"class",c="grow input "+(e[2][e[0].name]?"pl-8":"")+" pr-8 input-bordered w-full input-"+(e[7]||"sm")+" "+(((C=(w=e[6])==null?void 0:w[e[0].name])==null?void 0:C.type)==="error"?"input-error":"")+" "+(((A=e[17])==null?void 0:A[(D=e[0])==null?void 0:D.name])||"")),attr(s,"autocomplete","off"),attr(s,"autocorrect","off"),s.disabled=k=e[0].disabled,attr(g,"class","w-5 h-5"),attr(b,"class","btn btn-square btn-ghost btn-sm -ml-8 z-[1]"),attr(b,"title",$=`${e[19].t("crud.attach")} ${e[19].t("crud.file")}`),b.disabled=v=e[0].disabled,attr(y,"type","file"),attr(y,"id",z=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}-file`),y.disabled=I=e[0].disabled,set_style(y,"display","none"),attr(t,"class","flex")},m(w,C){insert(w,t,C),append(t,a),append(a,n),mount_component(o,n,null),append(t,f),append(t,s),set_input_value(s,e[2][e[0].name]),append(t,m),append(t,b),append(b,g),mount_component(p,g,null),append(t,h),append(t,y),j=!0,E||(P=[listen(s,"input",e[28]),listen(s,"change",function(){is_function(e[5])&&e[5].apply(this,arguments)}),listen(s,"drop",e[29]),listen(s,"dragenter",e[30]),listen(s,"paste",e[31]),listen(b,"click",e[32]),listen(y,"change",e[33])],E=!0)},p(w,C){var D,A,K,R;e=w,(!j||C[0]&524288&&l!==(l=e[19].t("crud.download")))&&attr(a,"title",l),(!j||C[0]&8453&&_!==(_=`${e[8](!0)}/${e[2][e[0].name]}`))&&attr(a,"href",_),C[0]&5&&set_style(a,"display",e[2][e[0].name]?null:"none"),(!j||C[0]&8219&&r!==(r=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`))&&attr(s,"id",r),(!j||C[0]&8193&&i!==(i=e[0].nullable===!1||e[0].required))&&(s.required=i),(!j||C[0]&8193&&u!==(u=e[0].name))&&attr(s,"name",u),(!j||C[0]&139461&&c!==(c="grow input "+(e[2][e[0].name]?"pl-8":"")+" pr-8 input-bordered w-full input-"+(e[7]||"sm")+" "+(((A=(D=e[6])==null?void 0:D[e[0].name])==null?void 0:A.type)==="error"?"input-error":"")+" "+(((R=e[17])==null?void 0:R[(K=e[0])==null?void 0:K.name])||"")))&&attr(s,"class",c),(!j||C[0]&8193&&k!==(k=e[0].disabled))&&(s.disabled=k),C[0]&8197&&s.value!==e[2][e[0].name]&&set_input_value(s,e[2][e[0].name]),(!j||C[0]&524288&&$!==($=`${e[19].t("crud.attach")} ${e[19].t("crud.file")}`))&&attr(b,"title",$),(!j||C[0]&8193&&v!==(v=e[0].disabled))&&(b.disabled=v),(!j||C[0]&8219&&z!==(z=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}-file`))&&attr(y,"id",z),(!j||C[0]&8193&&I!==(I=e[0].disabled))&&(y.disabled=I)},i(w){j||(transition_in(o.$$.fragment,w),transition_in(p.$$.fragment,w),j=!0)},o(w){transition_out(o.$$.fragment,w),transition_out(p.$$.fragment,w),j=!1},d(w){w&&detach(t),destroy_component(o),destroy_component(p),E=!1,run_all(P)}}}function create_if_block_6$1(e){var b,g;let t,a,n,o,l,_,f,s,r,i=string_ellipsis(e[0].use_label&&e[0].label?e[0].label:((b=e[0])==null?void 0:b.comment)||((g=e[0])==null?void 0:g.name),e[0].ellipsis||30)+"",u,c,k,m;return{c(){var p,$;t=element("label"),a=element("input"),s=space(),r=element("span"),u=text(i),attr(a,"type","checkbox"),attr(a,"id",n=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),a.required=o=e[0].nullable===!1||e[0].required,attr(a,"name",l=e[0].name),attr(a,"class",_="checkbox checkbox-"+(e[7]||"sm")+" "+((($=(p=e[6])==null?void 0:p[e[0].name])==null?void 0:$.type)==="error"?"checkbox-error":"")+" mr-2"),a.disabled=f=e[0].disabled,attr(r,"class","label-text"),attr(t,"class","cursor-pointer label justify-start"),attr(t,"for",c=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`)},m(p,$){insert(p,t,$),append(t,a),a.checked=e[2][e[0].name],append(t,s),append(t,r),append(r,u),k||(m=listen(a,"change",e[27]),k=!0)},p(p,$){var v,h,y,z;$[0]&8219&&n!==(n=`${p[1]}-${p[4]}-${p[0].name}-${p[3]}`)&&attr(a,"id",n),$[0]&8193&&o!==(o=p[0].nullable===!1||p[0].required)&&(a.required=o),$[0]&8193&&l!==(l=p[0].name)&&attr(a,"name",l),$[0]&8385&&_!==(_="checkbox checkbox-"+(p[7]||"sm")+" "+(((h=(v=p[6])==null?void 0:v[p[0].name])==null?void 0:h.type)==="error"?"checkbox-error":"")+" mr-2")&&attr(a,"class",_),$[0]&8193&&f!==(f=p[0].disabled)&&(a.disabled=f),$[0]&8197&&(a.checked=p[2][p[0].name]),$[0]&1&&i!==(i=string_ellipsis(p[0].use_label&&p[0].label?p[0].label:((y=p[0])==null?void 0:y.comment)||((z=p[0])==null?void 0:z.name),p[0].ellipsis||30)+"")&&set_data(u,i),$[0]&8219&&c!==(c=`${p[1]}-${p[4]}-${p[0].name}-${p[3]}`)&&attr(t,"for",c)},i:noop,o:noop,d(p){p&&detach(t),k=!1,m()}}}function create_if_block_5$1(e){var n;let t=format_number((n=e[2])==null?void 0:n[e[0].name],e[0].tous_sep||",",e[0].dec_places||2)+"",a;return{c(){a=text(t)},m(o,l){insert(o,a,l)},p(o,l){var _;l[0]&5&&t!==(t=format_number((_=o[2])==null?void 0:_[o[0].name],o[0].tous_sep||",",o[0].dec_places||2)+"")&&set_data(a,t)},i:noop,o:noop,d(o){o&&detach(a)}}}function create_if_block_4$1(e){let t,a,n,o,l,_,f,s,r,i,u,c,k,m,b,g;return o=new Icons({props:{type:"outline",icon:"clock",path:"icons"}}),{c(){var p,$;t=element("div"),a=element("button"),n=element("span"),create_component(o.$$.fragment),f=space(),s=element("input"),attr(n,"class","w-5 h-5"),attr(a,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),attr(a,"title",l=`${e[19].t("crud.pick")} ${e[19].t("crud.date")}`),a.disabled=_=e[0].disabled,attr(s,"type","time"),attr(s,"id",r=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),s.required=i=e[0].nullable===!1||e[0].required,attr(s,"name",u=e[0].name),attr(s,"placeholder",""),attr(s,"class",c="grow input pl-8 input-bordered w-full input-"+(e[7]||"sm")+" text-right "+((($=(p=e[6])==null?void 0:p[e[0].name])==null?void 0:$.type)==="error"?"input-error":"")),attr(s,"autocomplete","off"),attr(s,"autocorrect","off"),s.disabled=k=e[0].disabled,attr(t,"class","flex")},m(p,$){insert(p,t,$),append(t,a),append(a,n),mount_component(o,n,null),append(t,f),append(t,s),set_input_value(s,e[2][e[0].name]),m=!0,b||(g=[listen(s,"input",e[26]),listen(s,"change",function(){is_function(e[5])&&e[5].apply(this,arguments)})],b=!0)},p(p,$){var v,h;e=p,(!m||$[0]&524288&&l!==(l=`${e[19].t("crud.pick")} ${e[19].t("crud.date")}`))&&attr(a,"title",l),(!m||$[0]&8193&&_!==(_=e[0].disabled))&&(a.disabled=_),(!m||$[0]&8219&&r!==(r=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`))&&attr(s,"id",r),(!m||$[0]&8193&&i!==(i=e[0].nullable===!1||e[0].required))&&(s.required=i),(!m||$[0]&8193&&u!==(u=e[0].name))&&attr(s,"name",u),(!m||$[0]&8385&&c!==(c="grow input pl-8 input-bordered w-full input-"+(e[7]||"sm")+" text-right "+(((h=(v=e[6])==null?void 0:v[e[0].name])==null?void 0:h.type)==="error"?"input-error":"")))&&attr(s,"class",c),(!m||$[0]&8193&&k!==(k=e[0].disabled))&&(s.disabled=k),$[0]&8197&&set_input_value(s,e[2][e[0].name])},i(p){m||(transition_in(o.$$.fragment,p),m=!0)},o(p){transition_out(o.$$.fragment,p),m=!1},d(p){p&&detach(t),destroy_component(o),b=!1,run_all(g)}}}function create_if_block_3$1(e){let t,a,n,o,l,_,f,s,r,i,u,c,k,m,b,g;return o=new Icons({props:{type:"outline",icon:"calendar",path:"icons"}}),{c(){var p,$;t=element("div"),a=element("button"),n=element("span"),create_component(o.$$.fragment),f=space(),s=element("input"),attr(n,"class","w-5 h-5"),attr(a,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),attr(a,"title",l=`${e[19].t("crud.pick")} ${e[19].t("crud.date")}`),a.disabled=_=e[0].disabled,attr(s,"type","datetime-local"),attr(s,"id",r=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),s.required=i=e[0].nullable===!1||e[0].required,attr(s,"name",u=e[0].name),attr(s,"placeholder",""),attr(s,"class",c="grow input pl-8 input-bordered w-full input-"+(e[7]||"sm")+" text-right "+((($=(p=e[6])==null?void 0:p[e[0].name])==null?void 0:$.type)==="error"?"input-error":"")),attr(s,"autocomplete","off"),attr(s,"autocorrect","off"),s.disabled=k=e[0].disabled,attr(t,"class","flex")},m(p,$){insert(p,t,$),append(t,a),append(a,n),mount_component(o,n,null),append(t,f),append(t,s),set_input_value(s,e[2][e[0].name]),m=!0,b||(g=[listen(s,"input",e[25]),listen(s,"change",function(){is_function(e[5])&&e[5].apply(this,arguments)})],b=!0)},p(p,$){var v,h;e=p,(!m||$[0]&524288&&l!==(l=`${e[19].t("crud.pick")} ${e[19].t("crud.date")}`))&&attr(a,"title",l),(!m||$[0]&8193&&_!==(_=e[0].disabled))&&(a.disabled=_),(!m||$[0]&8219&&r!==(r=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`))&&attr(s,"id",r),(!m||$[0]&8193&&i!==(i=e[0].nullable===!1||e[0].required))&&(s.required=i),(!m||$[0]&8193&&u!==(u=e[0].name))&&attr(s,"name",u),(!m||$[0]&8385&&c!==(c="grow input pl-8 input-bordered w-full input-"+(e[7]||"sm")+" text-right "+(((h=(v=e[6])==null?void 0:v[e[0].name])==null?void 0:h.type)==="error"?"input-error":"")))&&attr(s,"class",c),(!m||$[0]&8193&&k!==(k=e[0].disabled))&&(s.disabled=k),$[0]&8197&&set_input_value(s,e[2][e[0].name])},i(p){m||(transition_in(o.$$.fragment,p),m=!0)},o(p){transition_out(o.$$.fragment,p),m=!1},d(p){p&&detach(t),destroy_component(o),b=!1,run_all(g)}}}function create_if_block_1$1(e){let t,a,n,o,l,_,f,s;o=new Icons({props:{type:"outline",icon:"calendar",path:"icons"}});function r(c,k){var m;return((m=c[0])==null?void 0:m.date_type)==="month"?create_if_block_2$1:create_else_block$1}let i=r(e),u=i(e);return{c(){t=element("div"),a=element("button"),n=element("span"),create_component(o.$$.fragment),f=space(),u.c(),attr(n,"class","w-5 h-5"),attr(a,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),attr(a,"title",l=`${e[19].t("crud.pick")} ${e[19].t("crud.date")}`),a.disabled=_=e[0].disabled,attr(t,"class","flex")},m(c,k){insert(c,t,k),append(t,a),append(a,n),mount_component(o,n,null),append(t,f),u.m(t,null),s=!0},p(c,k){(!s||k[0]&524288&&l!==(l=`${c[19].t("crud.pick")} ${c[19].t("crud.date")}`))&&attr(a,"title",l),(!s||k[0]&8193&&_!==(_=c[0].disabled))&&(a.disabled=_),i===(i=r(c))&&u?u.p(c,k):(u.d(1),u=i(c),u&&(u.c(),u.m(t,null)))},i(c){s||(transition_in(o.$$.fragment,c),s=!0)},o(c){transition_out(o.$$.fragment,c),s=!1},d(c){c&&detach(t),destroy_component(o),u.d()}}}function create_each_block$1(e){var r;let t,a=((r=e[45])==null?void 0:r[e[0].name])+"",n,o,l,_,f;function s(...i){return e[38](e[45],...i)}return{c(){var i;t=element("option"),n=text(a),o=space(),t.__value=l=(i=e[45])==null?void 0:i[e[0].name],set_input_value(t,t.__value),attr(t,"class","cursor-pointer")},m(i,u){insert(i,t,u),append(t,n),append(t,o),_||(f=listen(t,"click",s),_=!0)},p(i,u){var c,k;e=i,u[0]&8193&&a!==(a=((c=e[45])==null?void 0:c[e[0].name])+"")&&set_data(n,a),u[0]&8193&&l!==(l=(k=e[45])==null?void 0:k[e[0].name])&&(t.__value=l,set_input_value(t,t.__value))},d(i){i&&detach(t),_=!1,f()}}}function create_if_block_12(e){let t,a;return{c(){t=element("div"),attr(t,"id",a=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}-target`),attr(t,"contenteditable","true")},m(n,o){insert(n,t,o)},p(n,o){o[0]&8219&&a!==(a=`${n[1]}-${n[4]}-${n[0].name}-${n[3]}-target`)&&attr(t,"id",a)},d(n){n&&detach(t)}}}function create_else_block_2$1(e){let t,a,n,o,l,_,f,s,r;return{c(){var i,u;t=element("textarea"),attr(t,"id",a=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),t.required=n=e[0].nullable===!1||e[0].required,attr(t,"name",o=e[0].name),attr(t,"class",l="textarea textarea-bordered w-full textarea-xs "+(((u=(i=e[6])==null?void 0:i[e[0].name])==null?void 0:u.type)==="error"?"textarea-error":"")),attr(t,"autocomplete","off"),attr(t,"autocorrect","off"),attr(t,"rows",_=e[0].n_rows||1),t.disabled=f=e[0].disabled},m(i,u){insert(i,t,u),set_input_value(t,e[2][e[0].name]),s||(r=[listen(t,"input",e[36]),listen(t,"change",function(){is_function(e[5])&&e[5].apply(this,arguments)})],s=!0)},p(i,u){var c,k;e=i,u[0]&8219&&a!==(a=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`)&&attr(t,"id",a),u[0]&8193&&n!==(n=e[0].nullable===!1||e[0].required)&&(t.required=n),u[0]&8193&&o!==(o=e[0].name)&&attr(t,"name",o),u[0]&8257&&l!==(l="textarea textarea-bordered w-full textarea-xs "+(((k=(c=e[6])==null?void 0:c[e[0].name])==null?void 0:k.type)==="error"?"textarea-error":""))&&attr(t,"class",l),u[0]&8193&&_!==(_=e[0].n_rows||1)&&attr(t,"rows",_),u[0]&8193&&f!==(f=e[0].disabled)&&(t.disabled=f),u[0]&8197&&set_input_value(t,e[2][e[0].name])},i:noop,o:noop,d(i){i&&detach(t),s=!1,run_all(r)}}}function create_if_block_11(e){let t,a;return t=new ObjectEditor({props:{indent:0,obj:e[0].json_object,spkip:["open"],chain:""}}),{c(){create_component(t.$$.fragment)},m(n,o){mount_component(t,n,o),a=!0},p(n,o){const l={};o[0]&1&&(l.obj=n[0].json_object),t.$set(l)},i(n){a||(transition_in(t.$$.fragment,n),a=!0)},o(n){transition_out(t.$$.fragment,n),a=!1},d(n){destroy_component(t,n)}}}function create_else_block_1$1(e){let t,a,n,o,l,_;return n=new Icons({props:{type:"outline",icon:"link",path:"icons"}}),{c(){t=element("a"),a=element("span"),create_component(n.$$.fragment),attr(a,"class","w-5 h-5"),attr(t,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),attr(t,"title",o=e[19].t("crud.open")),attr(t,"target","_blank"),attr(t,"href",l=`${e[2][e[0].name]}`),set_style(t,"display",e[2][e[0].name]?null:"none")},m(f,s){insert(f,t,s),append(t,a),mount_component(n,a,null),_=!0},p(f,s){(!_||s[0]&524288&&o!==(o=f[19].t("crud.open")))&&attr(t,"title",o),(!_||s[0]&8197&&l!==(l=`${f[2][f[0].name]}`))&&attr(t,"href",l),s[0]&5&&set_style(t,"display",f[2][f[0].name]?null:"none")},i(f){_||(transition_in(n.$$.fragment,f),_=!0)},o(f){transition_out(n.$$.fragment,f),_=!1},d(f){f&&detach(t),destroy_component(n)}}}function create_if_block_9$1(e){let t,a,n,o,l,_,f,s;return n=new Icons({props:{type:"outline",icon:"link",path:"icons"}}),{c(){var r;t=element("button"),a=element("span"),create_component(n.$$.fragment),attr(a,"class","w-5 h-5"),attr(t,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),attr(t,"title",o=e[19].t("crud.download")),t.disabled=l=(r=e[0])==null?void 0:r.disabled,set_style(t,"display",e[2][e[0].name]?null:"none")},m(r,i){insert(r,t,i),append(t,a),mount_component(n,a,null),_=!0,f||(s=listen(t,"click",e[34]),f=!0)},p(r,i){var u;(!_||i[0]&524288&&o!==(o=r[19].t("crud.download")))&&attr(t,"title",o),(!_||i[0]&8193&&l!==(l=(u=r[0])==null?void 0:u.disabled))&&(t.disabled=l),i[0]&5&&set_style(t,"display",r[2][r[0].name]?null:"none")},i(r){_||(transition_in(n.$$.fragment,r),_=!0)},o(r){transition_out(n.$$.fragment,r),_=!1},d(r){r&&detach(t),destroy_component(n),f=!1,s()}}}function create_else_block$1(e){let t,a,n,o,l,_,f,s;return{c(){var r,i;t=element("input"),attr(t,"type","date"),attr(t,"id",a=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),t.required=n=e[0].nullable===!1||e[0].required,attr(t,"name",o=e[0].name),attr(t,"placeholder",""),attr(t,"class",l="grow input pl-8 input-bordered w-full input-"+(e[7]||"sm")+" text-right "+(((i=(r=e[6])==null?void 0:r[e[0].name])==null?void 0:i.type)==="error"?"input-error":"")),attr(t,"autocomplete","off"),t.disabled=_=e[0].disabled},m(r,i){insert(r,t,i),set_input_value(t,e[2][e[0].name]),f||(s=[listen(t,"input",e[24]),listen(t,"change",function(){is_function(e[5])&&e[5].apply(this,arguments)})],f=!0)},p(r,i){var u,c;e=r,i[0]&8219&&a!==(a=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`)&&attr(t,"id",a),i[0]&8193&&n!==(n=e[0].nullable===!1||e[0].required)&&(t.required=n),i[0]&8193&&o!==(o=e[0].name)&&attr(t,"name",o),i[0]&8385&&l!==(l="grow input pl-8 input-bordered w-full input-"+(e[7]||"sm")+" text-right "+(((c=(u=e[6])==null?void 0:u[e[0].name])==null?void 0:c.type)==="error"?"input-error":""))&&attr(t,"class",l),i[0]&8193&&_!==(_=e[0].disabled)&&(t.disabled=_),i[0]&8197&&set_input_value(t,e[2][e[0].name])},d(r){r&&detach(t),f=!1,run_all(s)}}}function create_if_block_2$1(e){let t,a,n,o,l,_,f,s;return{c(){var r,i;t=element("input"),attr(t,"type","month"),attr(t,"id",a=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),t.required=n=e[0].nullable===!1||e[0].required,attr(t,"name",o=e[0].name),attr(t,"placeholder",""),attr(t,"class",l="grow input pl-8 input-bordered w-full input-"+(e[7]||"sm")+" text-right "+(((i=(r=e[6])==null?void 0:r[e[0].name])==null?void 0:i.type)==="error"?"input-error":"")),attr(t,"autocomplete","off"),t.disabled=_=e[0].disabled},m(r,i){insert(r,t,i),set_input_value(t,e[2][e[0].name]),f||(s=[listen(t,"input",e[23]),listen(t,"change",function(){is_function(e[5])&&e[5].apply(this,arguments)})],f=!0)},p(r,i){var u,c;e=r,i[0]&8219&&a!==(a=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`)&&attr(t,"id",a),i[0]&8193&&n!==(n=e[0].nullable===!1||e[0].required)&&(t.required=n),i[0]&8193&&o!==(o=e[0].name)&&attr(t,"name",o),i[0]&8385&&l!==(l="grow input pl-8 input-bordered w-full input-"+(e[7]||"sm")+" text-right "+(((c=(u=e[6])==null?void 0:u[e[0].name])==null?void 0:c.type)==="error"?"input-error":""))&&attr(t,"class",l),i[0]&8193&&_!==(_=e[0].disabled)&&(t.disabled=_),i[0]&8197&&set_input_value(t,e[2][e[0].name])},d(r){r&&detach(t),f=!1,run_all(s)}}}function create_if_block$1(e){var l,_;let t,a,n=((_=(l=e[6])==null?void 0:l[e[0].name])==null?void 0:_.msg)+"",o;return{c(){t=element("label"),a=element("span"),o=text(n),attr(a,"class","label-text-alt text-error"),attr(t,"class","label"),attr(t,"for","nothing")},m(f,s){insert(f,t,s),append(t,a),append(a,o)},p(f,s){var r,i;s[0]&65&&n!==(n=((i=(r=f[6])==null?void 0:r[f[0].name])==null?void 0:i.msg)+"")&&set_data(o,n)},d(f){f&&detach(t)}}}function create_fragment$1(e){var A,K,R,J,V;let t,a,n,o=string_ellipsis(e[0].use_label&&e[0].label?e[0].label:((A=e[0])==null?void 0:A.comment)||((K=e[0])==null?void 0:K.name),e[0].ellipsis||30)+"",l,_,f,s,r,i,u,c,k,m,b,g,p,$,v,h,y,z,I,j,E=((R=e[0])==null?void 0:R.code)==="json"&&create_if_block_15(e);const P=[create_if_block_1$1,create_if_block_3$1,create_if_block_4$1,create_if_block_5$1,create_if_block_6$1,create_if_block_7$1,create_if_block_8$1,create_if_block_10$1,create_if_block_13,create_if_block_14,create_else_block_3$1],w=[];function C(q,N){var F,B;return N[0]&1&&(u=null),N[0]&1&&(c=null),N[0]&1&&(k=null),N[0]&1&&(m=null),N[0]&1&&(b=null),N[0]&1&&(g=null),N[0]&1&&(p=null),N[0]&1&&($=null),u==null&&(u=!!["date"].includes(q[0].type.toLowerCase())),u?0:(c==null&&(c=!!["datetime"].includes(q[0].type.toLowerCase())),c?1:(k==null&&(k=!!["time"].includes(q[0].type.toLowerCase())),k?2:q[0].number2&&q[0].tous_sep2?3:(m==null&&(m=!!["bol","boolean"].includes(q[0].type.toLowerCase())),m?4:(b==null&&(b=!!(q[0].att||q[0].name.toLowerCase().substring(0,7)==="attach_")),b?5:(g==null&&(g=!!(q[0].link||q[0].name.toLowerCase().substring(0,5)==="link_")),g?6:(p==null&&(p=!!(q[0].long_text&&["text","longtext"].indexOf((B=(F=q[0])==null?void 0:F.type)==null?void 0:B.toLowerCase())!==-1)),p?7:q[0].autocomplete||q[0].fk===!0?8:($==null&&($=!!(q[0].password||["password","pass"].indexOf(q[0].name.toLowerCase())!==-1)),$?9:10)))))))}v=C(e,[-1,-1]),h=w[v]=P[v](e);let D=((V=(J=e[6])==null?void 0:J[e[0].name])==null?void 0:V.msg)&&create_if_block$1(e);return{c(){var q,N,F,B,T;t=element("div"),a=element("label"),n=element("span"),l=text(o),f=space(),E&&E.c(),i=space(),h.c(),y=space(),D&&D.c(),attr(n,"class","label-text grow"),attr(n,"title",_=string_ellipsis_title(e[0].use_label&&e[0].label?e[0].label:((q=e[0])==null?void 0:q.comment)||((N=e[0])==null?void 0:N.name),e[0].ellipsis||30)),attr(a,"class",s="label flex flex-row "+(["int","integer","float","decimal","real","date","datetime","time"].indexOf((B=(F=e[0])==null?void 0:F.type)==null?void 0:B.toLowerCase())!==-1&&!e[0].fk?"text-right":"")),attr(a,"for",r=`${e[1]}-${e[4]}-${e[0].name}-${e[3]}`),set_style(a,"display",["bol","boolean","tinyint"].includes(e[0].type.toLowerCase())?"none":null),attr(t,"class",z="form-control "+(e[0].size===12?`w-[${((e[0].size||12)/12*100).toFixed(0)}%]`:`w-${e[0].size||11}/12`)+" "+(["bol","boolean"].includes(e[0].type.toLowerCase())?"justify-end":"")+" flex-none p-1 ---m-auto"),attr(t,"lang",I=(T=e[18])==null?void 0:T.lang)},m(q,N){insert(q,t,N),append(t,a),append(a,n),append(n,l),append(a,f),E&&E.m(a,null),append(t,i),w[v].m(t,null),append(t,y),D&&D.m(t,null),j=!0},p(q,N){var B,T,Q,Z,X,H,S,G,Y,ee;(!j||N[0]&1)&&o!==(o=string_ellipsis(q[0].use_label&&q[0].label?q[0].label:((B=q[0])==null?void 0:B.comment)||((T=q[0])==null?void 0:T.name),q[0].ellipsis||30)+"")&&set_data(l,o),(!j||N[0]&8193&&_!==(_=string_ellipsis_title(q[0].use_label&&q[0].label?q[0].label:((Q=q[0])==null?void 0:Q.comment)||((Z=q[0])==null?void 0:Z.name),q[0].ellipsis||30)))&&attr(n,"title",_),((X=q[0])==null?void 0:X.code)==="json"?E?(E.p(q,N),N[0]&1&&transition_in(E,1)):(E=create_if_block_15(q),E.c(),transition_in(E,1),E.m(a,null)):E&&(group_outros(),transition_out(E,1,1,()=>{E=null}),check_outros()),(!j||N[0]&8193&&s!==(s="label flex flex-row "+(["int","integer","float","decimal","real","date","datetime","time"].indexOf((S=(H=q[0])==null?void 0:H.type)==null?void 0:S.toLowerCase())!==-1&&!q[0].fk?"text-right":"")))&&attr(a,"class",s),(!j||N[0]&8219&&r!==(r=`${q[1]}-${q[4]}-${q[0].name}-${q[3]}`))&&attr(a,"for",r),N[0]&1&&set_style(a,"display",["bol","boolean","tinyint"].includes(q[0].type.toLowerCase())?"none":null);let F=v;v=C(q,N),v===F?w[v].p(q,N):(group_outros(),transition_out(w[F],1,1,()=>{w[F]=null}),check_outros(),h=w[v],h?h.p(q,N):(h=w[v]=P[v](q),h.c()),transition_in(h,1),h.m(t,y)),(Y=(G=q[6])==null?void 0:G[q[0].name])!=null&&Y.msg?D?D.p(q,N):(D=create_if_block$1(q),D.c(),D.m(t,null)):D&&(D.d(1),D=null),(!j||N[0]&8193&&z!==(z="form-control "+(q[0].size===12?`w-[${((q[0].size||12)/12*100).toFixed(0)}%]`:`w-${q[0].size||11}/12`)+" "+(["bol","boolean"].includes(q[0].type.toLowerCase())?"justify-end":"")+" flex-none p-1 ---m-auto"))&&attr(t,"class",z),(!j||N[0]&262144&&I!==(I=(ee=q[18])==null?void 0:ee.lang))&&attr(t,"lang",I)},i(q){j||(transition_in(E),transition_in(h),j=!0)},o(q){transition_out(E),transition_out(h),j=!1},d(q){q&&detach(t),E&&E.d(),w[v].d(),D&&D.d()}}}function instance$1(e,t,a){let n,o;component_subscribe(e,_global,O=>a(18,n=O)),component_subscribe(e,i18n,O=>a(19,o=O));let{field:l={}}=t,{key:_=""}=t,{j:f}=t,{table:s}=t,{data:r}=t,{input_change:i}=t,{form_valid:u={}}=t,{input_size:c="sm"}=t,{get_upload_api:k}=t,{select_file:m}=t,{file_upload:b}=t,{load_fk_table:g}=t,{add_extra_fk_fields:p}=t,{fk_data:$={}}=t,{validate_pass:v}=t,{drop_file_handler:h}=t,{paste_file_handler:y}=t;const z={};onMount(()=>{var O;l.long_text&&["text","longtext"].indexOf((O=l==null?void 0:l.type)==null?void 0:O.toLowerCase())!==-1&&l.__code&&(console.log({field:l}),setTimeout(()=>{},1e3))});const I=O=>{try{openFolder(O)}catch(U){console.log(O,U)}},j=O=>{const U=/^\\\\[a-zA-Z0-9._-]+\\[a-zA-Z0-9._-]+/;return console.log(O,U,U.test(O)),U.test(O)},E=()=>{if(!(l!=null&&l.json_object_editor)&&(r!=null&&r[l==null?void 0:l.name])){a(0,l.json_object_editor=!0,l);try{a(0,l.json_object=JSON.parse(r==null?void 0:r[l==null?void 0:l.name]),l),l.json_object.open&&delete l.json_object.open;for(let O=0;O<l.json_object.length;O++)l.json_object[O].open&&delete l.json_object[O].open}catch(O){console.log(O.message)}}else if(l.json_object_editor===!0)try{a(2,r[l==null?void 0:l.name]=JSON.stringify(l.json_object,null,2),r),a(0,l.json_object_editor=!1,l)}catch(O){console.log(O.message)}};function P(){r[l.name]=this.value,a(2,r),a(13,$),a(0,l)}function w(){r[l.name]=this.value,a(2,r),a(13,$),a(0,l)}function C(){r[l.name]=this.value,a(2,r),a(13,$),a(0,l)}function D(){r[l.name]=this.value,a(2,r),a(13,$),a(0,l)}function A(){r[l.name]=this.checked,a(2,r),a(13,$),a(0,l)}function K(){r[l.name]=this.value,a(2,r),a(13,$),a(0,l)}const R=O=>{h(O,l),delete z[l.name]},J=O=>{console.log("DRAG ENTER DO THE STYLING"),a(17,z[l.name]="input-primary input-lg",z)},V=O=>{y(O,l)},q=O=>m({field:l,id:`${_}-${s}-${l.name}-${f}-file`}),N=O=>b({event:O,field:l}),F=()=>I(r[l.name]);function B(){r[l.name]=this.value,a(2,r),a(13,$),a(0,l)}function T(){r[l.name]=this.value,a(2,r),a(13,$),a(0,l)}const Q=O=>g(lodashExports.cloneDeep({field:l,data:r})),Z=(O,U)=>p({field:l,data:O});function X(){r[l.name]=select_value(this),a(2,r),a(13,$),a(0,l)}const H=O=>{var U,le;return p({field:l,data:(le=(U=$==null?void 0:$[l.referred_table])==null?void 0:U.data.filter(te=>(te==null?void 0:te[l.name])==r[l.name]))==null?void 0:le[0]})};function S(){r[l.name]=this.value,a(2,r),a(13,$),a(0,l)}const G=O=>{i(O)},Y=O=>{v(O)};function ee(){r[l.name]=this.value,a(2,r),a(13,$),a(0,l)}return e.$$set=O=>{"field"in O&&a(0,l=O.field),"key"in O&&a(1,_=O.key),"j"in O&&a(3,f=O.j),"table"in O&&a(4,s=O.table),"data"in O&&a(2,r=O.data),"input_change"in O&&a(5,i=O.input_change),"form_valid"in O&&a(6,u=O.form_valid),"input_size"in O&&a(7,c=O.input_size),"get_upload_api"in O&&a(8,k=O.get_upload_api),"select_file"in O&&a(9,m=O.select_file),"file_upload"in O&&a(10,b=O.file_upload),"load_fk_table"in O&&a(11,g=O.load_fk_table),"add_extra_fk_fields"in O&&a(12,p=O.add_extra_fk_fields),"fk_data"in O&&a(13,$=O.fk_data),"validate_pass"in O&&a(14,v=O.validate_pass),"drop_file_handler"in O&&a(15,h=O.drop_file_handler),"paste_file_handler"in O&&a(16,y=O.paste_file_handler)},[l,_,r,f,s,i,u,c,k,m,b,g,p,$,v,h,y,z,n,o,I,j,E,P,w,C,D,A,K,R,J,V,q,N,F,B,T,Q,Z,X,H,S,G,Y,ee]}class GoblaFormField extends SvelteComponent{constructor(t){super(),init(this,t,instance$1,create_fragment$1,safe_not_equal,{field:0,key:1,j:3,table:4,data:2,input_change:5,form_valid:6,input_size:7,get_upload_api:8,select_file:9,file_upload:10,load_fk_table:11,add_extra_fk_fields:12,fk_data:13,validate_pass:14,drop_file_handler:15,paste_file_handler:16},null,[-1,-1])}}function get_each_context(e,t,a){const n=e.slice();return n[61]=t[a],n[63]=a,n}function get_each_context_1(e,t,a){const n=e.slice();return n[61]=t[a],n[63]=a,n}function get_each_context_11(e,t,a){const n=e.slice();return n[67]=t[a],n[69]=a,n}function get_each_context_8(e,t,a){const n=e.slice();return n[65]=t[a],n[63]=a,n}function get_each_context_9(e,t,a){const n=e.slice();return n[67]=t[a],n[69]=a,n}function get_each_context_10(e,t,a){const n=e.slice();return n[65]=t[a],n[63]=a,n}function get_each_context_5(e,t,a){const n=e.slice();return n[65]=t[a],n[63]=a,n}function get_each_context_6(e,t,a){const n=e.slice();return n[67]=t[a],n[69]=a,n}function get_each_context_7(e,t,a){const n=e.slice();return n[65]=t[a],n[63]=a,n}function get_each_context_2(e,t,a){const n=e.slice();return n[65]=t[a],n[63]=a,n}function get_each_context_3(e,t,a){const n=e.slice();return n[67]=t[a],n[69]=a,n}function get_each_context_4(e,t,a){const n=e.slice();return n[65]=t[a],n[63]=a,n}function create_else_block_3(e){var _,f;let t,a,n=ensure_array_like(e[20](lodashExports.cloneDeep((f=(_=e[16])==null?void 0:_.tables)==null?void 0:f[e[2]])||{},e[14]||{},null)),o=[];for(let s=0;s<n.length;s+=1)o[s]=create_each_block_11(get_each_context_11(e,n,s));const l=s=>transition_out(o[s],1,1,()=>{o[s]=null});return{c(){for(let s=0;s<o.length;s+=1)o[s].c();t=empty()},m(s,r){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(s,r);insert(s,t,r),a=!0},p(s,r){var i,u;if(r[0]&1037387277|r[1]&14){n=ensure_array_like(s[20](lodashExports.cloneDeep((u=(i=s[16])==null?void 0:i.tables)==null?void 0:u[s[2]])||{},s[14]||{},null));let c;for(c=0;c<n.length;c+=1){const k=get_each_context_11(s,n,c);o[c]?(o[c].p(k,r),transition_in(o[c],1)):(o[c]=create_each_block_11(k),o[c].c(),transition_in(o[c],1),o[c].m(t.parentNode,t))}for(group_outros(),c=n.length;c<o.length;c+=1)l(c);check_outros()}},i(s){if(!a){for(let r=0;r<n.length;r+=1)transition_in(o[r]);a=!0}},o(s){o=o.filter(Boolean);for(let r=0;r<o.length;r+=1)transition_out(o[r]);a=!1},d(s){s&&detach(t),destroy_each(o,s)}}}function create_if_block_8(e){var i,u,c,k;let t,a,n,o,l=ensure_array_like((u=(i=e[14])==null?void 0:i.layout)==null?void 0:u.tabs_steps_conf),_=[];for(let m=0;m<l.length;m+=1)_[m]=create_each_block_10(get_each_context_10(e,l,m));let f=ensure_array_like((k=(c=e[14])==null?void 0:c.layout)==null?void 0:k.tabs_steps_conf),s=[];for(let m=0;m<f.length;m+=1)s[m]=create_each_block_8(get_each_context_8(e,f,m));const r=m=>transition_out(s[m],1,1,()=>{s[m]=null});return{c(){t=element("div"),a=element("ul");for(let m=0;m<_.length;m+=1)_[m].c();n=space();for(let m=0;m<s.length;m+=1)s[m].c();attr(a,"class","steps steps-vertical overflow-hidden flex-nowrap flex-grow mr-2 w-60"),attr(t,"class","flex flex-row flex-nowrap")},m(m,b){insert(m,t,b),append(t,a);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(a,null);append(t,n);for(let g=0;g<s.length;g+=1)s[g]&&s[g].m(t,null);o=!0},p(m,b){var g,p,$,v;if(b[0]&16640){l=ensure_array_like((p=(g=m[14])==null?void 0:g.layout)==null?void 0:p.tabs_steps_conf);let h;for(h=0;h<l.length;h+=1){const y=get_each_context_10(m,l,h);_[h]?_[h].p(y,b):(_[h]=create_each_block_10(y),_[h].c(),_[h].m(a,null))}for(;h<_.length;h+=1)_[h].d(1);_.length=l.length}if(b[0]&1037387533|b[1]&14){f=ensure_array_like((v=($=m[14])==null?void 0:$.layout)==null?void 0:v.tabs_steps_conf);let h;for(h=0;h<f.length;h+=1){const y=get_each_context_8(m,f,h);s[h]?(s[h].p(y,b),transition_in(s[h],1)):(s[h]=create_each_block_8(y),s[h].c(),transition_in(s[h],1),s[h].m(t,null))}for(group_outros(),h=f.length;h<s.length;h+=1)r(h);check_outros()}},i(m){if(!o){for(let b=0;b<f.length;b+=1)transition_in(s[b]);o=!0}},o(m){s=s.filter(Boolean);for(let b=0;b<s.length;b+=1)transition_out(s[b]);o=!1},d(m){m&&detach(t),destroy_each(_,m),destroy_each(s,m)}}}function create_if_block_6(e){var i,u,c,k;let t,a,n,o,l=ensure_array_like((u=(i=e[14])==null?void 0:i.layout)==null?void 0:u.tabs_steps_conf),_=[];for(let m=0;m<l.length;m+=1)_[m]=create_each_block_7(get_each_context_7(e,l,m));let f=ensure_array_like((k=(c=e[14])==null?void 0:c.layout)==null?void 0:k.tabs_steps_conf),s=[];for(let m=0;m<f.length;m+=1)s[m]=create_each_block_5(get_each_context_5(e,f,m));const r=m=>transition_out(s[m],1,1,()=>{s[m]=null});return{c(){t=element("ul");for(let m=0;m<_.length;m+=1)_[m].c();a=space();for(let m=0;m<s.length;m+=1)s[m].c();n=empty(),attr(t,"class","steps w-full")},m(m,b){insert(m,t,b);for(let g=0;g<_.length;g+=1)_[g]&&_[g].m(t,null);insert(m,a,b);for(let g=0;g<s.length;g+=1)s[g]&&s[g].m(m,b);insert(m,n,b),o=!0},p(m,b){var g,p,$,v;if(b[0]&16640){l=ensure_array_like((p=(g=m[14])==null?void 0:g.layout)==null?void 0:p.tabs_steps_conf);let h;for(h=0;h<l.length;h+=1){const y=get_each_context_7(m,l,h);_[h]?_[h].p(y,b):(_[h]=create_each_block_7(y),_[h].c(),_[h].m(t,null))}for(;h<_.length;h+=1)_[h].d(1);_.length=l.length}if(b[0]&1037387533|b[1]&14){f=ensure_array_like((v=($=m[14])==null?void 0:$.layout)==null?void 0:v.tabs_steps_conf);let h;for(h=0;h<f.length;h+=1){const y=get_each_context_5(m,f,h);s[h]?(s[h].p(y,b),transition_in(s[h],1)):(s[h]=create_each_block_5(y),s[h].c(),transition_in(s[h],1),s[h].m(n.parentNode,n))}for(group_outros(),h=f.length;h<s.length;h+=1)r(h);check_outros()}},i(m){if(!o){for(let b=0;b<f.length;b+=1)transition_in(s[b]);o=!0}},o(m){s=s.filter(Boolean);for(let b=0;b<s.length;b+=1)transition_out(s[b]);o=!1},d(m){m&&(detach(t),detach(a),detach(n)),destroy_each(_,m),destroy_each(s,m)}}}function create_if_block_4(e){var c,k,m,b;let t,a,n,o,l,_,f=ensure_array_like((k=(c=e[14])==null?void 0:c.layout)==null?void 0:k.tabs_steps_conf),s=[];for(let g=0;g<f.length;g+=1)s[g]=create_each_block_4(get_each_context_4(e,f,g));let r=ensure_array_like((b=(m=e[14])==null?void 0:m.layout)==null?void 0:b.tabs_steps_conf),i=[];for(let g=0;g<r.length;g+=1)i[g]=create_each_block_2(get_each_context_2(e,r,g));const u=g=>transition_out(i[g],1,1,()=>{i[g]=null});return{c(){t=element("div");for(let g=0;g<s.length;g+=1)s[g].c();a=space(),n=element("a"),n.innerHTML="<b></b>",o=space();for(let g=0;g<i.length;g+=1)i[g].c();l=empty(),attr(n,"role","tab"),attr(n,"class","tab text-md grow"),attr(t,"role","tablist"),attr(t,"class","tabs tabs-lifted w-full flex")},m(g,p){insert(g,t,p);for(let $=0;$<s.length;$+=1)s[$]&&s[$].m(t,null);append(t,a),append(t,n),insert(g,o,p);for(let $=0;$<i.length;$+=1)i[$]&&i[$].m(g,p);insert(g,l,p),_=!0},p(g,p){var $,v,h,y;if(p[0]&16640){f=ensure_array_like((v=($=g[14])==null?void 0:$.layout)==null?void 0:v.tabs_steps_conf);let z;for(z=0;z<f.length;z+=1){const I=get_each_context_4(g,f,z);s[z]?s[z].p(I,p):(s[z]=create_each_block_4(I),s[z].c(),s[z].m(t,a))}for(;z<s.length;z+=1)s[z].d(1);s.length=f.length}if(p[0]&1037387533|p[1]&14){r=ensure_array_like((y=(h=g[14])==null?void 0:h.layout)==null?void 0:y.tabs_steps_conf);let z;for(z=0;z<r.length;z+=1){const I=get_each_context_2(g,r,z);i[z]?(i[z].p(I,p),transition_in(i[z],1)):(i[z]=create_each_block_2(I),i[z].c(),transition_in(i[z],1),i[z].m(l.parentNode,l))}for(group_outros(),z=r.length;z<i.length;z+=1)u(z);check_outros()}},i(g){if(!_){for(let p=0;p<r.length;p+=1)transition_in(i[p]);_=!0}},o(g){i=i.filter(Boolean);for(let p=0;p<i.length;p+=1)transition_out(i[p]);_=!1},d(g){g&&(detach(t),detach(o),detach(l)),destroy_each(s,g),destroy_each(i,g)}}}function create_else_block_4(e){let t,a;const n=[{field:e[67],key:e[18],j:e[69],table:e[2],data:e[0],form_valid:e[10],input_size:e[3],fk_data:e[9],input_change:e[26],get_upload_api:e[23],select_file:e[22],file_upload:e[24],load_fk_table:e[29],add_extra_fk_fields:e[28],validate_pass:e[27],drop_file_handler:e[32],paste_file_handler:e[33]}];let o={};for(let l=0;l<n.length;l+=1)o=assign(o,n[l]);return t=new GoblaFormField({props:o}),{c(){create_component(t.$$.fragment)},m(l,_){mount_component(t,l,_),a=!0},p(l,_){const f=_[0]&1037387277|_[1]&6?get_spread_update(n,[{field:l[67],key:l[18],j:l[69],table:l[2],data:l[0],form_valid:l[10],input_size:l[3],fk_data:l[9],input_change:l[26],get_upload_api:l[23],select_file:l[22],file_upload:l[24],load_fk_table:l[29],add_extra_fk_fields:l[28],validate_pass:l[27],drop_file_handler:l[32],paste_file_handler:l[33]}]):{};t.$set(f)},i(l){a||(transition_in(t.$$.fragment,l),a=!0)},o(l){transition_out(t.$$.fragment,l),a=!1},d(l){destroy_component(t,l)}}}function create_if_block_10(e){return{c:noop,m:noop,p:noop,i:noop,o:noop,d:noop}}function create_each_block_11(e){let t,a,n,o,l;const _=[create_if_block_10,create_else_block_4],f=[];function s(r,i){var u;return i[0]&81925&&(t=null),t==null&&(t=!!r[34](((u=r[67])==null?void 0:u.hide_cond)||"false",r[0],r[67])),t?0:1}return a=s(e,[-1,-1,-1]),n=f[a]=_[a](e),{c(){n.c(),o=empty()},m(r,i){f[a].m(r,i),insert(r,o,i),l=!0},p(r,i){let u=a;a=s(r,i),a===u?f[a].p(r,i):(group_outros(),transition_out(f[u],1,1,()=>{f[u]=null}),check_outros(),n=f[a],n?n.p(r,i):(n=f[a]=_[a](r),n.c()),transition_in(n,1),n.m(o.parentNode,o))},i(r){l||(transition_in(n),l=!0)},o(r){transition_out(n),l=!1},d(r){r&&detach(o),f[a].d(r)}}}function create_each_block_10(e){let t,a=e[65].label+"",n,o,l,_;function f(){return e[43](e[63])}return{c(){t=element("li"),n=text(a),attr(t,"class",o="step text-xs "+(e[8]>=e[63]?"step-primary":"")+" cursor-pointer whitespace-nowrap")},m(s,r){insert(s,t,r),append(t,n),l||(_=listen(t,"click",prevent_default(f)),l=!0)},p(s,r){e=s,r[0]&16384&&a!==(a=e[65].label+"")&&set_data(n,a),r[0]&256&&o!==(o="step text-xs "+(e[8]>=e[63]?"step-primary":"")+" cursor-pointer whitespace-nowrap")&&attr(t,"class",o)},d(s){s&&detach(t),l=!1,_()}}}function create_else_block_2(e){let t,a;const n=[{field:e[67],key:e[18],j:e[69],table:e[2],data:e[0],form_valid:e[10],input_size:e[3],fk_data:e[9],input_change:e[26],get_upload_api:e[23],select_file:e[22],file_upload:e[24],load_fk_table:e[29],add_extra_fk_fields:e[28],validate_pass:e[27],drop_file_handler:e[32],paste_file_handler:e[33]}];let o={};for(let l=0;l<n.length;l+=1)o=assign(o,n[l]);return t=new GoblaFormField({props:o}),{c(){create_component(t.$$.fragment)},m(l,_){mount_component(t,l,_),a=!0},p(l,_){const f=_[0]&1037387277|_[1]&6?get_spread_update(n,[{field:l[67],key:l[18],j:l[69],table:l[2],data:l[0],form_valid:l[10],input_size:l[3],fk_data:l[9],input_change:l[26],get_upload_api:l[23],select_file:l[22],file_upload:l[24],load_fk_table:l[29],add_extra_fk_fields:l[28],validate_pass:l[27],drop_file_handler:l[32],paste_file_handler:l[33]}]):{};t.$set(f)},i(l){a||(transition_in(t.$$.fragment,l),a=!0)},o(l){transition_out(t.$$.fragment,l),a=!1},d(l){destroy_component(t,l)}}}function create_if_block_9(e){return{c:noop,m:noop,p:noop,i:noop,o:noop,d:noop}}function create_each_block_9(e){let t,a,n,o,l;const _=[create_if_block_9,create_else_block_2],f=[];function s(r,i){var u;return i[0]&81925&&(t=null),t==null&&(t=!!r[34](((u=r[67])==null?void 0:u.hide_cond)||"false",r[0],r[67])),t?0:1}return a=s(e,[-1,-1,-1]),n=f[a]=_[a](e),{c(){n.c(),o=empty()},m(r,i){f[a].m(r,i),insert(r,o,i),l=!0},p(r,i){let u=a;a=s(r,i),a===u?f[a].p(r,i):(group_outros(),transition_out(f[u],1,1,()=>{f[u]=null}),check_outros(),n=f[a],n?n.p(r,i):(n=f[a]=_[a](r),n.c()),transition_in(n,1),n.m(o.parentNode,o))},i(r){l||(transition_in(n),l=!0)},o(r){transition_out(n),l=!1},d(r){r&&detach(o),f[a].d(r)}}}function create_each_block_8(e){var f,s,r;let t,a,n,o=ensure_array_like(e[20](lodashExports.cloneDeep((s=(f=e[16])==null?void 0:f.tables)==null?void 0:s[e[2]])||{},e[14]||{},((r=e[65])==null?void 0:r.fields)||[])),l=[];for(let i=0;i<o.length;i+=1)l[i]=create_each_block_9(get_each_context_9(e,o,i));const _=i=>transition_out(l[i],1,1,()=>{l[i]=null});return{c(){t=element("div");for(let i=0;i<l.length;i+=1)l[i].c();a=space(),attr(t,"class","w-full flex-grow flex flex-row justify-start flex-wrap overflow-hidden"),set_style(t,"display",e[8]===e[63]?null:"none")},m(i,u){insert(i,t,u);for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(t,null);append(t,a),n=!0},p(i,u){var c,k,m;if(u[0]&1037387277|u[1]&14){o=ensure_array_like(i[20](lodashExports.cloneDeep((k=(c=i[16])==null?void 0:c.tables)==null?void 0:k[i[2]])||{},i[14]||{},((m=i[65])==null?void 0:m.fields)||[]));let b;for(b=0;b<o.length;b+=1){const g=get_each_context_9(i,o,b);l[b]?(l[b].p(g,u),transition_in(l[b],1)):(l[b]=create_each_block_9(g),l[b].c(),transition_in(l[b],1),l[b].m(t,a))}for(group_outros(),b=o.length;b<l.length;b+=1)_(b);check_outros()}u[0]&256&&set_style(t,"display",i[8]===i[63]?null:"none")},i(i){if(!n){for(let u=0;u<o.length;u+=1)transition_in(l[u]);n=!0}},o(i){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)transition_out(l[u]);n=!1},d(i){i&&detach(t),destroy_each(l,i)}}}function create_each_block_7(e){let t,a=e[65].label+"",n,o,l,_,f;function s(){return e[42](e[63])}return{c(){t=element("li"),n=text(a),o=space(),attr(t,"class",l="step text-sm "+(e[8]>=e[63]?"step-primary":"")+" cursor-pointer")},m(r,i){insert(r,t,i),append(t,n),append(t,o),_||(f=listen(t,"click",prevent_default(s)),_=!0)},p(r,i){e=r,i[0]&16384&&a!==(a=e[65].label+"")&&set_data(n,a),i[0]&256&&l!==(l="step text-sm "+(e[8]>=e[63]?"step-primary":"")+" cursor-pointer")&&attr(t,"class",l)},d(r){r&&detach(t),_=!1,f()}}}function create_else_block_1(e){let t,a;const n=[{field:e[67],key:e[18],j:e[69],table:e[2],data:e[0],form_valid:e[10],input_size:e[3],fk_data:e[9],input_change:e[26],get_upload_api:e[23],select_file:e[22],file_upload:e[24],load_fk_table:e[29],add_extra_fk_fields:e[28],validate_pass:e[27],drop_file_handler:e[32],paste_file_handler:e[33]}];let o={};for(let l=0;l<n.length;l+=1)o=assign(o,n[l]);return t=new GoblaFormField({props:o}),{c(){create_component(t.$$.fragment)},m(l,_){mount_component(t,l,_),a=!0},p(l,_){const f=_[0]&1037387277|_[1]&6?get_spread_update(n,[{field:l[67],key:l[18],j:l[69],table:l[2],data:l[0],form_valid:l[10],input_size:l[3],fk_data:l[9],input_change:l[26],get_upload_api:l[23],select_file:l[22],file_upload:l[24],load_fk_table:l[29],add_extra_fk_fields:l[28],validate_pass:l[27],drop_file_handler:l[32],paste_file_handler:l[33]}]):{};t.$set(f)},i(l){a||(transition_in(t.$$.fragment,l),a=!0)},o(l){transition_out(t.$$.fragment,l),a=!1},d(l){destroy_component(t,l)}}}function create_if_block_7(e){return{c:noop,m:noop,p:noop,i:noop,o:noop,d:noop}}function create_each_block_6(e){let t,a,n,o,l;const _=[create_if_block_7,create_else_block_1],f=[];function s(r,i){var u;return i[0]&81925&&(t=null),t==null&&(t=!!r[34](((u=r[67])==null?void 0:u.hide_cond)||"false",r[0],r[67])),t?0:1}return a=s(e,[-1,-1,-1]),n=f[a]=_[a](e),{c(){n.c(),o=empty()},m(r,i){f[a].m(r,i),insert(r,o,i),l=!0},p(r,i){let u=a;a=s(r,i),a===u?f[a].p(r,i):(group_outros(),transition_out(f[u],1,1,()=>{f[u]=null}),check_outros(),n=f[a],n?n.p(r,i):(n=f[a]=_[a](r),n.c()),transition_in(n,1),n.m(o.parentNode,o))},i(r){l||(transition_in(n),l=!0)},o(r){transition_out(n),l=!1},d(r){r&&detach(o),f[a].d(r)}}}function create_each_block_5(e){var f,s,r;let t,a,n,o=ensure_array_like(e[20](lodashExports.cloneDeep((s=(f=e[16])==null?void 0:f.tables)==null?void 0:s[e[2]])||{},e[14]||{},((r=e[65])==null?void 0:r.fields)||[])),l=[];for(let i=0;i<o.length;i+=1)l[i]=create_each_block_6(get_each_context_6(e,o,i));const _=i=>transition_out(l[i],1,1,()=>{l[i]=null});return{c(){t=element("div");for(let i=0;i<l.length;i+=1)l[i].c();a=space(),attr(t,"class","w-full flex flex-row justify-start flex-wrap overflow-hidden"),set_style(t,"display",e[8]===e[63]?null:"none")},m(i,u){insert(i,t,u);for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(t,null);append(t,a),n=!0},p(i,u){var c,k,m;if(u[0]&1037387277|u[1]&14){o=ensure_array_like(i[20](lodashExports.cloneDeep((k=(c=i[16])==null?void 0:c.tables)==null?void 0:k[i[2]])||{},i[14]||{},((m=i[65])==null?void 0:m.fields)||[]));let b;for(b=0;b<o.length;b+=1){const g=get_each_context_6(i,o,b);l[b]?(l[b].p(g,u),transition_in(l[b],1)):(l[b]=create_each_block_6(g),l[b].c(),transition_in(l[b],1),l[b].m(t,a))}for(group_outros(),b=o.length;b<l.length;b+=1)_(b);check_outros()}u[0]&256&&set_style(t,"display",i[8]===i[63]?null:"none")},i(i){if(!n){for(let u=0;u<o.length;u+=1)transition_in(l[u]);n=!0}},o(i){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)transition_out(l[u]);n=!1},d(i){i&&detach(t),destroy_each(l,i)}}}function create_each_block_4(e){let t,a,n=e[65].label+"",o,l,_,f,s;function r(){return e[41](e[63])}return{c(){t=element("a"),a=element("b"),o=text(n),_=space(),attr(t,"role","tab"),attr(t,"class",l="tab text-md "+(e[8]===e[63]?"tab-active active":""))},m(i,u){insert(i,t,u),append(t,a),append(a,o),insert(i,_,u),f||(s=listen(t,"click",prevent_default(r)),f=!0)},p(i,u){e=i,u[0]&16384&&n!==(n=e[65].label+"")&&set_data(o,n),u[0]&256&&l!==(l="tab text-md "+(e[8]===e[63]?"tab-active active":""))&&attr(t,"class",l)},d(i){i&&(detach(t),detach(_)),f=!1,s()}}}function create_else_block(e){let t,a;const n=[{field:e[67],key:e[18],j:e[69],table:e[2],data:e[0],form_valid:e[10],input_size:e[3],fk_data:e[9],input_change:e[26],get_upload_api:e[23],select_file:e[22],file_upload:e[24],load_fk_table:e[29],add_extra_fk_fields:e[28],validate_pass:e[27],drop_file_handler:e[32],paste_file_handler:e[33]}];let o={};for(let l=0;l<n.length;l+=1)o=assign(o,n[l]);return t=new GoblaFormField({props:o}),{c(){create_component(t.$$.fragment)},m(l,_){mount_component(t,l,_),a=!0},p(l,_){const f=_[0]&1037387277|_[1]&6?get_spread_update(n,[{field:l[67],key:l[18],j:l[69],table:l[2],data:l[0],form_valid:l[10],input_size:l[3],fk_data:l[9],input_change:l[26],get_upload_api:l[23],select_file:l[22],file_upload:l[24],load_fk_table:l[29],add_extra_fk_fields:l[28],validate_pass:l[27],drop_file_handler:l[32],paste_file_handler:l[33]}]):{};t.$set(f)},i(l){a||(transition_in(t.$$.fragment,l),a=!0)},o(l){transition_out(t.$$.fragment,l),a=!1},d(l){destroy_component(t,l)}}}function create_if_block_5(e){return{c:noop,m:noop,p:noop,i:noop,o:noop,d:noop}}function create_each_block_3(e){let t,a,n,o,l;const _=[create_if_block_5,create_else_block],f=[];function s(r,i){var u;return i[0]&81925&&(t=null),t==null&&(t=!!r[34](((u=r[67])==null?void 0:u.hide_cond)||"false",r[0],r[67])),t?0:1}return a=s(e,[-1,-1,-1]),n=f[a]=_[a](e),{c(){n.c(),o=empty()},m(r,i){f[a].m(r,i),insert(r,o,i),l=!0},p(r,i){let u=a;a=s(r,i),a===u?f[a].p(r,i):(group_outros(),transition_out(f[u],1,1,()=>{f[u]=null}),check_outros(),n=f[a],n?n.p(r,i):(n=f[a]=_[a](r),n.c()),transition_in(n,1),n.m(o.parentNode,o))},i(r){l||(transition_in(n),l=!0)},o(r){transition_out(n),l=!1},d(r){r&&detach(o),f[a].d(r)}}}function create_each_block_2(e){var f,s,r;let t,a,n,o=ensure_array_like(e[20](lodashExports.cloneDeep((s=(f=e[16])==null?void 0:f.tables)==null?void 0:s[e[2]])||{},e[14]||{},((r=e[65])==null?void 0:r.fields)||[])),l=[];for(let i=0;i<o.length;i+=1)l[i]=create_each_block_3(get_each_context_3(e,o,i));const _=i=>transition_out(l[i],1,1,()=>{l[i]=null});return{c(){t=element("div");for(let i=0;i<l.length;i+=1)l[i].c();a=space(),attr(t,"class","text-left w-full flex flex-row justify-start flex-wrap overflow-hidden"),set_style(t,"display",e[8]===e[63]?null:"none")},m(i,u){insert(i,t,u);for(let c=0;c<l.length;c+=1)l[c]&&l[c].m(t,null);append(t,a),n=!0},p(i,u){var c,k,m;if(u[0]&1037387277|u[1]&14){o=ensure_array_like(i[20](lodashExports.cloneDeep((k=(c=i[16])==null?void 0:c.tables)==null?void 0:k[i[2]])||{},i[14]||{},((m=i[65])==null?void 0:m.fields)||[]));let b;for(b=0;b<o.length;b+=1){const g=get_each_context_3(i,o,b);l[b]?(l[b].p(g,u),transition_in(l[b],1)):(l[b]=create_each_block_3(g),l[b].c(),transition_in(l[b],1),l[b].m(t,a))}for(group_outros(),b=o.length;b<l.length;b+=1)_(b);check_outros()}u[0]&256&&set_style(t,"display",i[8]===i[63]?null:"none")},i(i){if(!n){for(let u=0;u<o.length;u+=1)transition_in(l[u]);n=!0}},o(i){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)transition_out(l[u]);n=!1},d(i){i&&detach(t),destroy_each(l,i)}}}function create_if_block_3(e){var k,m,b,g;let t,a,n,o,l,_,f,s=ensure_array_like(e[30]((m=(k=e[14])==null?void 0:k.layout)==null?void 0:m.allow_in_subform)),r=[];for(let p=0;p<s.length;p+=1)r[p]=create_each_block_1(get_each_context_1(e,s,p));let i=ensure_array_like(e[30]((g=(b=e[14])==null?void 0:b.layout)==null?void 0:g.allow_in_subform)),u=[];for(let p=0;p<i.length;p+=1)u[p]=create_each_block(get_each_context(e,i,p));const c=p=>transition_out(u[p],1,1,()=>{u[p]=null});return{c(){var p,$,v,h;t=element("div"),a=element("div");for(let y=0;y<r.length;y+=1)r[y].c();n=space(),o=element("a"),o.innerHTML="<b></b>",l=space();for(let y=0;y<u.length;y+=1)u[y].c();attr(o,"role","tab"),attr(o,"class","tab text-md grow"),attr(a,"role","tablist"),attr(a,"class","tabs tabs-lifted w-full flex"),attr(t,"class",_=(e[4]==="popup"?"w-full p-0":`w-${(($=(p=e[14])==null?void 0:p.layout)==null?void 0:$.sub_form_size)||((h=(v=e[14])==null?void 0:v.layout)==null?void 0:h.size)||11}/12 m-auto p-3`)+" overflow-x-hidden overflow-y-auto")},m(p,$){insert(p,t,$),append(t,a);for(let v=0;v<r.length;v+=1)r[v]&&r[v].m(a,null);append(a,n),append(a,o),append(t,l);for(let v=0;v<u.length;v+=1)u[v]&&u[v].m(t,null);f=!0},p(p,$){var v,h,y,z,I,j,E,P;if($[0]&1073823872){s=ensure_array_like(p[30]((h=(v=p[14])==null?void 0:v.layout)==null?void 0:h.allow_in_subform));let w;for(w=0;w<s.length;w+=1){const C=get_each_context_1(p,s,w);r[w]?r[w].p(C,$):(r[w]=create_each_block_1(C),r[w].c(),r[w].m(a,n))}for(;w<r.length;w+=1)r[w].d(1);r.length=s.length}if($[0]&1073856709){i=ensure_array_like(p[30]((z=(y=p[14])==null?void 0:y.layout)==null?void 0:z.allow_in_subform));let w;for(w=0;w<i.length;w+=1){const C=get_each_context(p,i,w);u[w]?(u[w].p(C,$),transition_in(u[w],1)):(u[w]=create_each_block(C),u[w].c(),transition_in(u[w],1),u[w].m(t,null))}for(group_outros(),w=i.length;w<u.length;w+=1)c(w);check_outros()}(!f||$[0]&16400&&_!==(_=(p[4]==="popup"?"w-full p-0":`w-${((j=(I=p[14])==null?void 0:I.layout)==null?void 0:j.sub_form_size)||((P=(E=p[14])==null?void 0:E.layout)==null?void 0:P.size)||11}/12 m-auto p-3`)+" overflow-x-hidden overflow-y-auto"))&&attr(t,"class",_)},i(p){if(!f){for(let $=0;$<i.length;$+=1)transition_in(u[$]);f=!0}},o(p){u=u.filter(Boolean);for(let $=0;$<u.length;$+=1)transition_out(u[$]);f=!1},d(p){p&&detach(t),destroy_each(r,p),destroy_each(u,p)}}}function create_each_block_1(e){var r,i,u;let t,a,n=(((u=(i=(r=e[16])==null?void 0:r.tables)==null?void 0:i[e[61]])==null?void 0:u.comment)||e[61])+"",o,l,_,f;function s(){return e[44](e[61])}return{c(){t=element("a"),a=element("b"),o=text(n),attr(t,"role","tab"),attr(t,"class",l="tab text-md "+(e[7]===e[61]?"tab-active active":""))},m(c,k){insert(c,t,k),append(t,a),append(a,o),_||(f=listen(t,"click",prevent_default(s)),_=!0)},p(c,k){var m,b,g;e=c,k[0]&81920&&n!==(n=(((g=(b=(m=e[16])==null?void 0:m.tables)==null?void 0:b[e[61]])==null?void 0:g.comment)||e[61])+"")&&set_data(o,n),k[0]&16512&&l!==(l="tab text-md "+(e[7]===e[61]?"tab-active active":""))&&attr(t,"class",l)},d(c){c&&detach(t),_=!1,f()}}}function create_each_block(e){var k,m,b,g,p,$,v,h,y,z,I,j,E,P;let t,a,n=((g=e[0])==null?void 0:g[(b=(m=(k=e[16])==null?void 0:k.tables)==null?void 0:m[e[2]])==null?void 0:b.pk])+"",o,l,_,f,s;function r(...w){return e[45](e[61],...w)}const i=[{table:e[61],data:{data:e[0]},is_fk:!1,is_subform:!0,main_table:e[2],main_pk_id:(h=e[0])==null?void 0:h[(v=($=(p=e[16])==null?void 0:p.tables)==null?void 0:$[e[2]])==null?void 0:v.pk],populate_subform:((y=e[15])==null?void 0:y.length)>0?(z=e[15])==null?void 0:z.filter(r):null,limit:Number(((j=(I=e[14])==null?void 0:I.layout)==null?void 0:j.sub_form_limit)||((P=(E=e[14])==null?void 0:E.layout)==null?void 0:P.limit)||5)}];var u=e[6];function c(w,C){var A,K,R,J,V,q,N,F,B,T;let D={};for(let Q=0;Q<i.length;Q+=1)D=assign(D,i[Q]);return C!==void 0&&C[0]&1073856517&&(D=assign(D,get_spread_update(i,[{table:w[61],data:{data:w[0]},is_fk:!1,is_subform:!0,main_table:w[2],main_pk_id:(J=w[0])==null?void 0:J[(R=(K=(A=w[16])==null?void 0:A.tables)==null?void 0:K[w[2]])==null?void 0:R.pk],populate_subform:((V=w[15])==null?void 0:V.length)>0?(q=w[15])==null?void 0:q.filter(r):null,limit:Number(((F=(N=w[14])==null?void 0:N.layout)==null?void 0:F.sub_form_limit)||((T=(B=w[14])==null?void 0:B.layout)==null?void 0:T.limit)||5)}]))),{props:D}}return u&&(_=construct_svelte_component(u,c(e))),{c(){t=element("div"),a=element("span"),o=text(n),l=space(),_&&create_component(_.$$.fragment),f=space(),set_style(a,"display","none"),attr(t,"class","w-full"),set_style(t,"display",e[7]===e[61]?null:"none")},m(w,C){insert(w,t,C),append(t,a),append(a,o),append(t,l),_&&mount_component(_,t,null),append(t,f),s=!0},p(w,C){var D,A,K,R,J,V,q,N,F,B,T,Q,Z,X;if(e=w,(!s||C[0]&65541)&&n!==(n=((R=e[0])==null?void 0:R[(K=(A=(D=e[16])==null?void 0:D.tables)==null?void 0:A[e[2]])==null?void 0:K.pk])+"")&&set_data(o,n),C[0]&64&&u!==(u=e[6])){if(_){group_outros();const H=_;transition_out(H.$$.fragment,1,0,()=>{destroy_component(H,1)}),check_outros()}u?(_=construct_svelte_component(u,c(e,C)),create_component(_.$$.fragment),transition_in(_.$$.fragment,1),mount_component(_,t,f)):_=null}else if(u){const H=C[0]&1073856517?get_spread_update(i,[{table:e[61],data:{data:e[0]},is_fk:!1,is_subform:!0,main_table:e[2],main_pk_id:(N=e[0])==null?void 0:N[(q=(V=(J=e[16])==null?void 0:J.tables)==null?void 0:V[e[2]])==null?void 0:q.pk],populate_subform:((F=e[15])==null?void 0:F.length)>0?(B=e[15])==null?void 0:B.filter(r):null,limit:Number(((Q=(T=e[14])==null?void 0:T.layout)==null?void 0:Q.sub_form_limit)||((X=(Z=e[14])==null?void 0:Z.layout)==null?void 0:X.limit)||5)}]):{};_.$set(H)}C[0]&16512&&set_style(t,"display",e[7]===e[61]?null:"none")},i(w){s||(_&&transition_in(_.$$.fragment,w),s=!0)},o(w){_&&transition_out(_.$$.fragment,w),s=!1},d(w){w&&detach(t),_&&destroy_component(_)}}}function create_if_block_2(e){let t,a;return t=new Toast({props:{open:e[11].open,type:e[11].type,msg:e[11].msg,timer:2e4}}),t.$on("dismiss",e[46]),{c(){create_component(t.$$.fragment)},m(n,o){mount_component(t,n,o),a=!0},p(n,o){const l={};o[0]&2048&&(l.open=n[11].open),o[0]&2048&&(l.type=n[11].type),o[0]&2048&&(l.msg=n[11].msg),t.$set(l)},i(n){a||(transition_in(t.$$.fragment,n),a=!0)},o(n){transition_out(t.$$.fragment,n),a=!1},d(n){destroy_component(t,n)}}}function create_if_block_1(e){let t,a;const n=[e[12]];let o={};for(let l=0;l<n.length;l+=1)o=assign(o,n[l]);return t=new Modal({props:o}),t.$on("dismiss",e[47]),{c(){create_component(t.$$.fragment)},m(l,_){mount_component(t,l,_),a=!0},p(l,_){const f=_[0]&4096?get_spread_update(n,[get_spread_object(l[12])]):{};t.$set(f)},i(l){a||(transition_in(t.$$.fragment,l),a=!0)},o(l){transition_out(t.$$.fragment,l),a=!1},d(l){destroy_component(t,l)}}}function create_if_block(e){let t,a;return t=new Loadingv2({props:{open:e[13]}}),{c(){create_component(t.$$.fragment)},m(n,o){mount_component(t,n,o),a=!0},p(n,o){const l={};o[0]&8192&&(l.open=n[13]),t.$set(l)},i(n){a||(transition_in(t.$$.fragment,n),a=!0)},o(n){transition_out(t.$$.fragment,n),a=!1},d(n){destroy_component(t,n)}}}function create_fragment(e){var ee,O,U,le,te;let t,a,n,o=(e[5]>1?"":e[1]||((U=(O=(ee=e[16])==null?void 0:ee.tables)==null?void 0:O[e[2]])==null?void 0:U.comment)||e[2])+"",l,_,f,s,r,i,u,c,k,m=e[17].t("crud.form_customization")+"",b,g,p,$,v,h,y=e[17].t("crud.save")+"",z,I,j,E,P,w,C,D,A,K,R,J=e[30]((te=(le=e[14])==null?void 0:le.layout)==null?void 0:te.allow_in_subform).length>0,V,q,N,F,B,T;c=new Icons({props:{type:"outline",icon:"cog-8-tooth",path:"icons"}}),v=new Icons({props:{type:"outline",icon:"save",path:"icons"}});const Q=[create_if_block_4,create_if_block_6,create_if_block_8,create_else_block_3],Z=[];function X(L,M){var W,x,ae,ne,ie,oe,re,se,_e,ue,fe,de;return M[0]&16384&&(P=null),M[0]&16384&&(w=null),M[0]&16384&&(C=null),P==null&&(P=!!(L[31]((x=(W=L[14])==null?void 0:W.layout)==null?void 0:x.tabs_steps_conf)&&((ne=(ae=L[14])==null?void 0:ae.layout)==null?void 0:ne.tabs_steps)==="tabs")),P?0:(w==null&&(w=!!(L[31]((oe=(ie=L[14])==null?void 0:ie.layout)==null?void 0:oe.tabs_steps_conf)&&((se=(re=L[14])==null?void 0:re.layout)==null?void 0:se.tabs_steps)==="steps")),w?1:(C==null&&(C=!!(L[31]((ue=(_e=L[14])==null?void 0:_e.layout)==null?void 0:ue.tabs_steps_conf)&&((de=(fe=L[14])==null?void 0:fe.layout)==null?void 0:de.tabs_steps)==="vertical_steps")),C?2:3))}D=X(e,[-1,-1,-1]),A=Z[D]=Q[D](e);let H=J&&create_if_block_3(e),S=e[11].open&&create_if_block_2(e),G=e[12].open&&create_if_block_1(e),Y=e[13]&&create_if_block(e);return{c(){var L,M,W,x;t=element("div"),a=element("div"),n=element("div"),l=text(o),_=space(),f=element("div"),f.innerHTML="",s=space(),r=element("div"),i=element("button"),u=element("span"),create_component(c.$$.fragment),k=space(),b=text(m),g=space(),p=element("button"),$=element("span"),create_component(v.$$.fragment),h=space(),z=text(y),j=space(),E=element("div"),A.c(),R=space(),H&&H.c(),V=space(),S&&S.c(),q=space(),G&&G.c(),N=space(),Y&&Y.c(),attr(n,"class","flex-none"),attr(f,"class","flex-1"),attr(u,"class","w-6 h-6"),attr(i,"class","btn btn-sm btn-ghost gap-2"),i.disabled=e[13],attr($,"class","w-6 h-6"),attr(p,"class","btn btn-sm btn-ghost gap-2"),p.disabled=e[13],attr(r,"class","flex-none gap-2"),attr(a,"class",I="navbar p-2 min-h-10 "+(e[4]==="popup"?"w-full p-0":`w-${((M=(L=e[14])==null?void 0:L.layout)==null?void 0:M.size)||11}/12
                 m-auto p-3`)),set_style(a,"display",(e[4]==="popup","none")),attr(E,"class",K=(e[4]==="popup"?"w-full p-0":`w-${((x=(W=e[14])==null?void 0:W.layout)==null?void 0:x.size)||11}/12 m-auto p-3`)+" flex flex-row justify-start flex-wrap overflow-x-hidden overflow-y-auto"),attr(t,"class","w-full")},m(L,M){insert(L,t,M),append(t,a),append(a,n),append(n,l),append(a,_),append(a,f),append(a,s),append(a,r),append(r,i),append(i,u),mount_component(c,u,null),append(i,k),append(i,b),append(r,g),append(r,p),append(p,$),mount_component(v,$,null),append(p,h),append(p,z),append(t,j),append(t,E),Z[D].m(E,null),append(t,R),H&&H.m(t,null),append(t,V),S&&S.m(t,null),append(t,q),G&&G.m(t,null),append(t,N),Y&&Y.m(t,null),F=!0,B||(T=[listen(i,"click",e[39]),listen(p,"click",e[40])],B=!0)},p(L,M){var x,ae,ne,ie,oe,re,se,_e,ue;(!F||M[0]&65574)&&o!==(o=(L[5]>1?"":L[1]||((ne=(ae=(x=L[16])==null?void 0:x.tables)==null?void 0:ae[L[2]])==null?void 0:ne.comment)||L[2])+"")&&set_data(l,o),(!F||M[0]&131072)&&m!==(m=L[17].t("crud.form_customization")+"")&&set_data(b,m),(!F||M[0]&8192)&&(i.disabled=L[13]),(!F||M[0]&131072)&&y!==(y=L[17].t("crud.save")+"")&&set_data(z,y),(!F||M[0]&8192)&&(p.disabled=L[13]),(!F||M[0]&16400&&I!==(I="navbar p-2 min-h-10 "+(L[4]==="popup"?"w-full p-0":`w-${((oe=(ie=L[14])==null?void 0:ie.layout)==null?void 0:oe.size)||11}/12
                 m-auto p-3`)))&&attr(a,"class",I),M[0]&16&&set_style(a,"display",(L[4]==="popup","none"));let W=D;D=X(L,M),D===W?Z[D].p(L,M):(group_outros(),transition_out(Z[W],1,1,()=>{Z[W]=null}),check_outros(),A=Z[D],A?A.p(L,M):(A=Z[D]=Q[D](L),A.c()),transition_in(A,1),A.m(E,null)),(!F||M[0]&16400&&K!==(K=(L[4]==="popup"?"w-full p-0":`w-${((se=(re=L[14])==null?void 0:re.layout)==null?void 0:se.size)||11}/12 m-auto p-3`)+" flex flex-row justify-start flex-wrap overflow-x-hidden overflow-y-auto"))&&attr(E,"class",K),M[0]&16384&&(J=L[30]((ue=(_e=L[14])==null?void 0:_e.layout)==null?void 0:ue.allow_in_subform).length>0),J?H?(H.p(L,M),M[0]&16384&&transition_in(H,1)):(H=create_if_block_3(L),H.c(),transition_in(H,1),H.m(t,V)):H&&(group_outros(),transition_out(H,1,1,()=>{H=null}),check_outros()),L[11].open?S?(S.p(L,M),M[0]&2048&&transition_in(S,1)):(S=create_if_block_2(L),S.c(),transition_in(S,1),S.m(t,q)):S&&(group_outros(),transition_out(S,1,1,()=>{S=null}),check_outros()),L[12].open?G?(G.p(L,M),M[0]&4096&&transition_in(G,1)):(G=create_if_block_1(L),G.c(),transition_in(G,1),G.m(t,N)):G&&(group_outros(),transition_out(G,1,1,()=>{G=null}),check_outros()),L[13]?Y?(Y.p(L,M),M[0]&8192&&transition_in(Y,1)):(Y=create_if_block(L),Y.c(),transition_in(Y,1),Y.m(t,null)):Y&&(group_outros(),transition_out(Y,1,1,()=>{Y=null}),check_outros())},i(L){F||(transition_in(c.$$.fragment,L),transition_in(v.$$.fragment,L),transition_in(A),transition_in(H),transition_in(S),transition_in(G),transition_in(Y),F=!0)},o(L){transition_out(c.$$.fragment,L),transition_out(v.$$.fragment,L),transition_out(A),transition_out(H),transition_out(S),transition_out(G),transition_out(Y),F=!1},d(L){L&&detach(t),destroy_component(c),destroy_component(v),Z[D].d(),H&&H.d(),S&&S.d(),G&&G.d(),Y&&Y.d(),B=!1,run_all(T)}}}function instance($$self,$$props,$$invalidate){let $_global,$i18n;component_subscribe($$self,_global,e=>$$invalidate(16,$_global=e)),component_subscribe($$self,i18n,e=>$$invalidate(17,$i18n=e)),createEventDispatcher();let{label=null}=$$props,{table}=$$props,{data={}}=$$props,{aux_data={}}=$$props,{main_table=null}=$$props,{input_size="sm"}=$$props,{action={}}=$$props,{mode="popup"}=$$props,{default_action=[]}=$$props,{n_tabs=1}=$$props,CrudHandler,tab="",tab2=0,fk_data={},form_valid={};const key=`key_${Math.floor(Math.random()*Date.now())}`;let toast={open:!1,msg:null,type:null},modal_data={open:!1,width:12,heigth:85,header:!0,title:"Dialog Title",header_actions:[],component:null},loading2=!1,custom_form_config={},formulas={};const save=async e=>{var o,l,_,f,s,r,i,u,c,k;const t=lodashExports.cloneDeep(e.data||data);if(e!=null&&e.copy&&(t._original_pk=t[(l=(o=$_global==null?void 0:$_global.tables)==null?void 0:o[e.table||table])==null?void 0:l.pk],delete t[(f=(_=$_global==null?void 0:$_global.tables)==null?void 0:_[e.table||table])==null?void 0:f.pk]),!(e!=null&&e.do_not_validate)){const m=form_validation({table:e.table||table,data:e.data||data});if(returnKeys(m).length>0){console.log(m);const b=`${key}-${e.table||table}-${returnKeys(m)[0]}-${(s=m==null?void 0:m[returnKeys(m)[0]])==null?void 0:s.index}`,g=document.getElementById(b);return g&&g.focus(),null}}Array.isArray(t)||typeof t=="object"&&_aux_get_fields(((i=(r=$_global==null?void 0:$_global.tables)==null?void 0:r[e.table||table])==null?void 0:i.fields)||{}).forEach((m,b)=>{var g,p,$;if(t!=null&&t[m.name]&&["date","datetime","_time","timestamp"].includes((g=m==null?void 0:m.type)==null?void 0:g.toLowerCase()))t[m.name]=hooks(t[m.name]).format();else if(t!=null&&t[m.name]&&["time"].includes((p=m==null?void 0:m.type)==null?void 0:p.toLowerCase())){const v=t[m.name];t[m.name]=hooks(t[m.name]).format("HH:mm:ss"),console.log(m,v,t==null?void 0:t[m.name],($=m==null?void 0:m.type)==null?void 0:$.toLowerCase())}}),$$invalidate(13,loading2=!0);const a={lang:$_global==null?void 0:$_global.lang,conf:$_global==null?void 0:$_global.conf,token:$_global==null?void 0:$_global.token,app:$_global==null?void 0:$_global.selected_app,table:e.table||table,data:t};console.log("params:",a);const n=await create_update(a);if(console.log("data:",n),n.success===!0){$$invalidate(11,toast.open=!0,toast),$$invalidate(11,toast.type="success",toast),$$invalidate(11,toast.msg=n.msg,toast),n.inserted_primary_key&&($$invalidate(0,data[(u=$_global==null?void 0:$_global.tables)==null?void 0:u[(e==null?void 0:e.table)||table].pk]=n.inserted_primary_key,data),$$invalidate(0,data={...data}),returnKeys((c=custom_form_config==null?void 0:custom_form_config.layout)==null?void 0:c.allow_in_subform).length>0&&(data==null?void 0:data.clone)===!0&&data!=null&&data._original_pk&&(dependency_data==null?void 0:dependency_data.length)>0&&($$invalidate(15,dependency_data=dependency_data==null?void 0:dependency_data.map(m=>({...m,...data,[$_global.tables[(e==null?void 0:e.table)||table].pk]:n.inserted_primary_key}))),delete data._original_pk,$$invalidate(0,data={...data}),console.error("HAS SUBFORM",dependency_data),save({data:dependency_data,table:((k=dependency_data==null?void 0:dependency_data[0])==null?void 0:k._table)||table,do_not_validate:!0}),setTimeout(()=>{$$invalidate(15,dependency_data=[])},1e3)));try{action!=null&&action.action&&(action==null||action.action(data))}catch(m){console.log(m.message)}}else $$invalidate(11,toast.open=!0,toast),$$invalidate(11,toast.type="error",toast),$$invalidate(11,toast.msg=n.msg,toast),n!=null&&n.errors&&n.errors.length>0&&($$invalidate(12,modal_data.html_msg='<div class="alert alert-error shadow-lg m-1">'+n.errors.map(m=>m).join('</div><div class="alert alert-error shadow-lg m-1">')+"</div>",modal_data),$$invalidate(12,modal_data.open=!0,modal_data),$$invalidate(12,modal_data.header=!0,modal_data),$$invalidate(12,modal_data.title=n.msg,modal_data),$$invalidate(12,modal_data.actions=[{type:"btn",name:"OK",class:"text-primary--",label:$i18n.t("crud.ok"),action:dismiss_modal}],modal_data),$$invalidate(12,modal_data.width=4,modal_data),$$invalidate(12,modal_data.heigth=null,modal_data));$$invalidate(13,loading2=!1)},_aux_get_fields=e=>{var n,o,l,_,f,s,r,i,u,c,k,m,b,g,p,$,v,h,y,z,I,j,E,P,w,C,D,A,K,R,J,V,q,N,F,B;const t=[],a=Object.keys(e);for(const T in e)if(Object.hasOwnProperty.call(e,T)){if(e[T].pk)continue;if(["excluded","created_at","updated_at"].includes(T))continue;if(e[T].fk){if(a.includes((o=(n=e[T])==null?void 0:n.ref)==null?void 0:o.referred_columns_desc))continue;console.log({org_name:T,name:(_=(l=e[T])==null?void 0:l.ref)==null?void 0:_.referred_columns_desc,referred_table:((s=(f=e[T])==null?void 0:f.ref)==null?void 0:s.referred_table)||((r=e[T])==null?void 0:r.referred_table)||((i=e[T])==null?void 0:i.referred_table),comment:(v=($=(b=(m=$_global==null?void 0:$_global.tables)==null?void 0:m[((c=(u=e[T])==null?void 0:u.ref)==null?void 0:c.referred_table)||((k=e[T])==null?void 0:k.referred_table)])==null?void 0:b.fields)==null?void 0:$[(p=(g=e[T])==null?void 0:g.ref)==null?void 0:p.referred_columns_desc])==null?void 0:v.comment,referred_column:(y=(h=e[T])==null?void 0:h.ref)==null?void 0:y.referred_column}),t.push(Object.assign(e[T],{org_name:T,name:(I=(z=e[T])==null?void 0:z.ref)==null?void 0:I.referred_columns_desc,referred_table:((E=(j=e[T])==null?void 0:j.ref)==null?void 0:E.referred_table)||((P=e[T])==null?void 0:P.referred_table)||((w=e[T])==null?void 0:w.referred_table),comment:(N=(q=(R=(K=$_global==null?void 0:$_global.tables)==null?void 0:K[((D=(C=e[T])==null?void 0:C.ref)==null?void 0:D.referred_table)||((A=e[T])==null?void 0:A.referred_table)])==null?void 0:R.fields)==null?void 0:q[(V=(J=e[T])==null?void 0:J.ref)==null?void 0:V.referred_columns_desc])==null?void 0:N.comment,referred_column:(B=(F=e[T])==null?void 0:F.ref)==null?void 0:B.referred_column}))}else t.push(e[T])}return t},get_fields=(e,t,a)=>{var l,_,f,s,r,i,u,c,k,m,b,g,p,$,v,h,y,z,I;let n={};((l=e==null?void 0:e.fields_order)==null?void 0:l.length)>0&&(e!=null&&e.fields)?e==null||e.fields_order.forEach(j=>{var E;n[j]=(E=e==null?void 0:e.fields)==null?void 0:E[j]}):e!=null&&e.fields?n=e==null?void 0:e.fields:n=e;let o=[];if(t!=null&&t.fields){const j={};_aux_get_fields(n).forEach(E=>{j[E.name]=E});for(const E in t.fields)if(Object.hasOwnProperty.call(t.fields,E)&&(j!=null&&j[E])){if((_=j==null?void 0:j[E])!=null&&_.pk)continue;if(t.fields[E].display){const P=Object.assign(t.fields[E],j[E]);(f=j==null?void 0:j[E])!=null&&f.fk?(console.log(E,j[E]),o.push(Object.assign(P,{org_name:E,name:(r=(s=j[E])==null?void 0:s.ref)==null?void 0:r.referred_columns_desc,referred_table:((u=(i=j[E])==null?void 0:i.ref)==null?void 0:u.referred_table)||((c=j[E])==null?void 0:c.referred_table),comment:(y=(h=(p=(g=$_global==null?void 0:$_global.tables)==null?void 0:g[((m=(k=j[E])==null?void 0:k.ref)==null?void 0:m.referred_table)||((b=j[E])==null?void 0:b.referred_table)])==null?void 0:p.fields)==null?void 0:h[(v=($=j[E])==null?void 0:$.ref)==null?void 0:v.referred_columns_desc])==null?void 0:y.comment,referred_column:(I=(z=j[E])==null?void 0:z.ref)==null?void 0:I.referred_column}))):o.push(Object.assign({},P))}else continue}a&&Array.isArray(a)&&(o=o.filter(E=>a.includes(E.name)))}else o=_aux_get_fields(n);return o},dismiss_modal=e=>{$$invalidate(12,modal_data.open=!1,modal_data)},select_file=e=>{try{document.getElementById(e.id).click()}catch(t){console.log(t.message)}},get_upload_api=e=>{var t,a,n,o,l;return(t=$_global==null?void 0:$_global.conf)!=null&&t.upload_api?`${(a=$_global==null?void 0:$_global.conf)==null?void 0:a.upload_api}${e?"s":""}`:`${((n=$_global==null?void 0:$_global.conf)==null?void 0:n.api)==="/"?"":(l=(o=$_global==null?void 0:$_global.conf)==null?void 0:o.api)==null?void 0:l.replace("/api","").replace("/dyn_api","")}/upload${e?"s":""}`},file_upload=async e=>{var t,a;$$invalidate(13,loading2=!0);try{$$invalidate(0,data[(t=e==null?void 0:e.field)==null?void 0:t.name]=e.event.currentTarget.files[0].name,data);const n={lang:$_global==null?void 0:$_global.lang,conf:$_global==null?void 0:$_global.conf,token:$_global==null?void 0:$_global.token,file:e.event.currentTarget.files[0],tmp:!1,path:null},o=await upload(n);o.success===!0?($$invalidate(0,data[(a=e==null?void 0:e.field)==null?void 0:a.name]=o.file,data),$$invalidate(11,toast.open=!0,toast),$$invalidate(11,toast.type="success",toast),$$invalidate(11,toast.msg=o.msg,toast)):($$invalidate(11,toast.open=!0,toast),$$invalidate(11,toast.type="error",toast),$$invalidate(11,toast.msg=o.msg,toast))}catch(n){console.log(n.message),$$invalidate(11,toast.open=!0,toast),$$invalidate(11,toast.type="error",toast),$$invalidate(11,toast.msg=n.message,toast)}$$invalidate(13,loading2=!1)},run_after_save_form_config=e=>{e&&$$invalidate(14,custom_form_config=Object.assign({},e))},form_config=async e=>{var t,a;try{console.log({payload:e}),$$invalidate(13,loading2=!0),$$invalidate(12,modal_data.header=!0,modal_data),$$invalidate(12,modal_data.msg=null,modal_data),$$invalidate(12,modal_data.html_msg=null,modal_data),$$invalidate(12,modal_data.header_actions=[{type:"icon",icon:"save",name:"save",label:$i18n.t("crud.save"),action:run_after_save_form_config}],modal_data),$$invalidate(12,modal_data.component=(await __vitePreload(async()=>{const{default:n}=await import("./FormCustomization-CIP9ZXm5.js");return{default:n}},__vite__mapDeps([0,1,2,3,4]),import.meta.url)).default,modal_data),$$invalidate(12,modal_data.title=`${$i18n.t("crud.form_customization")} - ${(a=(t=$_global==null?void 0:$_global.tables)==null?void 0:t[table])==null?void 0:a.comment}`,modal_data),$$invalidate(12,modal_data.data={table},modal_data),$$invalidate(12,modal_data.width=12,modal_data),$$invalidate(12,modal_data.open=!0,modal_data),$$invalidate(13,loading2=!1)}catch(n){$$invalidate(13,loading2=!1),console.log(n.message),$$invalidate(11,toast.open=!0,toast),$$invalidate(11,toast.type="error",toast),$$invalidate(11,toast.msg=n.message,toast)}},set_form_conf=e=>{var t,a,n,o,l,_;if((n=(a=(t=$_global==null?void 0:$_global.tables)==null?void 0:t[e])==null?void 0:a.custom_form)!=null&&n.config)try{$$invalidate(14,custom_form_config=JSON.parse((_=(l=(o=$_global==null?void 0:$_global.tables)==null?void 0:o[e])==null?void 0:l.custom_form)==null?void 0:_.config))}catch(f){return console.log(f.message),{}}},input_change=e=>{var t,a,n,o,l,_,f,s,r,i,u,c,k,m,b,g,p,$,v,h,y,z,I,j,E,P,w,C,D,A,K,R,J,V,q,N,F,B;if((a=(t=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:t[e.target.name])!=null&&a.regex_val&&e.target.value){const T=new RegExp((o=(n=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:n[e.target.name])==null?void 0:o.regex_val,"g");console.log(T,T.test(e.target.value),T.test(e.target.value)===!1),T.test(e.target.value)===!1?$$invalidate(10,form_valid[e.target.name]={type:"error",msg:(_=(l=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:l[e.target.name])!=null&&_.val_msg?(s=(f=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:f[e.target.name])==null?void 0:s.val_msg:`${$i18n.t("crud.field_not_regex_compl",{field:(i=(r=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:r[e.target.name])!=null&&i.use_label?(c=(u=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:u[e.target.name])==null?void 0:c.label:(g=(b=(m=(k=$_global==null?void 0:$_global.tables)==null?void 0:k[table])==null?void 0:m.fields)==null?void 0:b[e.target.name])==null?void 0:g.comment,pattern:($=(p=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:p[e.target.name])==null?void 0:$.regex_val})}!`},form_valid):($$invalidate(10,form_valid={...form_valid,[e.target.name]:null}),delete form_valid[e.target.name])}else if((h=(v=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:v[e.target.name])!=null&&h.js_val&&e.target.value){const T=get_eval((z=(y=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:y[e.target.name])==null?void 0:z.js_val,{...data});console.log((j=(I=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:I[e.target.name])==null?void 0:j.js_val,e.target.value,data),T===!1?$$invalidate(10,form_valid[e.target.name]={type:"error",msg:(P=(E=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:E[e.target.name])!=null&&P.val_msg?(C=(w=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:w[e.target.name])==null?void 0:C.val_msg:`${$i18n.t("crud.field_not_expected_patt",{field:(A=(D=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:D[e.target.name])!=null&&A.use_label?(R=(K=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:K[e.target.name])==null?void 0:R.label:(N=(q=(V=(J=$_global==null?void 0:$_global.tables)==null?void 0:J[table])==null?void 0:V.fields)==null?void 0:q[e.target.name])==null?void 0:N.comment,pattern:(B=(F=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:F[e.target.name])==null?void 0:B.js_val})}!`},form_valid):($$invalidate(10,form_valid={...form_valid,[e.target.name]:null}),delete form_valid[e.target.name])}else form_valid[e.target.name]&&delete form_valid[e.target.name]},prepare_data=e=>{$$invalidate(0,data=data||{}),_aux_get_fields(e).forEach(t=>{var a,n,o,l,_,f,s,r,i,u,c;data!=null&&data[t.name]&&["date"].includes(t.type.toLowerCase())?typeof data[t.name]=="string"&&(a=$_global==null?void 0:$_global.conf)!=null&&a.default_html_date_time&&$$invalidate(0,data[t.name]=hooks(data[t.name]).format("YYYY-MM-DD"),data):data!=null&&data[t.name]&&["datetime","timestamp"].includes(t.type.toLowerCase())?typeof data[t.name]=="string"&&(n=$_global==null?void 0:$_global.conf)!=null&&n.default_html_date_time&&$$invalidate(0,data[t.name]=hooks(data[t.name]).format("YYYY-MM-DDTHH:mm:ss"),data):data!=null&&data[t.name]&&["time"].includes(t.type.toLowerCase())?typeof data[t.name]=="string"&&(o=$_global==null?void 0:$_global.conf)!=null&&o.default_html_date_time:!(data!=null&&data[t.name])&&(t==null?void 0:t.name)==="user_id"&&!((_=(l=$_global==null?void 0:$_global.conf)==null?void 0:l.table_enable_user)!=null&&_.includes(table))?$$invalidate(0,data[t.name]=(f=$_global==null?void 0:$_global.user)==null?void 0:f.user_id,data):!(data!=null&&data[t.name])&&(t==null?void 0:t.name)==="app_id"&&$$invalidate(0,data[t.name]=(s=$_global==null?void 0:$_global.selected_app)==null?void 0:s.app_id,data),(i=(r=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:r[t==null?void 0:t.name])!=null&&i.formula&&(formulas[t==null?void 0:t.name]=(c=(u=custom_form_config==null?void 0:custom_form_config.fields)==null?void 0:u[t==null?void 0:t.name])==null?void 0:c.formula)}),Object.keys(aux_data).length>0&&main_table&&fk_table_item_selected({data:aux_data})},form_validation=e=>{var t,a;return _aux_get_fields(((a=(t=$_global==null?void 0:$_global.tables)==null?void 0:t[e==null?void 0:e.table])==null?void 0:a.fields)||{}).forEach((n,o)=>{var l;!((l=e==null?void 0:e.data)!=null&&l[n.name])&&n.nullable===!1&&$$invalidate(10,form_valid[n.name]={type:"error",msg:`${$i18n.t("crud.field_required",{field:n.comment})}!`,index:o},form_valid)}),form_valid},validate_pass=e=>{let t=[];const{name:a,value:n}=e.target;t=[n.length>7,n.search(/[A-Z]/)>-1,n.search(/[0-9]/)>-1,n.search(/[$&+,:;=?@#!*.-]/)>-1],t.reduce((o,l)=>o&&l),t[0]===!1?$$invalidate(10,form_valid[a]={type:"error",msg:`${$i18n.t("crud.pass_min_len")}!`},form_valid):t[1]===!1?$$invalidate(10,form_valid[a]={type:"error",msg:`${$i18n.t("crud.pass_upper")}!`},form_valid):t[2]===!1?$$invalidate(10,form_valid[a]={type:"error",msg:`${$i18n.t("crud.pass_num")}!`},form_valid):t[3]===!1?$$invalidate(10,form_valid[a]={type:"error",msg:`${$i18n.t("crud.pass_special")}!`},form_valid):$$invalidate(10,form_valid[a]=null,form_valid)},get_data=async e=>{const t={lang:$_global==null?void 0:$_global.lang,conf:$_global==null?void 0:$_global.conf,token:$_global==null?void 0:$_global.token,app:$_global==null?void 0:$_global.selected_app,table:e==null?void 0:e.table,limit:(e==null?void 0:e.limit)||20,filters:e==null?void 0:e.filters};return await read(t)},get_fk_data=async e=>{var n;e.no_loding||$$invalidate(13,loading2=!0);const a=_aux_get_fields(e).filter(o=>o.fk===!0).map(o=>o.referred_table);if(a.length>0&&((n=$_global==null?void 0:$_global.conf)!=null&&n.form_auto_load_fk_data)){const o=await get_data({table:a,limit:-1});o.success===!0&&o.data?a.length>1?$$invalidate(9,fk_data=o.data):a.length==1&&$$invalidate(9,fk_data[a[0]]=o,fk_data):($$invalidate(11,toast.open=!0,toast),$$invalidate(11,toast.type="error",toast),$$invalidate(11,toast.msg=o.msg,toast))}$$invalidate(13,loading2=!1)},add_extra_fk_fields=e=>{fk_table_item_selected(e)},fk_table_item_selected=e=>{var t,a,n;if(e.data){const o={};for(const l in e.data)Object.hasOwnProperty.call(e.data,l)&&e.data[l]&&((a=(t=$_global==null?void 0:$_global.conf)==null?void 0:t.table_enable_user)!=null&&a.includes(table)&&["user_id","user","username"].includes(l)?o[l]=e.data[l]:(((n=$_global==null?void 0:$_global.conf)==null?void 0:n.form_not_update)||[]).includes(l)||(o[l]=e.data[l]));$$invalidate(0,data={...data,...lodashExports.cloneDeep(o)}),console.log(o,data)}dismiss_modal()},load_fk_table=async e=>{var t,a,n;try{console.log({payload:e}),$$invalidate(13,loading2=!0),$$invalidate(12,modal_data.msg=null,modal_data),$$invalidate(12,modal_data.html_msg=null,modal_data),$$invalidate(12,modal_data.header=!1,modal_data),$$invalidate(12,modal_data.heigth=90,modal_data),$$invalidate(12,modal_data.component=CrudHandler,modal_data),$$invalidate(12,modal_data.title=`${(a=(t=$_global==null?void 0:$_global.tables)==null?void 0:t[table])==null?void 0:a.comment}`,modal_data),$$invalidate(12,modal_data.data={table:(n=e==null?void 0:e.field)==null?void 0:n.referred_table,data:e,is_fk:!0,is_subform:!1,main_table:table,actions:{dismiss_modal,fk_table_item_selected}},modal_data),$$invalidate(12,modal_data.width=12,modal_data),$$invalidate(12,modal_data.open=!0,modal_data),$$invalidate(13,loading2=!1)}catch(o){$$invalidate(13,loading2=!1),console.log(o.message),$$invalidate(11,toast.open=!0,toast),$$invalidate(11,toast.type="error",toast),$$invalidate(11,toast.msg=o.message,toast)}},returnKeys=e=>Object.keys(e||{}),tabs_steps=e=>{if(Array.isArray(e)!==!1){if(e.length>0)return!0}return!1},drop_file_handler=(e,t)=>{try{e.preventDefault(),e.stopPropagation(),e.dataTransfer.files&&e.dataTransfer.files.length>0&&(file_upload({field:t,event:{currentTarget:{files:e.dataTransfer.files}}}),e.dataTransfer.clearData())}catch(a){console.log(a.message)}},paste_file_handler=(e,t)=>{try{e.stopPropagation(),e.clipboardData.files&&e.clipboardData.files.length>0&&(file_upload({field:t,event:{currentTarget:{files:e.clipboardData.files}}}),e.clipboardData.clearData())}catch(a){console.log(a.message)}},get_eval=(payload,d,field)=>{try{return eval(payload)}catch(e){return!1}};onMount(()=>{var e,t;$i18n.changeLanguage($_global==null?void 0:$_global.lang),console.log({table,main_table,aux_data});try{hooks.locale($_global==null?void 0:$_global.lang)}catch{hooks.locale("en-us")}(t=(e=$_global==null?void 0:$_global.conf)==null?void 0:e.table_enable_user)!=null&&t.includes(table),(async()=>{var a,n,o,l,_,f,s;if(get_fk_data((n=(a=$_global==null?void 0:$_global.tables)==null?void 0:a[table])==null?void 0:n.fields),$$invalidate(6,CrudHandler=(await __vitePreload(async()=>{const{default:r}=await import("./CrudHandler-7W4IdyLN.js");return{default:r}},__vite__mapDeps([5,1,2]),import.meta.url)).default),returnKeys((o=custom_form_config==null?void 0:custom_form_config.layout)==null?void 0:o.allow_in_subform).length>0){$$invalidate(7,tab=returnKeys((l=custom_form_config==null?void 0:custom_form_config.layout)==null?void 0:l.allow_in_subform)[0]);const r=returnKeys((_=custom_form_config==null?void 0:custom_form_config.layout)==null?void 0:_.allow_in_subform).filter(i=>{var u,c;return(c=(u=$_global==null?void 0:$_global.tables)==null?void 0:u[i])==null?void 0:c.pk});console.log({_sforms:r}),(data==null?void 0:data.clone)===!0&&(data!=null&&data._original_pk)&&setTimeout(()=>{var i,u;_prepare_dependency_data({table:r,limit:-1,filters:[{field:(u=(i=$_global==null?void 0:$_global.tables)==null?void 0:i[table])==null?void 0:u.pk,value:data==null?void 0:data._original_pk,cond:"="}]})},500)}prepare_data((s=(f=$_global==null?void 0:$_global.tables)==null?void 0:f[table])==null?void 0:s.fields),console.log({formulas})})()});let dependency_data=[];const _prepare_dependency_data=async e=>{var a,n,o;const t=await get_data(e);if((t==null?void 0:t.success)===!0&&(t!=null&&t.data)){if(Array.isArray(t==null?void 0:t.data))(a=t==null?void 0:t.data)==null||a.forEach(l=>{var _,f,s,r,i,u;dependency_data.push({...l,_table:(_=e==null?void 0:e.table)==null?void 0:_[0],[(r=(s=$_global==null?void 0:$_global.tables)==null?void 0:s[(f=e==null?void 0:e.table)==null?void 0:f[0]])==null?void 0:r.pk]:null,[(u=(i=$_global==null?void 0:$_global.tables)==null?void 0:i[table])==null?void 0:u.pk]:null})});else for(const l in t==null?void 0:t.data)Object.hasOwnProperty.call(t.data,l)&&((o=(n=t.data[l])==null?void 0:n.data)==null||o.forEach(_=>{var f,s,r,i;dependency_data.push({..._,_table:l,[(s=(f=$_global==null?void 0:$_global.tables)==null?void 0:f[l])==null?void 0:s.pk]:null,[(i=(r=$_global==null?void 0:$_global.tables)==null?void 0:r[table])==null?void 0:i.pk]:null})}));$$invalidate(15,dependency_data=[...dependency_data])}},handle_formulas=e=>{var t,a;for(const n in formulas)if(Object.prototype.hasOwnProperty.call(formulas,n)){const o=/d\??\.\w+/g;let l=null,_=!1;for(;(l=o.exec(formulas[n]))!==null;)console.log(l[0]),data[(a=(t=$_global==null?void 0:$_global.tables)==null?void 0:t[e.table||table])==null?void 0:a.pk]||(_=!0);if(!(e!=null&&e[n])||_)try{$$invalidate(0,data[n]=get_eval(formulas[n],e,null),data)}catch(f){console.log(f==null?void 0:f.message)}}},click_handler=e=>form_config(table),click_handler_1=e=>save({table}),click_handler_2=e=>{$$invalidate(8,tab2=e)},click_handler_3=e=>{$$invalidate(8,tab2=e)},click_handler_4=e=>{$$invalidate(8,tab2=e)},click_handler_5=e=>{$$invalidate(7,tab=e)},func=(e,t)=>(t==null?void 0:t._table)===e,dismiss_handler=e=>{$$invalidate(11,toast.open=!1,toast)},dismiss_handler_1=e=>dismiss_modal(e.detail);return $$self.$$set=e=>{"label"in e&&$$invalidate(1,label=e.label),"table"in e&&$$invalidate(2,table=e.table),"data"in e&&$$invalidate(0,data=e.data),"aux_data"in e&&$$invalidate(35,aux_data=e.aux_data),"main_table"in e&&$$invalidate(36,main_table=e.main_table),"input_size"in e&&$$invalidate(3,input_size=e.input_size),"action"in e&&$$invalidate(37,action=e.action),"mode"in e&&$$invalidate(4,mode=e.mode),"default_action"in e&&$$invalidate(38,default_action=e.default_action),"n_tabs"in e&&$$invalidate(5,n_tabs=e.n_tabs)},$$self.$$.update=()=>{$$self.$$.dirty[0]&4&&set_form_conf(table),$$self.$$.dirty[0]&4|$$self.$$.dirty[1]&64&&((action==null?void 0:action.name)==="form_customization"?form_config(table):(action==null?void 0:action.name)==="save"?save({}):(action==null?void 0:action.name)==="copy"&&save({copy:!0})),$$self.$$.dirty[0]&1&&(console.log({data}),handle_formulas(data))},[data,label,table,input_size,mode,n_tabs,CrudHandler,tab,tab2,fk_data,form_valid,toast,modal_data,loading2,custom_form_config,dependency_data,$_global,$i18n,key,save,get_fields,dismiss_modal,select_file,get_upload_api,file_upload,form_config,input_change,validate_pass,add_extra_fk_fields,load_fk_table,returnKeys,tabs_steps,drop_file_handler,paste_file_handler,get_eval,aux_data,main_table,action,default_action,click_handler,click_handler_1,click_handler_2,click_handler_3,click_handler_4,click_handler_5,func,dismiss_handler,dismiss_handler_1]}class GlobalForm extends SvelteComponent{constructor(t){super(),init(this,t,instance,create_fragment,safe_not_equal,{label:1,table:2,data:0,aux_data:35,main_table:36,input_size:3,action:37,mode:4,default_action:38,n_tabs:5},null,[-1,-1,-1])}}export{GlobalForm as default};
